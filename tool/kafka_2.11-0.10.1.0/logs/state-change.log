[2017-12-06 13:14:39,814] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2017-12-06 13:14:48,371] TRACE Controller 0 epoch 35 started leader election for partition [test1,0] (state.change.logger)
[2017-12-06 13:14:48,418] ERROR Controller 0 epoch 35 initiated state change for partition [test1,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test1,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:146)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:141)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:141)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener.handleDataDeleted(ZookeeperLeaderElector.scala:141)
	at org.I0Itec.zkclient.ZkClient$9.run(ZkClient.java:824)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-12-06 13:14:48,421] TRACE Controller 0 epoch 35 started leader election for partition [test3,0] (state.change.logger)
[2017-12-06 13:14:48,439] ERROR Controller 0 epoch 35 initiated state change for partition [test3,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test3,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:146)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:141)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:141)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener.handleDataDeleted(ZookeeperLeaderElector.scala:141)
	at org.I0Itec.zkclient.ZkClient$9.run(ZkClient.java:824)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-12-06 13:14:48,440] TRACE Controller 0 epoch 35 started leader election for partition [log,0] (state.change.logger)
[2017-12-06 13:14:48,457] ERROR Controller 0 epoch 35 initiated state change for partition [log,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [log,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:146)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:141)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:141)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener.handleDataDeleted(ZookeeperLeaderElector.scala:141)
	at org.I0Itec.zkclient.ZkClient$9.run(ZkClient.java:824)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-12-06 13:14:48,459] TRACE Controller 0 epoch 35 started leader election for partition [json-topic,0] (state.change.logger)
[2017-12-06 13:14:48,478] ERROR Controller 0 epoch 35 initiated state change for partition [json-topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [json-topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:146)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:141)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:141)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener.handleDataDeleted(ZookeeperLeaderElector.scala:141)
	at org.I0Itec.zkclient.ZkClient$9.run(ZkClient.java:824)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-12-06 13:14:48,482] TRACE Controller 0 epoch 35 started leader election for partition [test,0] (state.change.logger)
[2017-12-06 13:14:48,514] ERROR Controller 0 epoch 35 initiated state change for partition [test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:146)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:141)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:141)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener.handleDataDeleted(ZookeeperLeaderElector.scala:141)
	at org.I0Itec.zkclient.ZkClient$9.run(ZkClient.java:824)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-12-06 13:15:23,743] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2017-12-06 13:15:34,862] TRACE Controller 0 epoch 36 started leader election for partition [test1,0] (state.change.logger)
[2017-12-06 13:15:34,876] ERROR Controller 0 epoch 36 initiated state change for partition [test1,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test1,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-12-06 13:15:34,883] TRACE Controller 0 epoch 36 started leader election for partition [test3,0] (state.change.logger)
[2017-12-06 13:15:34,898] ERROR Controller 0 epoch 36 initiated state change for partition [test3,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test3,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-12-06 13:15:34,899] TRACE Controller 0 epoch 36 started leader election for partition [log,0] (state.change.logger)
[2017-12-06 13:15:34,911] ERROR Controller 0 epoch 36 initiated state change for partition [log,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [log,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-12-06 13:15:34,916] TRACE Controller 0 epoch 36 started leader election for partition [json-topic,0] (state.change.logger)
[2017-12-06 13:15:34,936] ERROR Controller 0 epoch 36 initiated state change for partition [json-topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [json-topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-12-06 13:15:34,937] TRACE Controller 0 epoch 36 started leader election for partition [test,0] (state.change.logger)
[2017-12-06 13:15:34,951] ERROR Controller 0 epoch 36 initiated state change for partition [test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-12-06 13:15:35,328] TRACE Controller 0 epoch 36 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:34) to broker 0 for partition test1-0 (state.change.logger)
[2017-12-06 13:15:35,328] TRACE Controller 0 epoch 36 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:34) to broker 0 for partition test3-0 (state.change.logger)
[2017-12-06 13:15:35,328] TRACE Controller 0 epoch 36 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:29,ControllerEpoch:34) to broker 0 for partition test-0 (state.change.logger)
[2017-12-06 13:15:35,328] TRACE Controller 0 epoch 36 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:22,ControllerEpoch:34) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-12-06 13:15:35,328] TRACE Controller 0 epoch 36 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:34) to broker 0 for partition log-0 (state.change.logger)
[2017-12-06 13:15:35,348] TRACE Controller 0 epoch 36 changed state of replica 0 for partition [test3,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-06 13:15:35,348] TRACE Controller 0 epoch 36 changed state of replica 0 for partition [test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-06 13:15:35,348] TRACE Controller 0 epoch 36 changed state of replica 0 for partition [json-topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-06 13:15:35,348] TRACE Controller 0 epoch 36 changed state of replica 0 for partition [log,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-06 13:15:35,348] TRACE Controller 0 epoch 36 changed state of replica 0 for partition [test1,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-06 13:15:35,348] TRACE Controller 0 epoch 36 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:34) to broker 0 for partition [test1,0] (state.change.logger)
[2017-12-06 13:15:35,348] TRACE Controller 0 epoch 36 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:34) to broker 0 for partition [test3,0] (state.change.logger)
[2017-12-06 13:15:35,348] TRACE Controller 0 epoch 36 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:22,ControllerEpoch:34) to broker 0 for partition [json-topic,0] (state.change.logger)
[2017-12-06 13:15:35,348] TRACE Controller 0 epoch 36 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:29,ControllerEpoch:34) to broker 0 for partition [test,0] (state.change.logger)
[2017-12-06 13:15:35,348] TRACE Controller 0 epoch 36 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:34) to broker 0 for partition [log,0] (state.change.logger)
[2017-12-06 13:15:35,348] TRACE Controller 0 epoch 36 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:34) to broker 0 for partition test1-0 (state.change.logger)
[2017-12-06 13:15:35,348] TRACE Controller 0 epoch 36 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:34) to broker 0 for partition test3-0 (state.change.logger)
[2017-12-06 13:15:35,358] TRACE Controller 0 epoch 36 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:22,ControllerEpoch:34) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-12-06 13:15:35,358] TRACE Controller 0 epoch 36 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:29,ControllerEpoch:34) to broker 0 for partition test-0 (state.change.logger)
[2017-12-06 13:15:35,358] TRACE Controller 0 epoch 36 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:34) to broker 0 for partition log-0 (state.change.logger)
[2017-12-06 13:15:35,358] TRACE Controller 0 epoch 36 started leader election for partition [test1,0] (state.change.logger)
[2017-12-06 13:15:35,398] TRACE Controller 0 epoch 36 elected leader 0 for Offline partition [test1,0] (state.change.logger)
[2017-12-06 13:15:35,398] TRACE Controller 0 epoch 36 changed partition [test1,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-06 13:15:35,398] TRACE Controller 0 epoch 36 started leader election for partition [test3,0] (state.change.logger)
[2017-12-06 13:15:35,438] TRACE Controller 0 epoch 36 elected leader 0 for Offline partition [test3,0] (state.change.logger)
[2017-12-06 13:15:35,438] TRACE Controller 0 epoch 36 changed partition [test3,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-06 13:15:35,438] TRACE Controller 0 epoch 36 started leader election for partition [log,0] (state.change.logger)
[2017-12-06 13:15:35,479] TRACE Controller 0 epoch 36 elected leader 0 for Offline partition [log,0] (state.change.logger)
[2017-12-06 13:15:35,479] TRACE Controller 0 epoch 36 changed partition [log,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-06 13:15:35,479] TRACE Controller 0 epoch 36 started leader election for partition [json-topic,0] (state.change.logger)
[2017-12-06 13:15:35,509] TRACE Controller 0 epoch 36 elected leader 0 for Offline partition [json-topic,0] (state.change.logger)
[2017-12-06 13:15:35,509] TRACE Controller 0 epoch 36 changed partition [json-topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-06 13:15:35,509] TRACE Controller 0 epoch 36 started leader election for partition [test,0] (state.change.logger)
[2017-12-06 13:15:35,519] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:34),ReplicationFactor:1),AllReplicas:0) for partition test3-0 in response to UpdateMetadata request sent by controller 0 epoch 36 with correlation id 0 (state.change.logger)
[2017-12-06 13:15:35,519] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:34),ReplicationFactor:1),AllReplicas:0) for partition test1-0 in response to UpdateMetadata request sent by controller 0 epoch 36 with correlation id 0 (state.change.logger)
[2017-12-06 13:15:35,519] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:34),ReplicationFactor:1),AllReplicas:0) for partition log-0 in response to UpdateMetadata request sent by controller 0 epoch 36 with correlation id 0 (state.change.logger)
[2017-12-06 13:15:35,519] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:29,ControllerEpoch:34),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 36 with correlation id 0 (state.change.logger)
[2017-12-06 13:15:35,519] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:22,ControllerEpoch:34),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 36 with correlation id 0 (state.change.logger)
[2017-12-06 13:15:35,549] TRACE Controller 0 epoch 36 elected leader 0 for Offline partition [test,0] (state.change.logger)
[2017-12-06 13:15:35,549] TRACE Controller 0 epoch 36 changed partition [test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-06 13:15:35,549] TRACE Controller 0 epoch 36 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:36) to broker 0 for partition [test1,0] (state.change.logger)
[2017-12-06 13:15:35,549] TRACE Controller 0 epoch 36 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:36) to broker 0 for partition [test3,0] (state.change.logger)
[2017-12-06 13:15:35,549] TRACE Controller 0 epoch 36 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:30,ControllerEpoch:36) to broker 0 for partition [test,0] (state.change.logger)
[2017-12-06 13:15:35,549] TRACE Controller 0 epoch 36 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:23,ControllerEpoch:36) to broker 0 for partition [json-topic,0] (state.change.logger)
[2017-12-06 13:15:35,549] TRACE Controller 0 epoch 36 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:36) to broker 0 for partition [log,0] (state.change.logger)
[2017-12-06 13:15:35,549] TRACE Controller 0 epoch 36 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:36) to broker 0 for partition test1-0 (state.change.logger)
[2017-12-06 13:15:35,549] TRACE Controller 0 epoch 36 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:36) to broker 0 for partition test3-0 (state.change.logger)
[2017-12-06 13:15:35,549] TRACE Controller 0 epoch 36 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:30,ControllerEpoch:36) to broker 0 for partition test-0 (state.change.logger)
[2017-12-06 13:15:35,549] TRACE Controller 0 epoch 36 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:23,ControllerEpoch:36) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-12-06 13:15:35,549] TRACE Controller 0 epoch 36 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:36) to broker 0 for partition log-0 (state.change.logger)
[2017-12-06 13:15:35,669] TRACE Controller 0 epoch 36 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-06 13:15:35,790] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=34, leader=0, leaderEpoch=6, isr=[0], zkVersion=6, replicas=[0]) correlation id 1 from controller 0 epoch 36 for partition [test3,0] (state.change.logger)
[2017-12-06 13:15:35,790] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=34, leader=0, leaderEpoch=7, isr=[0], zkVersion=7, replicas=[0]) correlation id 1 from controller 0 epoch 36 for partition [test1,0] (state.change.logger)
[2017-12-06 13:15:35,790] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=34, leader=0, leaderEpoch=5, isr=[0], zkVersion=5, replicas=[0]) correlation id 1 from controller 0 epoch 36 for partition [log,0] (state.change.logger)
[2017-12-06 13:15:35,790] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=34, leader=0, leaderEpoch=29, isr=[0], zkVersion=29, replicas=[0]) correlation id 1 from controller 0 epoch 36 for partition [test,0] (state.change.logger)
[2017-12-06 13:15:35,790] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=34, leader=0, leaderEpoch=22, isr=[0], zkVersion=22, replicas=[0]) correlation id 1 from controller 0 epoch 36 for partition [json-topic,0] (state.change.logger)
[2017-12-06 13:15:35,820] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 36 starting the become-leader transition for partition [test1,0] (state.change.logger)
[2017-12-06 13:15:35,820] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 36 starting the become-leader transition for partition [test3,0] (state.change.logger)
[2017-12-06 13:15:35,820] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 36 starting the become-leader transition for partition [test,0] (state.change.logger)
[2017-12-06 13:15:35,820] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 36 starting the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-12-06 13:15:35,820] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 36 starting the become-leader transition for partition [log,0] (state.change.logger)
[2017-12-06 13:15:35,880] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 36 with correlation id 1 for partition [json-topic,0] (state.change.logger)
[2017-12-06 13:15:35,880] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 36 with correlation id 1 for partition [test1,0] (state.change.logger)
[2017-12-06 13:15:35,880] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 36 with correlation id 1 for partition [log,0] (state.change.logger)
[2017-12-06 13:15:35,880] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 36 with correlation id 1 for partition [test,0] (state.change.logger)
[2017-12-06 13:15:35,880] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 36 with correlation id 1 for partition [test3,0] (state.change.logger)
[2017-12-06 13:15:35,880] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 36 for the become-leader transition for partition [test1,0] (state.change.logger)
[2017-12-06 13:15:35,880] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 36 for the become-leader transition for partition [test3,0] (state.change.logger)
[2017-12-06 13:15:35,880] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 36 for the become-leader transition for partition [test,0] (state.change.logger)
[2017-12-06 13:15:35,880] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 36 for the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-12-06 13:15:35,880] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 36 for the become-leader transition for partition [log,0] (state.change.logger)
[2017-12-06 13:15:35,890] TRACE Controller 0 epoch 36 received response {error_code=0,partitions=[{topic=test1,partition=0,error_code=0},{topic=test3,partition=0,error_code=0},{topic=json-topic,partition=0,error_code=0},{topic=test,partition=0,error_code=0},{topic=log,partition=0,error_code=0}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-06 13:15:35,890] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:34),ReplicationFactor:1),AllReplicas:0) for partition test3-0 in response to UpdateMetadata request sent by controller 0 epoch 36 with correlation id 2 (state.change.logger)
[2017-12-06 13:15:35,890] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:34),ReplicationFactor:1),AllReplicas:0) for partition test1-0 in response to UpdateMetadata request sent by controller 0 epoch 36 with correlation id 2 (state.change.logger)
[2017-12-06 13:15:35,890] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:34),ReplicationFactor:1),AllReplicas:0) for partition log-0 in response to UpdateMetadata request sent by controller 0 epoch 36 with correlation id 2 (state.change.logger)
[2017-12-06 13:15:35,890] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:29,ControllerEpoch:34),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 36 with correlation id 2 (state.change.logger)
[2017-12-06 13:15:35,890] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:22,ControllerEpoch:34),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 36 with correlation id 2 (state.change.logger)
[2017-12-06 13:15:35,890] TRACE Controller 0 epoch 36 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-06 13:15:35,890] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=36, leader=0, leaderEpoch=7, isr=[0], zkVersion=7, replicas=[0]) correlation id 3 from controller 0 epoch 36 for partition [test3,0] (state.change.logger)
[2017-12-06 13:15:35,890] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=36, leader=0, leaderEpoch=8, isr=[0], zkVersion=8, replicas=[0]) correlation id 3 from controller 0 epoch 36 for partition [test1,0] (state.change.logger)
[2017-12-06 13:15:35,890] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=36, leader=0, leaderEpoch=6, isr=[0], zkVersion=6, replicas=[0]) correlation id 3 from controller 0 epoch 36 for partition [log,0] (state.change.logger)
[2017-12-06 13:15:35,890] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=36, leader=0, leaderEpoch=30, isr=[0], zkVersion=30, replicas=[0]) correlation id 3 from controller 0 epoch 36 for partition [test,0] (state.change.logger)
[2017-12-06 13:15:35,890] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=36, leader=0, leaderEpoch=23, isr=[0], zkVersion=23, replicas=[0]) correlation id 3 from controller 0 epoch 36 for partition [json-topic,0] (state.change.logger)
[2017-12-06 13:15:35,890] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 36 starting the become-leader transition for partition [test1,0] (state.change.logger)
[2017-12-06 13:15:35,890] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 36 starting the become-leader transition for partition [test3,0] (state.change.logger)
[2017-12-06 13:15:35,890] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 36 starting the become-leader transition for partition [test,0] (state.change.logger)
[2017-12-06 13:15:35,890] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 36 starting the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-12-06 13:15:35,890] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 36 starting the become-leader transition for partition [log,0] (state.change.logger)
[2017-12-06 13:15:35,900] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 36 for partition [test1,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-06 13:15:35,900] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 36 for partition [test3,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-06 13:15:35,900] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 36 for partition [test,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-06 13:15:35,900] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 36 for partition [json-topic,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-06 13:15:35,900] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 36 for partition [log,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-06 13:15:35,900] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 36 for the become-leader transition for partition [test1,0] (state.change.logger)
[2017-12-06 13:15:35,900] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 36 for the become-leader transition for partition [test3,0] (state.change.logger)
[2017-12-06 13:15:35,900] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 36 for the become-leader transition for partition [test,0] (state.change.logger)
[2017-12-06 13:15:35,900] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 36 for the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-12-06 13:15:35,900] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 36 for the become-leader transition for partition [log,0] (state.change.logger)
[2017-12-06 13:15:35,900] TRACE Controller 0 epoch 36 received response {error_code=0,partitions=[{topic=test1,partition=0,error_code=0},{topic=test3,partition=0,error_code=0},{topic=json-topic,partition=0,error_code=0},{topic=test,partition=0,error_code=0},{topic=log,partition=0,error_code=0}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-06 13:15:35,900] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:36),ReplicationFactor:1),AllReplicas:0) for partition test3-0 in response to UpdateMetadata request sent by controller 0 epoch 36 with correlation id 4 (state.change.logger)
[2017-12-06 13:15:35,900] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:36),ReplicationFactor:1),AllReplicas:0) for partition test1-0 in response to UpdateMetadata request sent by controller 0 epoch 36 with correlation id 4 (state.change.logger)
[2017-12-06 13:15:35,900] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:36),ReplicationFactor:1),AllReplicas:0) for partition log-0 in response to UpdateMetadata request sent by controller 0 epoch 36 with correlation id 4 (state.change.logger)
[2017-12-06 13:15:35,900] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:30,ControllerEpoch:36),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 36 with correlation id 4 (state.change.logger)
[2017-12-06 13:15:35,900] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:23,ControllerEpoch:36),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 36 with correlation id 4 (state.change.logger)
[2017-12-06 13:15:35,900] TRACE Controller 0 epoch 36 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-07 15:15:51,322] TRACE Controller 0 epoch 37 started leader election for partition [test1,0] (state.change.logger)
[2017-12-07 15:15:51,622] ERROR Controller 0 epoch 37 initiated state change for partition [test1,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test1,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1168)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1166)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-12-07 15:15:51,682] TRACE Controller 0 epoch 37 started leader election for partition [test3,0] (state.change.logger)
[2017-12-07 15:15:51,734] ERROR Controller 0 epoch 37 initiated state change for partition [test3,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test3,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1168)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1166)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-12-07 15:15:51,735] TRACE Controller 0 epoch 37 started leader election for partition [log,0] (state.change.logger)
[2017-12-07 15:15:51,792] ERROR Controller 0 epoch 37 initiated state change for partition [log,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [log,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1168)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1166)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-12-07 15:15:51,805] TRACE Controller 0 epoch 37 started leader election for partition [json-topic,0] (state.change.logger)
[2017-12-07 15:15:51,865] ERROR Controller 0 epoch 37 initiated state change for partition [json-topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [json-topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1168)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1166)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-12-07 15:15:51,865] TRACE Controller 0 epoch 37 started leader election for partition [test,0] (state.change.logger)
[2017-12-07 15:15:51,939] ERROR Controller 0 epoch 37 initiated state change for partition [test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1168)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1166)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-12-07 15:15:52,603] TRACE Controller 0 epoch 37 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:36) to broker 0 for partition test1-0 (state.change.logger)
[2017-12-07 15:15:52,603] TRACE Controller 0 epoch 37 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:36) to broker 0 for partition test3-0 (state.change.logger)
[2017-12-07 15:15:52,603] TRACE Controller 0 epoch 37 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:30,ControllerEpoch:36) to broker 0 for partition test-0 (state.change.logger)
[2017-12-07 15:15:52,603] TRACE Controller 0 epoch 37 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:23,ControllerEpoch:36) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-12-07 15:15:52,603] TRACE Controller 0 epoch 37 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:36) to broker 0 for partition log-0 (state.change.logger)
[2017-12-07 15:15:52,660] TRACE Controller 0 epoch 37 changed state of replica 0 for partition [test3,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-07 15:15:52,660] TRACE Controller 0 epoch 37 changed state of replica 0 for partition [test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-07 15:15:52,660] TRACE Controller 0 epoch 37 changed state of replica 0 for partition [json-topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-07 15:15:52,660] TRACE Controller 0 epoch 37 changed state of replica 0 for partition [log,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-07 15:15:52,660] TRACE Controller 0 epoch 37 changed state of replica 0 for partition [test1,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-07 15:15:52,660] TRACE Controller 0 epoch 37 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:36) to broker 0 for partition [test1,0] (state.change.logger)
[2017-12-07 15:15:52,660] TRACE Controller 0 epoch 37 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:36) to broker 0 for partition [test3,0] (state.change.logger)
[2017-12-07 15:15:52,660] TRACE Controller 0 epoch 37 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:23,ControllerEpoch:36) to broker 0 for partition [json-topic,0] (state.change.logger)
[2017-12-07 15:15:52,660] TRACE Controller 0 epoch 37 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:30,ControllerEpoch:36) to broker 0 for partition [test,0] (state.change.logger)
[2017-12-07 15:15:52,660] TRACE Controller 0 epoch 37 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:36) to broker 0 for partition [log,0] (state.change.logger)
[2017-12-07 15:15:52,661] TRACE Controller 0 epoch 37 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:36) to broker 0 for partition test1-0 (state.change.logger)
[2017-12-07 15:15:52,661] TRACE Controller 0 epoch 37 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:36) to broker 0 for partition test3-0 (state.change.logger)
[2017-12-07 15:15:52,662] TRACE Controller 0 epoch 37 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:23,ControllerEpoch:36) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-12-07 15:15:52,662] TRACE Controller 0 epoch 37 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:30,ControllerEpoch:36) to broker 0 for partition test-0 (state.change.logger)
[2017-12-07 15:15:52,662] TRACE Controller 0 epoch 37 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:36) to broker 0 for partition log-0 (state.change.logger)
[2017-12-07 15:15:52,662] TRACE Controller 0 epoch 37 started leader election for partition [test1,0] (state.change.logger)
[2017-12-07 15:15:52,788] TRACE Controller 0 epoch 37 elected leader 0 for Offline partition [test1,0] (state.change.logger)
[2017-12-07 15:15:52,788] TRACE Controller 0 epoch 37 changed partition [test1,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-07 15:15:52,788] TRACE Controller 0 epoch 37 started leader election for partition [test3,0] (state.change.logger)
[2017-12-07 15:15:52,925] TRACE Controller 0 epoch 37 elected leader 0 for Offline partition [test3,0] (state.change.logger)
[2017-12-07 15:15:52,925] TRACE Controller 0 epoch 37 changed partition [test3,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-07 15:15:52,925] TRACE Controller 0 epoch 37 started leader election for partition [log,0] (state.change.logger)
[2017-12-07 15:15:53,052] TRACE Controller 0 epoch 37 elected leader 0 for Offline partition [log,0] (state.change.logger)
[2017-12-07 15:15:53,053] TRACE Controller 0 epoch 37 changed partition [log,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-07 15:15:53,053] TRACE Controller 0 epoch 37 started leader election for partition [json-topic,0] (state.change.logger)
[2017-12-07 15:15:53,062] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:36),ReplicationFactor:1),AllReplicas:0) for partition test3-0 in response to UpdateMetadata request sent by controller 0 epoch 37 with correlation id 0 (state.change.logger)
[2017-12-07 15:15:53,132] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:36),ReplicationFactor:1),AllReplicas:0) for partition test1-0 in response to UpdateMetadata request sent by controller 0 epoch 37 with correlation id 0 (state.change.logger)
[2017-12-07 15:15:53,132] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:36),ReplicationFactor:1),AllReplicas:0) for partition log-0 in response to UpdateMetadata request sent by controller 0 epoch 37 with correlation id 0 (state.change.logger)
[2017-12-07 15:15:53,132] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:30,ControllerEpoch:36),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 37 with correlation id 0 (state.change.logger)
[2017-12-07 15:15:53,132] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:23,ControllerEpoch:36),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 37 with correlation id 0 (state.change.logger)
[2017-12-07 15:15:53,143] TRACE Controller 0 epoch 37 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-07 15:15:53,305] TRACE Controller 0 epoch 37 elected leader 0 for Offline partition [json-topic,0] (state.change.logger)
[2017-12-07 15:15:53,305] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=36, leader=0, leaderEpoch=7, isr=[0], zkVersion=7, replicas=[0]) correlation id 1 from controller 0 epoch 37 for partition [test3,0] (state.change.logger)
[2017-12-07 15:15:53,305] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=36, leader=0, leaderEpoch=8, isr=[0], zkVersion=8, replicas=[0]) correlation id 1 from controller 0 epoch 37 for partition [test1,0] (state.change.logger)
[2017-12-07 15:15:53,305] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=36, leader=0, leaderEpoch=6, isr=[0], zkVersion=6, replicas=[0]) correlation id 1 from controller 0 epoch 37 for partition [log,0] (state.change.logger)
[2017-12-07 15:15:53,305] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=36, leader=0, leaderEpoch=30, isr=[0], zkVersion=30, replicas=[0]) correlation id 1 from controller 0 epoch 37 for partition [test,0] (state.change.logger)
[2017-12-07 15:15:53,305] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=36, leader=0, leaderEpoch=23, isr=[0], zkVersion=23, replicas=[0]) correlation id 1 from controller 0 epoch 37 for partition [json-topic,0] (state.change.logger)
[2017-12-07 15:15:53,306] TRACE Controller 0 epoch 37 changed partition [json-topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-07 15:15:53,306] TRACE Controller 0 epoch 37 started leader election for partition [test,0] (state.change.logger)
[2017-12-07 15:15:53,418] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 37 for partition [test3,0] since its associated leader epoch 7 is not higher than the current leader epoch 7 (state.change.logger)
[2017-12-07 15:15:53,419] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 37 for partition [test1,0] since its associated leader epoch 8 is not higher than the current leader epoch 8 (state.change.logger)
[2017-12-07 15:15:53,419] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 37 for partition [log,0] since its associated leader epoch 6 is not higher than the current leader epoch 6 (state.change.logger)
[2017-12-07 15:15:53,419] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 37 for partition [test,0] since its associated leader epoch 30 is not higher than the current leader epoch 30 (state.change.logger)
[2017-12-07 15:15:53,419] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 37 for partition [json-topic,0] since its associated leader epoch 23 is not higher than the current leader epoch 23 (state.change.logger)
[2017-12-07 15:15:53,438] TRACE Controller 0 epoch 37 received response {error_code=0,partitions=[{topic=test1,partition=0,error_code=11},{topic=test3,partition=0,error_code=11},{topic=json-topic,partition=0,error_code=11},{topic=test,partition=0,error_code=11},{topic=log,partition=0,error_code=11}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-07 15:15:53,461] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:36),ReplicationFactor:1),AllReplicas:0) for partition test3-0 in response to UpdateMetadata request sent by controller 0 epoch 37 with correlation id 2 (state.change.logger)
[2017-12-07 15:15:53,462] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:36),ReplicationFactor:1),AllReplicas:0) for partition test1-0 in response to UpdateMetadata request sent by controller 0 epoch 37 with correlation id 2 (state.change.logger)
[2017-12-07 15:15:53,463] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:36),ReplicationFactor:1),AllReplicas:0) for partition log-0 in response to UpdateMetadata request sent by controller 0 epoch 37 with correlation id 2 (state.change.logger)
[2017-12-07 15:15:53,463] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:30,ControllerEpoch:36),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 37 with correlation id 2 (state.change.logger)
[2017-12-07 15:15:53,463] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:23,ControllerEpoch:36),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 37 with correlation id 2 (state.change.logger)
[2017-12-07 15:15:53,463] TRACE Controller 0 epoch 37 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-07 15:15:53,473] TRACE Controller 0 epoch 37 elected leader 0 for Offline partition [test,0] (state.change.logger)
[2017-12-07 15:15:53,473] TRACE Controller 0 epoch 37 changed partition [test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-07 15:15:53,473] TRACE Controller 0 epoch 37 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:37) to broker 0 for partition [test1,0] (state.change.logger)
[2017-12-07 15:15:53,473] TRACE Controller 0 epoch 37 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:37) to broker 0 for partition [test3,0] (state.change.logger)
[2017-12-07 15:15:53,474] TRACE Controller 0 epoch 37 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:31,ControllerEpoch:37) to broker 0 for partition [test,0] (state.change.logger)
[2017-12-07 15:15:53,474] TRACE Controller 0 epoch 37 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:24,ControllerEpoch:37) to broker 0 for partition [json-topic,0] (state.change.logger)
[2017-12-07 15:15:53,474] TRACE Controller 0 epoch 37 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:37) to broker 0 for partition [log,0] (state.change.logger)
[2017-12-07 15:15:53,474] TRACE Controller 0 epoch 37 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:37) to broker 0 for partition test1-0 (state.change.logger)
[2017-12-07 15:15:53,474] TRACE Controller 0 epoch 37 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:37) to broker 0 for partition test3-0 (state.change.logger)
[2017-12-07 15:15:53,474] TRACE Controller 0 epoch 37 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:31,ControllerEpoch:37) to broker 0 for partition test-0 (state.change.logger)
[2017-12-07 15:15:53,474] TRACE Controller 0 epoch 37 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:24,ControllerEpoch:37) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-12-07 15:15:53,474] TRACE Controller 0 epoch 37 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:37) to broker 0 for partition log-0 (state.change.logger)
[2017-12-07 15:15:53,474] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=37, leader=0, leaderEpoch=8, isr=[0], zkVersion=8, replicas=[0]) correlation id 3 from controller 0 epoch 37 for partition [test3,0] (state.change.logger)
[2017-12-07 15:15:53,474] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=37, leader=0, leaderEpoch=9, isr=[0], zkVersion=9, replicas=[0]) correlation id 3 from controller 0 epoch 37 for partition [test1,0] (state.change.logger)
[2017-12-07 15:15:53,474] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=37, leader=0, leaderEpoch=7, isr=[0], zkVersion=7, replicas=[0]) correlation id 3 from controller 0 epoch 37 for partition [log,0] (state.change.logger)
[2017-12-07 15:15:53,474] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=37, leader=0, leaderEpoch=31, isr=[0], zkVersion=31, replicas=[0]) correlation id 3 from controller 0 epoch 37 for partition [test,0] (state.change.logger)
[2017-12-07 15:15:53,474] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=37, leader=0, leaderEpoch=24, isr=[0], zkVersion=24, replicas=[0]) correlation id 3 from controller 0 epoch 37 for partition [json-topic,0] (state.change.logger)
[2017-12-07 15:15:53,475] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 37 starting the become-leader transition for partition [test1,0] (state.change.logger)
[2017-12-07 15:15:53,475] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 37 starting the become-leader transition for partition [test3,0] (state.change.logger)
[2017-12-07 15:15:53,475] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 37 starting the become-leader transition for partition [test,0] (state.change.logger)
[2017-12-07 15:15:53,475] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 37 starting the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-12-07 15:15:53,487] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 37 starting the become-leader transition for partition [log,0] (state.change.logger)
[2017-12-07 15:15:53,487] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 37 for partition [test1,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-07 15:15:53,487] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 37 for partition [test3,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-07 15:15:53,488] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 37 for partition [test,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-07 15:15:53,488] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 37 for partition [json-topic,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-07 15:15:53,488] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 37 for partition [log,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-07 15:15:53,488] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 37 for the become-leader transition for partition [test1,0] (state.change.logger)
[2017-12-07 15:15:53,488] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 37 for the become-leader transition for partition [test3,0] (state.change.logger)
[2017-12-07 15:15:53,488] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 37 for the become-leader transition for partition [test,0] (state.change.logger)
[2017-12-07 15:15:53,488] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 37 for the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-12-07 15:15:53,488] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 37 for the become-leader transition for partition [log,0] (state.change.logger)
[2017-12-07 15:15:53,488] TRACE Controller 0 epoch 37 received response {error_code=0,partitions=[{topic=test1,partition=0,error_code=0},{topic=test3,partition=0,error_code=0},{topic=json-topic,partition=0,error_code=0},{topic=test,partition=0,error_code=0},{topic=log,partition=0,error_code=0}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-07 15:15:53,489] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:0) for partition test3-0 in response to UpdateMetadata request sent by controller 0 epoch 37 with correlation id 4 (state.change.logger)
[2017-12-07 15:15:53,489] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:0) for partition test1-0 in response to UpdateMetadata request sent by controller 0 epoch 37 with correlation id 4 (state.change.logger)
[2017-12-07 15:15:53,489] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:0) for partition log-0 in response to UpdateMetadata request sent by controller 0 epoch 37 with correlation id 4 (state.change.logger)
[2017-12-07 15:15:53,489] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:31,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 37 with correlation id 4 (state.change.logger)
[2017-12-07 15:15:53,547] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:24,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 37 with correlation id 4 (state.change.logger)
[2017-12-07 15:15:53,547] TRACE Controller 0 epoch 37 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-08 08:33:50,069] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2017-12-08 08:33:59,778] TRACE Controller 0 epoch 38 started leader election for partition [test1,0] (state.change.logger)
[2017-12-08 08:33:59,792] ERROR Controller 0 epoch 38 initiated state change for partition [test1,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test1,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-12-08 08:34:00,021] TRACE Controller 0 epoch 38 started leader election for partition [test3,0] (state.change.logger)
[2017-12-08 08:34:00,031] ERROR Controller 0 epoch 38 initiated state change for partition [test3,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test3,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-12-08 08:34:00,031] TRACE Controller 0 epoch 38 started leader election for partition [log,0] (state.change.logger)
[2017-12-08 08:34:00,052] ERROR Controller 0 epoch 38 initiated state change for partition [log,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [log,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-12-08 08:34:00,052] TRACE Controller 0 epoch 38 started leader election for partition [json-topic,0] (state.change.logger)
[2017-12-08 08:34:00,053] ERROR Controller 0 epoch 38 initiated state change for partition [json-topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [json-topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-12-08 08:34:00,054] TRACE Controller 0 epoch 38 started leader election for partition [test,0] (state.change.logger)
[2017-12-08 08:34:00,087] ERROR Controller 0 epoch 38 initiated state change for partition [test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-12-08 08:34:01,350] TRACE Controller 0 epoch 38 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:37) to broker 0 for partition test1-0 (state.change.logger)
[2017-12-08 08:34:01,350] TRACE Controller 0 epoch 38 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:37) to broker 0 for partition test3-0 (state.change.logger)
[2017-12-08 08:34:01,350] TRACE Controller 0 epoch 38 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:31,ControllerEpoch:37) to broker 0 for partition test-0 (state.change.logger)
[2017-12-08 08:34:01,350] TRACE Controller 0 epoch 38 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:24,ControllerEpoch:37) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-12-08 08:34:01,350] TRACE Controller 0 epoch 38 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:37) to broker 0 for partition log-0 (state.change.logger)
[2017-12-08 08:34:01,485] TRACE Controller 0 epoch 38 changed state of replica 0 for partition [test3,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-08 08:34:01,485] TRACE Controller 0 epoch 38 changed state of replica 0 for partition [test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-08 08:34:01,485] TRACE Controller 0 epoch 38 changed state of replica 0 for partition [json-topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-08 08:34:01,485] TRACE Controller 0 epoch 38 changed state of replica 0 for partition [log,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-08 08:34:01,485] TRACE Controller 0 epoch 38 changed state of replica 0 for partition [test1,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-08 08:34:01,496] TRACE Controller 0 epoch 38 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:37) to broker 0 for partition [test1,0] (state.change.logger)
[2017-12-08 08:34:01,496] TRACE Controller 0 epoch 38 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:37) to broker 0 for partition [test3,0] (state.change.logger)
[2017-12-08 08:34:01,496] TRACE Controller 0 epoch 38 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:24,ControllerEpoch:37) to broker 0 for partition [json-topic,0] (state.change.logger)
[2017-12-08 08:34:01,496] TRACE Controller 0 epoch 38 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:31,ControllerEpoch:37) to broker 0 for partition [test,0] (state.change.logger)
[2017-12-08 08:34:01,496] TRACE Controller 0 epoch 38 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:37) to broker 0 for partition [log,0] (state.change.logger)
[2017-12-08 08:34:01,516] TRACE Controller 0 epoch 38 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:37) to broker 0 for partition test1-0 (state.change.logger)
[2017-12-08 08:34:01,516] TRACE Controller 0 epoch 38 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:37) to broker 0 for partition test3-0 (state.change.logger)
[2017-12-08 08:34:01,516] TRACE Controller 0 epoch 38 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:24,ControllerEpoch:37) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-12-08 08:34:01,516] TRACE Controller 0 epoch 38 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:31,ControllerEpoch:37) to broker 0 for partition test-0 (state.change.logger)
[2017-12-08 08:34:01,516] TRACE Controller 0 epoch 38 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:37) to broker 0 for partition log-0 (state.change.logger)
[2017-12-08 08:34:01,516] TRACE Controller 0 epoch 38 started leader election for partition [test1,0] (state.change.logger)
[2017-12-08 08:34:01,744] TRACE Controller 0 epoch 38 elected leader 0 for Offline partition [test1,0] (state.change.logger)
[2017-12-08 08:34:01,886] TRACE Controller 0 epoch 38 changed partition [test1,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-08 08:34:01,886] TRACE Controller 0 epoch 38 started leader election for partition [test3,0] (state.change.logger)
[2017-12-08 08:34:01,948] TRACE Controller 0 epoch 38 elected leader 0 for Offline partition [test3,0] (state.change.logger)
[2017-12-08 08:34:01,952] TRACE Controller 0 epoch 38 changed partition [test3,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-08 08:34:01,952] TRACE Controller 0 epoch 38 started leader election for partition [log,0] (state.change.logger)
[2017-12-08 08:34:02,010] TRACE Controller 0 epoch 38 elected leader 0 for Offline partition [log,0] (state.change.logger)
[2017-12-08 08:34:02,011] TRACE Controller 0 epoch 38 changed partition [log,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-08 08:34:02,011] TRACE Controller 0 epoch 38 started leader election for partition [json-topic,0] (state.change.logger)
[2017-12-08 08:34:02,130] TRACE Controller 0 epoch 38 elected leader 0 for Offline partition [json-topic,0] (state.change.logger)
[2017-12-08 08:34:02,130] TRACE Controller 0 epoch 38 changed partition [json-topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-08 08:34:02,131] TRACE Controller 0 epoch 38 started leader election for partition [test,0] (state.change.logger)
[2017-12-08 08:34:02,144] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:0) for partition test3-0 in response to UpdateMetadata request sent by controller 0 epoch 38 with correlation id 0 (state.change.logger)
[2017-12-08 08:34:02,144] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:0) for partition test1-0 in response to UpdateMetadata request sent by controller 0 epoch 38 with correlation id 0 (state.change.logger)
[2017-12-08 08:34:02,145] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:0) for partition log-0 in response to UpdateMetadata request sent by controller 0 epoch 38 with correlation id 0 (state.change.logger)
[2017-12-08 08:34:02,145] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:31,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 38 with correlation id 0 (state.change.logger)
[2017-12-08 08:34:02,145] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:24,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 38 with correlation id 0 (state.change.logger)
[2017-12-08 08:34:02,208] TRACE Controller 0 epoch 38 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-08 08:34:02,286] TRACE Controller 0 epoch 38 elected leader 0 for Offline partition [test,0] (state.change.logger)
[2017-12-08 08:34:02,286] TRACE Controller 0 epoch 38 changed partition [test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-08 08:34:02,286] TRACE Controller 0 epoch 38 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:10,ControllerEpoch:38) to broker 0 for partition [test1,0] (state.change.logger)
[2017-12-08 08:34:02,286] TRACE Controller 0 epoch 38 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:38) to broker 0 for partition [test3,0] (state.change.logger)
[2017-12-08 08:34:02,286] TRACE Controller 0 epoch 38 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:38) to broker 0 for partition [test,0] (state.change.logger)
[2017-12-08 08:34:02,286] TRACE Controller 0 epoch 38 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:25,ControllerEpoch:38) to broker 0 for partition [json-topic,0] (state.change.logger)
[2017-12-08 08:34:02,286] TRACE Controller 0 epoch 38 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:38) to broker 0 for partition [log,0] (state.change.logger)
[2017-12-08 08:34:02,286] TRACE Controller 0 epoch 38 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:10,ControllerEpoch:38) to broker 0 for partition test1-0 (state.change.logger)
[2017-12-08 08:34:02,286] TRACE Controller 0 epoch 38 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:38) to broker 0 for partition test3-0 (state.change.logger)
[2017-12-08 08:34:02,286] TRACE Controller 0 epoch 38 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:38) to broker 0 for partition test-0 (state.change.logger)
[2017-12-08 08:34:02,286] TRACE Controller 0 epoch 38 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:25,ControllerEpoch:38) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-12-08 08:34:02,286] TRACE Controller 0 epoch 38 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:38) to broker 0 for partition log-0 (state.change.logger)
[2017-12-08 08:34:02,395] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=37, leader=0, leaderEpoch=8, isr=[0], zkVersion=8, replicas=[0]) correlation id 1 from controller 0 epoch 38 for partition [test3,0] (state.change.logger)
[2017-12-08 08:34:02,395] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=37, leader=0, leaderEpoch=9, isr=[0], zkVersion=9, replicas=[0]) correlation id 1 from controller 0 epoch 38 for partition [test1,0] (state.change.logger)
[2017-12-08 08:34:02,395] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=37, leader=0, leaderEpoch=7, isr=[0], zkVersion=7, replicas=[0]) correlation id 1 from controller 0 epoch 38 for partition [log,0] (state.change.logger)
[2017-12-08 08:34:02,398] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=37, leader=0, leaderEpoch=31, isr=[0], zkVersion=31, replicas=[0]) correlation id 1 from controller 0 epoch 38 for partition [test,0] (state.change.logger)
[2017-12-08 08:34:02,399] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=37, leader=0, leaderEpoch=24, isr=[0], zkVersion=24, replicas=[0]) correlation id 1 from controller 0 epoch 38 for partition [json-topic,0] (state.change.logger)
[2017-12-08 08:34:02,499] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 38 starting the become-leader transition for partition [test1,0] (state.change.logger)
[2017-12-08 08:34:02,500] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 38 starting the become-leader transition for partition [test3,0] (state.change.logger)
[2017-12-08 08:34:02,500] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 38 starting the become-leader transition for partition [test,0] (state.change.logger)
[2017-12-08 08:34:02,500] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 38 starting the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-12-08 08:34:02,500] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 38 starting the become-leader transition for partition [log,0] (state.change.logger)
[2017-12-08 08:34:02,650] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 38 with correlation id 1 for partition [json-topic,0] (state.change.logger)
[2017-12-08 08:34:02,650] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 38 with correlation id 1 for partition [test1,0] (state.change.logger)
[2017-12-08 08:34:02,651] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 38 with correlation id 1 for partition [log,0] (state.change.logger)
[2017-12-08 08:34:02,651] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 38 with correlation id 1 for partition [test,0] (state.change.logger)
[2017-12-08 08:34:02,651] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 38 with correlation id 1 for partition [test3,0] (state.change.logger)
[2017-12-08 08:34:02,667] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 38 for the become-leader transition for partition [test1,0] (state.change.logger)
[2017-12-08 08:34:02,667] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 38 for the become-leader transition for partition [test3,0] (state.change.logger)
[2017-12-08 08:34:02,667] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 38 for the become-leader transition for partition [test,0] (state.change.logger)
[2017-12-08 08:34:02,667] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 38 for the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-12-08 08:34:02,667] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 38 for the become-leader transition for partition [log,0] (state.change.logger)
[2017-12-08 08:34:02,713] TRACE Controller 0 epoch 38 received response {error_code=0,partitions=[{topic=test1,partition=0,error_code=0},{topic=test3,partition=0,error_code=0},{topic=json-topic,partition=0,error_code=0},{topic=test,partition=0,error_code=0},{topic=log,partition=0,error_code=0}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-08 08:34:02,713] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:0) for partition test3-0 in response to UpdateMetadata request sent by controller 0 epoch 38 with correlation id 2 (state.change.logger)
[2017-12-08 08:34:02,713] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:0) for partition test1-0 in response to UpdateMetadata request sent by controller 0 epoch 38 with correlation id 2 (state.change.logger)
[2017-12-08 08:34:02,713] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:0) for partition log-0 in response to UpdateMetadata request sent by controller 0 epoch 38 with correlation id 2 (state.change.logger)
[2017-12-08 08:34:02,713] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:31,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 38 with correlation id 2 (state.change.logger)
[2017-12-08 08:34:02,713] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:24,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 38 with correlation id 2 (state.change.logger)
[2017-12-08 08:34:02,723] TRACE Controller 0 epoch 38 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-08 08:34:02,723] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=38, leader=0, leaderEpoch=9, isr=[0], zkVersion=9, replicas=[0]) correlation id 3 from controller 0 epoch 38 for partition [test3,0] (state.change.logger)
[2017-12-08 08:34:02,723] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=38, leader=0, leaderEpoch=10, isr=[0], zkVersion=10, replicas=[0]) correlation id 3 from controller 0 epoch 38 for partition [test1,0] (state.change.logger)
[2017-12-08 08:34:02,723] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=38, leader=0, leaderEpoch=8, isr=[0], zkVersion=8, replicas=[0]) correlation id 3 from controller 0 epoch 38 for partition [log,0] (state.change.logger)
[2017-12-08 08:34:02,723] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=38, leader=0, leaderEpoch=32, isr=[0], zkVersion=32, replicas=[0]) correlation id 3 from controller 0 epoch 38 for partition [test,0] (state.change.logger)
[2017-12-08 08:34:02,723] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=38, leader=0, leaderEpoch=25, isr=[0], zkVersion=25, replicas=[0]) correlation id 3 from controller 0 epoch 38 for partition [json-topic,0] (state.change.logger)
[2017-12-08 08:34:02,723] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 38 starting the become-leader transition for partition [test1,0] (state.change.logger)
[2017-12-08 08:34:02,723] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 38 starting the become-leader transition for partition [test3,0] (state.change.logger)
[2017-12-08 08:34:02,723] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 38 starting the become-leader transition for partition [test,0] (state.change.logger)
[2017-12-08 08:34:02,723] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 38 starting the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-12-08 08:34:02,723] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 38 starting the become-leader transition for partition [log,0] (state.change.logger)
[2017-12-08 08:34:02,723] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 38 for partition [test1,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-08 08:34:02,723] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 38 for partition [test3,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-08 08:34:02,723] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 38 for partition [test,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-08 08:34:02,723] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 38 for partition [json-topic,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-08 08:34:02,723] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 38 for partition [log,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-08 08:34:02,723] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 38 for the become-leader transition for partition [test1,0] (state.change.logger)
[2017-12-08 08:34:02,723] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 38 for the become-leader transition for partition [test3,0] (state.change.logger)
[2017-12-08 08:34:02,723] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 38 for the become-leader transition for partition [test,0] (state.change.logger)
[2017-12-08 08:34:02,723] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 38 for the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-12-08 08:34:02,723] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 38 for the become-leader transition for partition [log,0] (state.change.logger)
[2017-12-08 08:34:02,723] TRACE Controller 0 epoch 38 received response {error_code=0,partitions=[{topic=test1,partition=0,error_code=0},{topic=test3,partition=0,error_code=0},{topic=json-topic,partition=0,error_code=0},{topic=test,partition=0,error_code=0},{topic=log,partition=0,error_code=0}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-08 08:34:02,723] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:38),ReplicationFactor:1),AllReplicas:0) for partition test3-0 in response to UpdateMetadata request sent by controller 0 epoch 38 with correlation id 4 (state.change.logger)
[2017-12-08 08:34:02,723] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:10,ControllerEpoch:38),ReplicationFactor:1),AllReplicas:0) for partition test1-0 in response to UpdateMetadata request sent by controller 0 epoch 38 with correlation id 4 (state.change.logger)
[2017-12-08 08:34:02,723] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:38),ReplicationFactor:1),AllReplicas:0) for partition log-0 in response to UpdateMetadata request sent by controller 0 epoch 38 with correlation id 4 (state.change.logger)
[2017-12-08 08:34:02,723] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:38),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 38 with correlation id 4 (state.change.logger)
[2017-12-08 08:34:02,723] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:25,ControllerEpoch:38),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 38 with correlation id 4 (state.change.logger)
[2017-12-08 08:34:02,734] TRACE Controller 0 epoch 38 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-08 09:03:18,636] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2017-12-08 09:03:30,770] TRACE Controller 0 epoch 39 started leader election for partition [test1,0] (state.change.logger)
[2017-12-08 09:03:30,779] ERROR Controller 0 epoch 39 initiated state change for partition [test1,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test1,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-12-08 09:03:30,831] TRACE Controller 0 epoch 39 started leader election for partition [test3,0] (state.change.logger)
[2017-12-08 09:03:30,841] ERROR Controller 0 epoch 39 initiated state change for partition [test3,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test3,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-12-08 09:03:30,841] TRACE Controller 0 epoch 39 started leader election for partition [log,0] (state.change.logger)
[2017-12-08 09:03:30,851] ERROR Controller 0 epoch 39 initiated state change for partition [log,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [log,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-12-08 09:03:30,852] TRACE Controller 0 epoch 39 started leader election for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:03:30,869] ERROR Controller 0 epoch 39 initiated state change for partition [json-topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [json-topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-12-08 09:03:30,869] TRACE Controller 0 epoch 39 started leader election for partition [test,0] (state.change.logger)
[2017-12-08 09:03:30,888] ERROR Controller 0 epoch 39 initiated state change for partition [test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-12-08 09:03:31,400] TRACE Controller 0 epoch 39 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:10,ControllerEpoch:38) to broker 0 for partition test1-0 (state.change.logger)
[2017-12-08 09:03:31,400] TRACE Controller 0 epoch 39 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:38) to broker 0 for partition test3-0 (state.change.logger)
[2017-12-08 09:03:31,400] TRACE Controller 0 epoch 39 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:38) to broker 0 for partition test-0 (state.change.logger)
[2017-12-08 09:03:31,400] TRACE Controller 0 epoch 39 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:25,ControllerEpoch:38) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-12-08 09:03:31,400] TRACE Controller 0 epoch 39 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:38) to broker 0 for partition log-0 (state.change.logger)
[2017-12-08 09:03:31,420] TRACE Controller 0 epoch 39 changed state of replica 0 for partition [test3,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-08 09:03:31,420] TRACE Controller 0 epoch 39 changed state of replica 0 for partition [test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-08 09:03:31,420] TRACE Controller 0 epoch 39 changed state of replica 0 for partition [json-topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-08 09:03:31,420] TRACE Controller 0 epoch 39 changed state of replica 0 for partition [log,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-08 09:03:31,430] TRACE Controller 0 epoch 39 changed state of replica 0 for partition [test1,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-08 09:03:31,430] TRACE Controller 0 epoch 39 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:10,ControllerEpoch:38) to broker 0 for partition [test1,0] (state.change.logger)
[2017-12-08 09:03:31,440] TRACE Controller 0 epoch 39 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:38) to broker 0 for partition [test3,0] (state.change.logger)
[2017-12-08 09:03:31,440] TRACE Controller 0 epoch 39 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:25,ControllerEpoch:38) to broker 0 for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:03:31,440] TRACE Controller 0 epoch 39 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:38) to broker 0 for partition [test,0] (state.change.logger)
[2017-12-08 09:03:31,440] TRACE Controller 0 epoch 39 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:38) to broker 0 for partition [log,0] (state.change.logger)
[2017-12-08 09:03:31,450] TRACE Controller 0 epoch 39 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:10,ControllerEpoch:38) to broker 0 for partition test1-0 (state.change.logger)
[2017-12-08 09:03:31,450] TRACE Controller 0 epoch 39 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:38) to broker 0 for partition test3-0 (state.change.logger)
[2017-12-08 09:03:31,450] TRACE Controller 0 epoch 39 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:25,ControllerEpoch:38) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-12-08 09:03:31,450] TRACE Controller 0 epoch 39 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:38) to broker 0 for partition test-0 (state.change.logger)
[2017-12-08 09:03:31,450] TRACE Controller 0 epoch 39 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:38) to broker 0 for partition log-0 (state.change.logger)
[2017-12-08 09:03:31,450] TRACE Controller 0 epoch 39 started leader election for partition [test1,0] (state.change.logger)
[2017-12-08 09:03:31,460] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:38),ReplicationFactor:1),AllReplicas:0) for partition test3-0 in response to UpdateMetadata request sent by controller 0 epoch 39 with correlation id 0 (state.change.logger)
[2017-12-08 09:03:31,470] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:10,ControllerEpoch:38),ReplicationFactor:1),AllReplicas:0) for partition test1-0 in response to UpdateMetadata request sent by controller 0 epoch 39 with correlation id 0 (state.change.logger)
[2017-12-08 09:03:31,470] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:38),ReplicationFactor:1),AllReplicas:0) for partition log-0 in response to UpdateMetadata request sent by controller 0 epoch 39 with correlation id 0 (state.change.logger)
[2017-12-08 09:03:31,470] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:38),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 39 with correlation id 0 (state.change.logger)
[2017-12-08 09:03:31,470] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:25,ControllerEpoch:38),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 39 with correlation id 0 (state.change.logger)
[2017-12-08 09:03:31,470] TRACE Controller 0 epoch 39 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-08 09:03:31,493] TRACE Controller 0 epoch 39 elected leader 0 for Offline partition [test1,0] (state.change.logger)
[2017-12-08 09:03:31,495] TRACE Controller 0 epoch 39 changed partition [test1,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-08 09:03:31,495] TRACE Controller 0 epoch 39 started leader election for partition [test3,0] (state.change.logger)
[2017-12-08 09:03:31,499] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=38, leader=0, leaderEpoch=9, isr=[0], zkVersion=9, replicas=[0]) correlation id 1 from controller 0 epoch 39 for partition [test3,0] (state.change.logger)
[2017-12-08 09:03:31,499] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=38, leader=0, leaderEpoch=10, isr=[0], zkVersion=10, replicas=[0]) correlation id 1 from controller 0 epoch 39 for partition [test1,0] (state.change.logger)
[2017-12-08 09:03:31,499] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=38, leader=0, leaderEpoch=8, isr=[0], zkVersion=8, replicas=[0]) correlation id 1 from controller 0 epoch 39 for partition [log,0] (state.change.logger)
[2017-12-08 09:03:31,499] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=38, leader=0, leaderEpoch=32, isr=[0], zkVersion=32, replicas=[0]) correlation id 1 from controller 0 epoch 39 for partition [test,0] (state.change.logger)
[2017-12-08 09:03:31,499] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=38, leader=0, leaderEpoch=25, isr=[0], zkVersion=25, replicas=[0]) correlation id 1 from controller 0 epoch 39 for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:03:31,552] TRACE Controller 0 epoch 39 elected leader 0 for Offline partition [test3,0] (state.change.logger)
[2017-12-08 09:03:31,552] TRACE Controller 0 epoch 39 changed partition [test3,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-08 09:03:31,552] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 39 starting the become-leader transition for partition [test1,0] (state.change.logger)
[2017-12-08 09:03:31,552] TRACE Controller 0 epoch 39 started leader election for partition [log,0] (state.change.logger)
[2017-12-08 09:03:31,552] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 39 starting the become-leader transition for partition [test3,0] (state.change.logger)
[2017-12-08 09:03:31,552] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 39 starting the become-leader transition for partition [test,0] (state.change.logger)
[2017-12-08 09:03:31,552] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 39 starting the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:03:31,552] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 39 starting the become-leader transition for partition [log,0] (state.change.logger)
[2017-12-08 09:03:31,573] TRACE Controller 0 epoch 39 elected leader 0 for Offline partition [log,0] (state.change.logger)
[2017-12-08 09:03:31,573] TRACE Controller 0 epoch 39 changed partition [log,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-08 09:03:31,573] TRACE Controller 0 epoch 39 started leader election for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:03:31,591] TRACE Controller 0 epoch 39 elected leader 0 for Offline partition [json-topic,0] (state.change.logger)
[2017-12-08 09:03:31,592] TRACE Controller 0 epoch 39 changed partition [json-topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-08 09:03:31,592] TRACE Controller 0 epoch 39 started leader election for partition [test,0] (state.change.logger)
[2017-12-08 09:03:31,673] TRACE Controller 0 epoch 39 elected leader 0 for Offline partition [test,0] (state.change.logger)
[2017-12-08 09:03:31,673] TRACE Controller 0 epoch 39 changed partition [test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-08 09:03:31,673] TRACE Controller 0 epoch 39 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:11,ControllerEpoch:39) to broker 0 for partition [test1,0] (state.change.logger)
[2017-12-08 09:03:31,673] TRACE Controller 0 epoch 39 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:10,ControllerEpoch:39) to broker 0 for partition [test3,0] (state.change.logger)
[2017-12-08 09:03:31,673] TRACE Controller 0 epoch 39 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:33,ControllerEpoch:39) to broker 0 for partition [test,0] (state.change.logger)
[2017-12-08 09:03:31,673] TRACE Controller 0 epoch 39 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:26,ControllerEpoch:39) to broker 0 for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:03:31,673] TRACE Controller 0 epoch 39 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:39) to broker 0 for partition [log,0] (state.change.logger)
[2017-12-08 09:03:31,673] TRACE Controller 0 epoch 39 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:11,ControllerEpoch:39) to broker 0 for partition test1-0 (state.change.logger)
[2017-12-08 09:03:31,673] TRACE Controller 0 epoch 39 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:10,ControllerEpoch:39) to broker 0 for partition test3-0 (state.change.logger)
[2017-12-08 09:03:31,673] TRACE Controller 0 epoch 39 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:33,ControllerEpoch:39) to broker 0 for partition test-0 (state.change.logger)
[2017-12-08 09:03:31,673] TRACE Controller 0 epoch 39 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:26,ControllerEpoch:39) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-12-08 09:03:31,673] TRACE Controller 0 epoch 39 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:39) to broker 0 for partition log-0 (state.change.logger)
[2017-12-08 09:03:31,703] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 39 with correlation id 1 for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:03:31,703] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 39 with correlation id 1 for partition [test1,0] (state.change.logger)
[2017-12-08 09:03:31,703] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 39 with correlation id 1 for partition [log,0] (state.change.logger)
[2017-12-08 09:03:31,713] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 39 with correlation id 1 for partition [test,0] (state.change.logger)
[2017-12-08 09:03:31,713] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 39 with correlation id 1 for partition [test3,0] (state.change.logger)
[2017-12-08 09:03:31,713] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 39 for the become-leader transition for partition [test1,0] (state.change.logger)
[2017-12-08 09:03:31,713] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 39 for the become-leader transition for partition [test3,0] (state.change.logger)
[2017-12-08 09:03:31,713] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 39 for the become-leader transition for partition [test,0] (state.change.logger)
[2017-12-08 09:03:31,713] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 39 for the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:03:31,713] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 39 for the become-leader transition for partition [log,0] (state.change.logger)
[2017-12-08 09:03:31,723] TRACE Controller 0 epoch 39 received response {error_code=0,partitions=[{topic=test1,partition=0,error_code=0},{topic=test3,partition=0,error_code=0},{topic=json-topic,partition=0,error_code=0},{topic=test,partition=0,error_code=0},{topic=log,partition=0,error_code=0}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-08 09:03:31,723] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:38),ReplicationFactor:1),AllReplicas:0) for partition test3-0 in response to UpdateMetadata request sent by controller 0 epoch 39 with correlation id 2 (state.change.logger)
[2017-12-08 09:03:31,723] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:10,ControllerEpoch:38),ReplicationFactor:1),AllReplicas:0) for partition test1-0 in response to UpdateMetadata request sent by controller 0 epoch 39 with correlation id 2 (state.change.logger)
[2017-12-08 09:03:31,723] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:38),ReplicationFactor:1),AllReplicas:0) for partition log-0 in response to UpdateMetadata request sent by controller 0 epoch 39 with correlation id 2 (state.change.logger)
[2017-12-08 09:03:31,723] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:38),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 39 with correlation id 2 (state.change.logger)
[2017-12-08 09:03:31,723] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:25,ControllerEpoch:38),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 39 with correlation id 2 (state.change.logger)
[2017-12-08 09:03:31,723] TRACE Controller 0 epoch 39 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-08 09:03:31,723] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=39, leader=0, leaderEpoch=10, isr=[0], zkVersion=10, replicas=[0]) correlation id 3 from controller 0 epoch 39 for partition [test3,0] (state.change.logger)
[2017-12-08 09:03:31,723] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=39, leader=0, leaderEpoch=11, isr=[0], zkVersion=11, replicas=[0]) correlation id 3 from controller 0 epoch 39 for partition [test1,0] (state.change.logger)
[2017-12-08 09:03:31,723] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=39, leader=0, leaderEpoch=9, isr=[0], zkVersion=9, replicas=[0]) correlation id 3 from controller 0 epoch 39 for partition [log,0] (state.change.logger)
[2017-12-08 09:03:31,723] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=39, leader=0, leaderEpoch=33, isr=[0], zkVersion=33, replicas=[0]) correlation id 3 from controller 0 epoch 39 for partition [test,0] (state.change.logger)
[2017-12-08 09:03:31,723] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=39, leader=0, leaderEpoch=26, isr=[0], zkVersion=26, replicas=[0]) correlation id 3 from controller 0 epoch 39 for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:03:31,723] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 39 starting the become-leader transition for partition [test1,0] (state.change.logger)
[2017-12-08 09:03:31,723] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 39 starting the become-leader transition for partition [test3,0] (state.change.logger)
[2017-12-08 09:03:31,723] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 39 starting the become-leader transition for partition [test,0] (state.change.logger)
[2017-12-08 09:03:31,723] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 39 starting the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:03:31,723] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 39 starting the become-leader transition for partition [log,0] (state.change.logger)
[2017-12-08 09:03:31,723] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 39 for partition [test1,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-08 09:03:31,723] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 39 for partition [test3,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-08 09:03:31,723] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 39 for partition [test,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-08 09:03:31,723] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 39 for partition [json-topic,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-08 09:03:31,723] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 39 for partition [log,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-08 09:03:31,723] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 39 for the become-leader transition for partition [test1,0] (state.change.logger)
[2017-12-08 09:03:31,723] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 39 for the become-leader transition for partition [test3,0] (state.change.logger)
[2017-12-08 09:03:31,723] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 39 for the become-leader transition for partition [test,0] (state.change.logger)
[2017-12-08 09:03:31,723] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 39 for the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:03:31,723] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 39 for the become-leader transition for partition [log,0] (state.change.logger)
[2017-12-08 09:03:31,723] TRACE Controller 0 epoch 39 received response {error_code=0,partitions=[{topic=test1,partition=0,error_code=0},{topic=test3,partition=0,error_code=0},{topic=json-topic,partition=0,error_code=0},{topic=test,partition=0,error_code=0},{topic=log,partition=0,error_code=0}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-08 09:03:31,723] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:10,ControllerEpoch:39),ReplicationFactor:1),AllReplicas:0) for partition test3-0 in response to UpdateMetadata request sent by controller 0 epoch 39 with correlation id 4 (state.change.logger)
[2017-12-08 09:03:31,723] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:11,ControllerEpoch:39),ReplicationFactor:1),AllReplicas:0) for partition test1-0 in response to UpdateMetadata request sent by controller 0 epoch 39 with correlation id 4 (state.change.logger)
[2017-12-08 09:03:31,733] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:39),ReplicationFactor:1),AllReplicas:0) for partition log-0 in response to UpdateMetadata request sent by controller 0 epoch 39 with correlation id 4 (state.change.logger)
[2017-12-08 09:03:31,733] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:33,ControllerEpoch:39),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 39 with correlation id 4 (state.change.logger)
[2017-12-08 09:03:31,733] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:26,ControllerEpoch:39),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 39 with correlation id 4 (state.change.logger)
[2017-12-08 09:03:31,733] TRACE Controller 0 epoch 39 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-08 09:05:38,488] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2017-12-08 09:05:50,320] TRACE Controller 0 epoch 40 started leader election for partition [test1,0] (state.change.logger)
[2017-12-08 09:05:50,445] ERROR Controller 0 epoch 40 initiated state change for partition [test1,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test1,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-12-08 09:05:50,448] TRACE Controller 0 epoch 40 started leader election for partition [test3,0] (state.change.logger)
[2017-12-08 09:05:50,461] ERROR Controller 0 epoch 40 initiated state change for partition [test3,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test3,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-12-08 09:05:50,462] TRACE Controller 0 epoch 40 started leader election for partition [log,0] (state.change.logger)
[2017-12-08 09:05:50,469] ERROR Controller 0 epoch 40 initiated state change for partition [log,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [log,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-12-08 09:05:50,469] TRACE Controller 0 epoch 40 started leader election for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:05:50,474] ERROR Controller 0 epoch 40 initiated state change for partition [json-topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [json-topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-12-08 09:05:50,475] TRACE Controller 0 epoch 40 started leader election for partition [test,0] (state.change.logger)
[2017-12-08 09:05:50,481] ERROR Controller 0 epoch 40 initiated state change for partition [test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-12-08 09:05:50,859] TRACE Controller 0 epoch 40 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:11,ControllerEpoch:39) to broker 0 for partition test1-0 (state.change.logger)
[2017-12-08 09:05:50,859] TRACE Controller 0 epoch 40 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:10,ControllerEpoch:39) to broker 0 for partition test3-0 (state.change.logger)
[2017-12-08 09:05:50,859] TRACE Controller 0 epoch 40 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:33,ControllerEpoch:39) to broker 0 for partition test-0 (state.change.logger)
[2017-12-08 09:05:50,859] TRACE Controller 0 epoch 40 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:26,ControllerEpoch:39) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-12-08 09:05:50,859] TRACE Controller 0 epoch 40 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:39) to broker 0 for partition log-0 (state.change.logger)
[2017-12-08 09:05:50,879] TRACE Controller 0 epoch 40 changed state of replica 0 for partition [test3,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-08 09:05:50,879] TRACE Controller 0 epoch 40 changed state of replica 0 for partition [test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-08 09:05:50,879] TRACE Controller 0 epoch 40 changed state of replica 0 for partition [json-topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-08 09:05:50,879] TRACE Controller 0 epoch 40 changed state of replica 0 for partition [log,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-08 09:05:50,879] TRACE Controller 0 epoch 40 changed state of replica 0 for partition [test1,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-08 09:05:50,879] TRACE Controller 0 epoch 40 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:11,ControllerEpoch:39) to broker 0 for partition [test1,0] (state.change.logger)
[2017-12-08 09:05:50,879] TRACE Controller 0 epoch 40 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:10,ControllerEpoch:39) to broker 0 for partition [test3,0] (state.change.logger)
[2017-12-08 09:05:50,879] TRACE Controller 0 epoch 40 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:26,ControllerEpoch:39) to broker 0 for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:05:50,879] TRACE Controller 0 epoch 40 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:33,ControllerEpoch:39) to broker 0 for partition [test,0] (state.change.logger)
[2017-12-08 09:05:50,879] TRACE Controller 0 epoch 40 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:39) to broker 0 for partition [log,0] (state.change.logger)
[2017-12-08 09:05:50,889] TRACE Controller 0 epoch 40 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:11,ControllerEpoch:39) to broker 0 for partition test1-0 (state.change.logger)
[2017-12-08 09:05:50,889] TRACE Controller 0 epoch 40 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:10,ControllerEpoch:39) to broker 0 for partition test3-0 (state.change.logger)
[2017-12-08 09:05:50,889] TRACE Controller 0 epoch 40 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:26,ControllerEpoch:39) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-12-08 09:05:50,889] TRACE Controller 0 epoch 40 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:33,ControllerEpoch:39) to broker 0 for partition test-0 (state.change.logger)
[2017-12-08 09:05:50,889] TRACE Controller 0 epoch 40 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:39) to broker 0 for partition log-0 (state.change.logger)
[2017-12-08 09:05:50,889] TRACE Controller 0 epoch 40 started leader election for partition [test1,0] (state.change.logger)
[2017-12-08 09:05:50,911] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:10,ControllerEpoch:39),ReplicationFactor:1),AllReplicas:0) for partition test3-0 in response to UpdateMetadata request sent by controller 0 epoch 40 with correlation id 0 (state.change.logger)
[2017-12-08 09:05:50,911] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:11,ControllerEpoch:39),ReplicationFactor:1),AllReplicas:0) for partition test1-0 in response to UpdateMetadata request sent by controller 0 epoch 40 with correlation id 0 (state.change.logger)
[2017-12-08 09:05:50,911] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:39),ReplicationFactor:1),AllReplicas:0) for partition log-0 in response to UpdateMetadata request sent by controller 0 epoch 40 with correlation id 0 (state.change.logger)
[2017-12-08 09:05:50,912] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:33,ControllerEpoch:39),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 40 with correlation id 0 (state.change.logger)
[2017-12-08 09:05:50,912] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:26,ControllerEpoch:39),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 40 with correlation id 0 (state.change.logger)
[2017-12-08 09:05:50,926] TRACE Controller 0 epoch 40 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-08 09:05:50,938] TRACE Controller 0 epoch 40 elected leader 0 for Offline partition [test1,0] (state.change.logger)
[2017-12-08 09:05:50,940] TRACE Controller 0 epoch 40 changed partition [test1,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-08 09:05:50,940] TRACE Controller 0 epoch 40 started leader election for partition [test3,0] (state.change.logger)
[2017-12-08 09:05:50,965] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=39, leader=0, leaderEpoch=10, isr=[0], zkVersion=10, replicas=[0]) correlation id 1 from controller 0 epoch 40 for partition [test3,0] (state.change.logger)
[2017-12-08 09:05:50,965] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=39, leader=0, leaderEpoch=11, isr=[0], zkVersion=11, replicas=[0]) correlation id 1 from controller 0 epoch 40 for partition [test1,0] (state.change.logger)
[2017-12-08 09:05:50,966] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=39, leader=0, leaderEpoch=9, isr=[0], zkVersion=9, replicas=[0]) correlation id 1 from controller 0 epoch 40 for partition [log,0] (state.change.logger)
[2017-12-08 09:05:50,966] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=39, leader=0, leaderEpoch=33, isr=[0], zkVersion=33, replicas=[0]) correlation id 1 from controller 0 epoch 40 for partition [test,0] (state.change.logger)
[2017-12-08 09:05:50,966] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=39, leader=0, leaderEpoch=26, isr=[0], zkVersion=26, replicas=[0]) correlation id 1 from controller 0 epoch 40 for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:05:50,969] TRACE Controller 0 epoch 40 elected leader 0 for Offline partition [test3,0] (state.change.logger)
[2017-12-08 09:05:50,970] TRACE Controller 0 epoch 40 changed partition [test3,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-08 09:05:50,970] TRACE Controller 0 epoch 40 started leader election for partition [log,0] (state.change.logger)
[2017-12-08 09:05:50,982] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 40 starting the become-leader transition for partition [test1,0] (state.change.logger)
[2017-12-08 09:05:50,982] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 40 starting the become-leader transition for partition [test3,0] (state.change.logger)
[2017-12-08 09:05:50,982] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 40 starting the become-leader transition for partition [test,0] (state.change.logger)
[2017-12-08 09:05:50,982] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 40 starting the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:05:50,982] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 40 starting the become-leader transition for partition [log,0] (state.change.logger)
[2017-12-08 09:05:51,021] TRACE Controller 0 epoch 40 elected leader 0 for Offline partition [log,0] (state.change.logger)
[2017-12-08 09:05:51,031] TRACE Controller 0 epoch 40 changed partition [log,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-08 09:05:51,031] TRACE Controller 0 epoch 40 started leader election for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:05:51,044] TRACE Controller 0 epoch 40 elected leader 0 for Offline partition [json-topic,0] (state.change.logger)
[2017-12-08 09:05:51,044] TRACE Controller 0 epoch 40 changed partition [json-topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-08 09:05:51,045] TRACE Controller 0 epoch 40 started leader election for partition [test,0] (state.change.logger)
[2017-12-08 09:05:51,077] TRACE Controller 0 epoch 40 elected leader 0 for Offline partition [test,0] (state.change.logger)
[2017-12-08 09:05:51,077] TRACE Controller 0 epoch 40 changed partition [test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-08 09:05:51,087] TRACE Controller 0 epoch 40 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:12,ControllerEpoch:40) to broker 0 for partition [test1,0] (state.change.logger)
[2017-12-08 09:05:51,087] TRACE Controller 0 epoch 40 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:11,ControllerEpoch:40) to broker 0 for partition [test3,0] (state.change.logger)
[2017-12-08 09:05:51,087] TRACE Controller 0 epoch 40 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:34,ControllerEpoch:40) to broker 0 for partition [test,0] (state.change.logger)
[2017-12-08 09:05:51,087] TRACE Controller 0 epoch 40 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:27,ControllerEpoch:40) to broker 0 for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:05:51,087] TRACE Controller 0 epoch 40 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:10,ControllerEpoch:40) to broker 0 for partition [log,0] (state.change.logger)
[2017-12-08 09:05:51,087] TRACE Controller 0 epoch 40 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:12,ControllerEpoch:40) to broker 0 for partition test1-0 (state.change.logger)
[2017-12-08 09:05:51,087] TRACE Controller 0 epoch 40 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:11,ControllerEpoch:40) to broker 0 for partition test3-0 (state.change.logger)
[2017-12-08 09:05:51,097] TRACE Controller 0 epoch 40 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:34,ControllerEpoch:40) to broker 0 for partition test-0 (state.change.logger)
[2017-12-08 09:05:51,097] TRACE Controller 0 epoch 40 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:27,ControllerEpoch:40) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-12-08 09:05:51,097] TRACE Controller 0 epoch 40 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:10,ControllerEpoch:40) to broker 0 for partition log-0 (state.change.logger)
[2017-12-08 09:05:51,097] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 40 with correlation id 1 for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:05:51,097] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 40 with correlation id 1 for partition [test1,0] (state.change.logger)
[2017-12-08 09:05:51,097] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 40 with correlation id 1 for partition [log,0] (state.change.logger)
[2017-12-08 09:05:51,097] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 40 with correlation id 1 for partition [test,0] (state.change.logger)
[2017-12-08 09:05:51,097] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 40 with correlation id 1 for partition [test3,0] (state.change.logger)
[2017-12-08 09:05:51,097] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 40 for the become-leader transition for partition [test1,0] (state.change.logger)
[2017-12-08 09:05:51,097] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 40 for the become-leader transition for partition [test3,0] (state.change.logger)
[2017-12-08 09:05:51,097] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 40 for the become-leader transition for partition [test,0] (state.change.logger)
[2017-12-08 09:05:51,097] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 40 for the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:05:51,097] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 40 for the become-leader transition for partition [log,0] (state.change.logger)
[2017-12-08 09:05:51,117] TRACE Controller 0 epoch 40 received response {error_code=0,partitions=[{topic=test1,partition=0,error_code=0},{topic=test3,partition=0,error_code=0},{topic=json-topic,partition=0,error_code=0},{topic=test,partition=0,error_code=0},{topic=log,partition=0,error_code=0}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-08 09:05:51,117] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:10,ControllerEpoch:39),ReplicationFactor:1),AllReplicas:0) for partition test3-0 in response to UpdateMetadata request sent by controller 0 epoch 40 with correlation id 2 (state.change.logger)
[2017-12-08 09:05:51,117] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:11,ControllerEpoch:39),ReplicationFactor:1),AllReplicas:0) for partition test1-0 in response to UpdateMetadata request sent by controller 0 epoch 40 with correlation id 2 (state.change.logger)
[2017-12-08 09:05:51,117] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:39),ReplicationFactor:1),AllReplicas:0) for partition log-0 in response to UpdateMetadata request sent by controller 0 epoch 40 with correlation id 2 (state.change.logger)
[2017-12-08 09:05:51,117] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:33,ControllerEpoch:39),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 40 with correlation id 2 (state.change.logger)
[2017-12-08 09:05:51,117] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:26,ControllerEpoch:39),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 40 with correlation id 2 (state.change.logger)
[2017-12-08 09:05:51,117] TRACE Controller 0 epoch 40 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-08 09:05:51,117] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=40, leader=0, leaderEpoch=11, isr=[0], zkVersion=11, replicas=[0]) correlation id 3 from controller 0 epoch 40 for partition [test3,0] (state.change.logger)
[2017-12-08 09:05:51,117] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=40, leader=0, leaderEpoch=12, isr=[0], zkVersion=12, replicas=[0]) correlation id 3 from controller 0 epoch 40 for partition [test1,0] (state.change.logger)
[2017-12-08 09:05:51,117] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=40, leader=0, leaderEpoch=10, isr=[0], zkVersion=10, replicas=[0]) correlation id 3 from controller 0 epoch 40 for partition [log,0] (state.change.logger)
[2017-12-08 09:05:51,117] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=40, leader=0, leaderEpoch=34, isr=[0], zkVersion=34, replicas=[0]) correlation id 3 from controller 0 epoch 40 for partition [test,0] (state.change.logger)
[2017-12-08 09:05:51,117] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=40, leader=0, leaderEpoch=27, isr=[0], zkVersion=27, replicas=[0]) correlation id 3 from controller 0 epoch 40 for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:05:51,117] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 40 starting the become-leader transition for partition [test1,0] (state.change.logger)
[2017-12-08 09:05:51,117] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 40 starting the become-leader transition for partition [test3,0] (state.change.logger)
[2017-12-08 09:05:51,117] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 40 starting the become-leader transition for partition [test,0] (state.change.logger)
[2017-12-08 09:05:51,117] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 40 starting the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:05:51,117] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 40 starting the become-leader transition for partition [log,0] (state.change.logger)
[2017-12-08 09:05:51,117] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 40 for partition [test1,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-08 09:05:51,117] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 40 for partition [test3,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-08 09:05:51,117] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 40 for partition [test,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-08 09:05:51,117] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 40 for partition [json-topic,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-08 09:05:51,117] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 40 for partition [log,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-08 09:05:51,117] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 40 for the become-leader transition for partition [test1,0] (state.change.logger)
[2017-12-08 09:05:51,117] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 40 for the become-leader transition for partition [test3,0] (state.change.logger)
[2017-12-08 09:05:51,117] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 40 for the become-leader transition for partition [test,0] (state.change.logger)
[2017-12-08 09:05:51,117] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 40 for the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:05:51,117] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 40 for the become-leader transition for partition [log,0] (state.change.logger)
[2017-12-08 09:05:51,117] TRACE Controller 0 epoch 40 received response {error_code=0,partitions=[{topic=test1,partition=0,error_code=0},{topic=test3,partition=0,error_code=0},{topic=json-topic,partition=0,error_code=0},{topic=test,partition=0,error_code=0},{topic=log,partition=0,error_code=0}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-08 09:05:51,127] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:11,ControllerEpoch:40),ReplicationFactor:1),AllReplicas:0) for partition test3-0 in response to UpdateMetadata request sent by controller 0 epoch 40 with correlation id 4 (state.change.logger)
[2017-12-08 09:05:51,127] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:12,ControllerEpoch:40),ReplicationFactor:1),AllReplicas:0) for partition test1-0 in response to UpdateMetadata request sent by controller 0 epoch 40 with correlation id 4 (state.change.logger)
[2017-12-08 09:05:51,127] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:10,ControllerEpoch:40),ReplicationFactor:1),AllReplicas:0) for partition log-0 in response to UpdateMetadata request sent by controller 0 epoch 40 with correlation id 4 (state.change.logger)
[2017-12-08 09:05:51,127] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:34,ControllerEpoch:40),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 40 with correlation id 4 (state.change.logger)
[2017-12-08 09:05:51,127] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:27,ControllerEpoch:40),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 40 with correlation id 4 (state.change.logger)
[2017-12-08 09:05:51,127] TRACE Controller 0 epoch 40 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-08 09:07:49,894] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2017-12-08 09:08:06,476] TRACE Controller 0 epoch 41 started leader election for partition [test1,0] (state.change.logger)
[2017-12-08 09:08:06,492] ERROR Controller 0 epoch 41 initiated state change for partition [test1,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test1,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-12-08 09:08:06,500] TRACE Controller 0 epoch 41 started leader election for partition [test3,0] (state.change.logger)
[2017-12-08 09:08:06,515] ERROR Controller 0 epoch 41 initiated state change for partition [test3,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test3,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-12-08 09:08:06,516] TRACE Controller 0 epoch 41 started leader election for partition [log,0] (state.change.logger)
[2017-12-08 09:08:06,524] ERROR Controller 0 epoch 41 initiated state change for partition [log,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [log,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-12-08 09:08:06,525] TRACE Controller 0 epoch 41 started leader election for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:08:06,536] ERROR Controller 0 epoch 41 initiated state change for partition [json-topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [json-topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-12-08 09:08:06,536] TRACE Controller 0 epoch 41 started leader election for partition [test,0] (state.change.logger)
[2017-12-08 09:08:06,570] ERROR Controller 0 epoch 41 initiated state change for partition [test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-12-08 09:08:07,039] TRACE Controller 0 epoch 41 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:12,ControllerEpoch:40) to broker 0 for partition test1-0 (state.change.logger)
[2017-12-08 09:08:07,040] TRACE Controller 0 epoch 41 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:11,ControllerEpoch:40) to broker 0 for partition test3-0 (state.change.logger)
[2017-12-08 09:08:07,049] TRACE Controller 0 epoch 41 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:34,ControllerEpoch:40) to broker 0 for partition test-0 (state.change.logger)
[2017-12-08 09:08:07,049] TRACE Controller 0 epoch 41 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:27,ControllerEpoch:40) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-12-08 09:08:07,050] TRACE Controller 0 epoch 41 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:10,ControllerEpoch:40) to broker 0 for partition log-0 (state.change.logger)
[2017-12-08 09:08:07,086] TRACE Controller 0 epoch 41 changed state of replica 0 for partition [test3,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-08 09:08:07,087] TRACE Controller 0 epoch 41 changed state of replica 0 for partition [test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-08 09:08:07,088] TRACE Controller 0 epoch 41 changed state of replica 0 for partition [json-topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-08 09:08:07,088] TRACE Controller 0 epoch 41 changed state of replica 0 for partition [log,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-08 09:08:07,088] TRACE Controller 0 epoch 41 changed state of replica 0 for partition [test1,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-08 09:08:07,090] TRACE Controller 0 epoch 41 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:12,ControllerEpoch:40) to broker 0 for partition [test1,0] (state.change.logger)
[2017-12-08 09:08:07,090] TRACE Controller 0 epoch 41 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:11,ControllerEpoch:40) to broker 0 for partition [test3,0] (state.change.logger)
[2017-12-08 09:08:07,090] TRACE Controller 0 epoch 41 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:27,ControllerEpoch:40) to broker 0 for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:08:07,090] TRACE Controller 0 epoch 41 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:34,ControllerEpoch:40) to broker 0 for partition [test,0] (state.change.logger)
[2017-12-08 09:08:07,090] TRACE Controller 0 epoch 41 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:10,ControllerEpoch:40) to broker 0 for partition [log,0] (state.change.logger)
[2017-12-08 09:08:07,115] TRACE Controller 0 epoch 41 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:12,ControllerEpoch:40) to broker 0 for partition test1-0 (state.change.logger)
[2017-12-08 09:08:07,125] TRACE Controller 0 epoch 41 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:11,ControllerEpoch:40) to broker 0 for partition test3-0 (state.change.logger)
[2017-12-08 09:08:07,125] TRACE Controller 0 epoch 41 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:27,ControllerEpoch:40) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-12-08 09:08:07,125] TRACE Controller 0 epoch 41 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:34,ControllerEpoch:40) to broker 0 for partition test-0 (state.change.logger)
[2017-12-08 09:08:07,125] TRACE Controller 0 epoch 41 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:10,ControllerEpoch:40) to broker 0 for partition log-0 (state.change.logger)
[2017-12-08 09:08:07,125] TRACE Controller 0 epoch 41 started leader election for partition [test1,0] (state.change.logger)
[2017-12-08 09:08:07,186] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:11,ControllerEpoch:40),ReplicationFactor:1),AllReplicas:0) for partition test3-0 in response to UpdateMetadata request sent by controller 0 epoch 41 with correlation id 0 (state.change.logger)
[2017-12-08 09:08:07,186] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:12,ControllerEpoch:40),ReplicationFactor:1),AllReplicas:0) for partition test1-0 in response to UpdateMetadata request sent by controller 0 epoch 41 with correlation id 0 (state.change.logger)
[2017-12-08 09:08:07,186] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:10,ControllerEpoch:40),ReplicationFactor:1),AllReplicas:0) for partition log-0 in response to UpdateMetadata request sent by controller 0 epoch 41 with correlation id 0 (state.change.logger)
[2017-12-08 09:08:07,186] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:34,ControllerEpoch:40),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 41 with correlation id 0 (state.change.logger)
[2017-12-08 09:08:07,186] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:27,ControllerEpoch:40),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 41 with correlation id 0 (state.change.logger)
[2017-12-08 09:08:07,187] TRACE Controller 0 epoch 41 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-08 09:08:07,205] TRACE Controller 0 epoch 41 elected leader 0 for Offline partition [test1,0] (state.change.logger)
[2017-12-08 09:08:07,207] TRACE Controller 0 epoch 41 changed partition [test1,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-08 09:08:07,208] TRACE Controller 0 epoch 41 started leader election for partition [test3,0] (state.change.logger)
[2017-12-08 09:08:07,248] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=40, leader=0, leaderEpoch=11, isr=[0], zkVersion=11, replicas=[0]) correlation id 1 from controller 0 epoch 41 for partition [test3,0] (state.change.logger)
[2017-12-08 09:08:07,248] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=40, leader=0, leaderEpoch=12, isr=[0], zkVersion=12, replicas=[0]) correlation id 1 from controller 0 epoch 41 for partition [test1,0] (state.change.logger)
[2017-12-08 09:08:07,248] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=40, leader=0, leaderEpoch=10, isr=[0], zkVersion=10, replicas=[0]) correlation id 1 from controller 0 epoch 41 for partition [log,0] (state.change.logger)
[2017-12-08 09:08:07,248] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=40, leader=0, leaderEpoch=34, isr=[0], zkVersion=34, replicas=[0]) correlation id 1 from controller 0 epoch 41 for partition [test,0] (state.change.logger)
[2017-12-08 09:08:07,248] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=40, leader=0, leaderEpoch=27, isr=[0], zkVersion=27, replicas=[0]) correlation id 1 from controller 0 epoch 41 for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:08:07,249] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 41 starting the become-leader transition for partition [test1,0] (state.change.logger)
[2017-12-08 09:08:07,249] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 41 starting the become-leader transition for partition [test3,0] (state.change.logger)
[2017-12-08 09:08:07,249] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 41 starting the become-leader transition for partition [test,0] (state.change.logger)
[2017-12-08 09:08:07,249] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 41 starting the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:08:07,249] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 41 starting the become-leader transition for partition [log,0] (state.change.logger)
[2017-12-08 09:08:07,249] TRACE Controller 0 epoch 41 elected leader 0 for Offline partition [test3,0] (state.change.logger)
[2017-12-08 09:08:07,250] TRACE Controller 0 epoch 41 changed partition [test3,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-08 09:08:07,250] TRACE Controller 0 epoch 41 started leader election for partition [log,0] (state.change.logger)
[2017-12-08 09:08:07,342] TRACE Controller 0 epoch 41 elected leader 0 for Offline partition [log,0] (state.change.logger)
[2017-12-08 09:08:07,342] TRACE Controller 0 epoch 41 changed partition [log,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-08 09:08:07,342] TRACE Controller 0 epoch 41 started leader election for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:08:07,372] TRACE Controller 0 epoch 41 elected leader 0 for Offline partition [json-topic,0] (state.change.logger)
[2017-12-08 09:08:07,372] TRACE Controller 0 epoch 41 changed partition [json-topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-08 09:08:07,372] TRACE Controller 0 epoch 41 started leader election for partition [test,0] (state.change.logger)
[2017-12-08 09:08:07,392] TRACE Controller 0 epoch 41 elected leader 0 for Offline partition [test,0] (state.change.logger)
[2017-12-08 09:08:07,392] TRACE Controller 0 epoch 41 changed partition [test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-08 09:08:07,392] TRACE Controller 0 epoch 41 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:13,ControllerEpoch:41) to broker 0 for partition [test1,0] (state.change.logger)
[2017-12-08 09:08:07,392] TRACE Controller 0 epoch 41 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:12,ControllerEpoch:41) to broker 0 for partition [test3,0] (state.change.logger)
[2017-12-08 09:08:07,392] TRACE Controller 0 epoch 41 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:35,ControllerEpoch:41) to broker 0 for partition [test,0] (state.change.logger)
[2017-12-08 09:08:07,402] TRACE Controller 0 epoch 41 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:28,ControllerEpoch:41) to broker 0 for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:08:07,402] TRACE Controller 0 epoch 41 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:11,ControllerEpoch:41) to broker 0 for partition [log,0] (state.change.logger)
[2017-12-08 09:08:07,402] TRACE Controller 0 epoch 41 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:13,ControllerEpoch:41) to broker 0 for partition test1-0 (state.change.logger)
[2017-12-08 09:08:07,402] TRACE Controller 0 epoch 41 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:12,ControllerEpoch:41) to broker 0 for partition test3-0 (state.change.logger)
[2017-12-08 09:08:07,402] TRACE Controller 0 epoch 41 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:35,ControllerEpoch:41) to broker 0 for partition test-0 (state.change.logger)
[2017-12-08 09:08:07,402] TRACE Controller 0 epoch 41 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:28,ControllerEpoch:41) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-12-08 09:08:07,402] TRACE Controller 0 epoch 41 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:11,ControllerEpoch:41) to broker 0 for partition log-0 (state.change.logger)
[2017-12-08 09:08:07,402] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 41 with correlation id 1 for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:08:07,402] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 41 with correlation id 1 for partition [test1,0] (state.change.logger)
[2017-12-08 09:08:07,402] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 41 with correlation id 1 for partition [log,0] (state.change.logger)
[2017-12-08 09:08:07,402] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 41 with correlation id 1 for partition [test,0] (state.change.logger)
[2017-12-08 09:08:07,402] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 41 with correlation id 1 for partition [test3,0] (state.change.logger)
[2017-12-08 09:08:07,412] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 41 for the become-leader transition for partition [test1,0] (state.change.logger)
[2017-12-08 09:08:07,412] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 41 for the become-leader transition for partition [test3,0] (state.change.logger)
[2017-12-08 09:08:07,412] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 41 for the become-leader transition for partition [test,0] (state.change.logger)
[2017-12-08 09:08:07,412] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 41 for the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:08:07,412] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 41 for the become-leader transition for partition [log,0] (state.change.logger)
[2017-12-08 09:08:07,422] TRACE Controller 0 epoch 41 received response {error_code=0,partitions=[{topic=test1,partition=0,error_code=0},{topic=test3,partition=0,error_code=0},{topic=json-topic,partition=0,error_code=0},{topic=test,partition=0,error_code=0},{topic=log,partition=0,error_code=0}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-08 09:08:07,422] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:11,ControllerEpoch:40),ReplicationFactor:1),AllReplicas:0) for partition test3-0 in response to UpdateMetadata request sent by controller 0 epoch 41 with correlation id 2 (state.change.logger)
[2017-12-08 09:08:07,422] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:12,ControllerEpoch:40),ReplicationFactor:1),AllReplicas:0) for partition test1-0 in response to UpdateMetadata request sent by controller 0 epoch 41 with correlation id 2 (state.change.logger)
[2017-12-08 09:08:07,422] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:10,ControllerEpoch:40),ReplicationFactor:1),AllReplicas:0) for partition log-0 in response to UpdateMetadata request sent by controller 0 epoch 41 with correlation id 2 (state.change.logger)
[2017-12-08 09:08:07,422] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:34,ControllerEpoch:40),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 41 with correlation id 2 (state.change.logger)
[2017-12-08 09:08:07,422] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:27,ControllerEpoch:40),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 41 with correlation id 2 (state.change.logger)
[2017-12-08 09:08:07,422] TRACE Controller 0 epoch 41 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-08 09:08:07,422] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=41, leader=0, leaderEpoch=12, isr=[0], zkVersion=12, replicas=[0]) correlation id 3 from controller 0 epoch 41 for partition [test3,0] (state.change.logger)
[2017-12-08 09:08:07,422] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=41, leader=0, leaderEpoch=13, isr=[0], zkVersion=13, replicas=[0]) correlation id 3 from controller 0 epoch 41 for partition [test1,0] (state.change.logger)
[2017-12-08 09:08:07,432] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=41, leader=0, leaderEpoch=11, isr=[0], zkVersion=11, replicas=[0]) correlation id 3 from controller 0 epoch 41 for partition [log,0] (state.change.logger)
[2017-12-08 09:08:07,432] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=41, leader=0, leaderEpoch=35, isr=[0], zkVersion=35, replicas=[0]) correlation id 3 from controller 0 epoch 41 for partition [test,0] (state.change.logger)
[2017-12-08 09:08:07,432] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=41, leader=0, leaderEpoch=28, isr=[0], zkVersion=28, replicas=[0]) correlation id 3 from controller 0 epoch 41 for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:08:07,432] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 41 starting the become-leader transition for partition [test1,0] (state.change.logger)
[2017-12-08 09:08:07,432] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 41 starting the become-leader transition for partition [test3,0] (state.change.logger)
[2017-12-08 09:08:07,432] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 41 starting the become-leader transition for partition [test,0] (state.change.logger)
[2017-12-08 09:08:07,432] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 41 starting the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:08:07,432] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 41 starting the become-leader transition for partition [log,0] (state.change.logger)
[2017-12-08 09:08:07,432] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 41 for partition [test1,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-08 09:08:07,432] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 41 for partition [test3,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-08 09:08:07,432] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 41 for partition [test,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-08 09:08:07,432] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 41 for partition [json-topic,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-08 09:08:07,432] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 41 for partition [log,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-08 09:08:07,432] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 41 for the become-leader transition for partition [test1,0] (state.change.logger)
[2017-12-08 09:08:07,432] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 41 for the become-leader transition for partition [test3,0] (state.change.logger)
[2017-12-08 09:08:07,432] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 41 for the become-leader transition for partition [test,0] (state.change.logger)
[2017-12-08 09:08:07,432] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 41 for the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:08:07,432] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 41 for the become-leader transition for partition [log,0] (state.change.logger)
[2017-12-08 09:08:07,432] TRACE Controller 0 epoch 41 received response {error_code=0,partitions=[{topic=test1,partition=0,error_code=0},{topic=test3,partition=0,error_code=0},{topic=json-topic,partition=0,error_code=0},{topic=test,partition=0,error_code=0},{topic=log,partition=0,error_code=0}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-08 09:08:07,432] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:12,ControllerEpoch:41),ReplicationFactor:1),AllReplicas:0) for partition test3-0 in response to UpdateMetadata request sent by controller 0 epoch 41 with correlation id 4 (state.change.logger)
[2017-12-08 09:08:07,432] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:13,ControllerEpoch:41),ReplicationFactor:1),AllReplicas:0) for partition test1-0 in response to UpdateMetadata request sent by controller 0 epoch 41 with correlation id 4 (state.change.logger)
[2017-12-08 09:08:07,432] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:11,ControllerEpoch:41),ReplicationFactor:1),AllReplicas:0) for partition log-0 in response to UpdateMetadata request sent by controller 0 epoch 41 with correlation id 4 (state.change.logger)
[2017-12-08 09:08:07,432] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:35,ControllerEpoch:41),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 41 with correlation id 4 (state.change.logger)
[2017-12-08 09:08:07,432] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:28,ControllerEpoch:41),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 41 with correlation id 4 (state.change.logger)
[2017-12-08 09:08:07,432] TRACE Controller 0 epoch 41 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-08 09:12:18,600] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2017-12-08 09:15:11,379] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2017-12-08 09:15:30,639] TRACE Controller 0 epoch 42 started leader election for partition [test1,0] (state.change.logger)
[2017-12-08 09:15:30,650] ERROR Controller 0 epoch 42 initiated state change for partition [test1,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test1,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-12-08 09:15:30,656] TRACE Controller 0 epoch 42 started leader election for partition [test3,0] (state.change.logger)
[2017-12-08 09:15:30,669] ERROR Controller 0 epoch 42 initiated state change for partition [test3,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test3,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-12-08 09:15:30,670] TRACE Controller 0 epoch 42 started leader election for partition [log,0] (state.change.logger)
[2017-12-08 09:15:30,693] ERROR Controller 0 epoch 42 initiated state change for partition [log,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [log,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-12-08 09:15:30,693] TRACE Controller 0 epoch 42 started leader election for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:15:30,707] ERROR Controller 0 epoch 42 initiated state change for partition [json-topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [json-topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-12-08 09:15:30,707] TRACE Controller 0 epoch 42 started leader election for partition [test,0] (state.change.logger)
[2017-12-08 09:15:30,720] ERROR Controller 0 epoch 42 initiated state change for partition [test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-12-08 09:15:30,983] TRACE Controller 0 epoch 42 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:13,ControllerEpoch:41) to broker 0 for partition test1-0 (state.change.logger)
[2017-12-08 09:15:30,983] TRACE Controller 0 epoch 42 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:12,ControllerEpoch:41) to broker 0 for partition test3-0 (state.change.logger)
[2017-12-08 09:15:30,983] TRACE Controller 0 epoch 42 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:35,ControllerEpoch:41) to broker 0 for partition test-0 (state.change.logger)
[2017-12-08 09:15:30,983] TRACE Controller 0 epoch 42 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:28,ControllerEpoch:41) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-12-08 09:15:30,983] TRACE Controller 0 epoch 42 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:11,ControllerEpoch:41) to broker 0 for partition log-0 (state.change.logger)
[2017-12-08 09:15:31,011] TRACE Controller 0 epoch 42 changed state of replica 0 for partition [test3,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-08 09:15:31,014] TRACE Controller 0 epoch 42 changed state of replica 0 for partition [test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-08 09:15:31,014] TRACE Controller 0 epoch 42 changed state of replica 0 for partition [json-topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-08 09:15:31,016] TRACE Controller 0 epoch 42 changed state of replica 0 for partition [log,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-08 09:15:31,016] TRACE Controller 0 epoch 42 changed state of replica 0 for partition [test1,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-08 09:15:31,018] TRACE Controller 0 epoch 42 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:13,ControllerEpoch:41) to broker 0 for partition [test1,0] (state.change.logger)
[2017-12-08 09:15:31,018] TRACE Controller 0 epoch 42 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:12,ControllerEpoch:41) to broker 0 for partition [test3,0] (state.change.logger)
[2017-12-08 09:15:31,018] TRACE Controller 0 epoch 42 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:28,ControllerEpoch:41) to broker 0 for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:15:31,019] TRACE Controller 0 epoch 42 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:35,ControllerEpoch:41) to broker 0 for partition [test,0] (state.change.logger)
[2017-12-08 09:15:31,020] TRACE Controller 0 epoch 42 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:11,ControllerEpoch:41) to broker 0 for partition [log,0] (state.change.logger)
[2017-12-08 09:15:31,039] TRACE Controller 0 epoch 42 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:13,ControllerEpoch:41) to broker 0 for partition test1-0 (state.change.logger)
[2017-12-08 09:15:31,040] TRACE Controller 0 epoch 42 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:12,ControllerEpoch:41) to broker 0 for partition test3-0 (state.change.logger)
[2017-12-08 09:15:31,040] TRACE Controller 0 epoch 42 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:28,ControllerEpoch:41) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-12-08 09:15:31,040] TRACE Controller 0 epoch 42 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:35,ControllerEpoch:41) to broker 0 for partition test-0 (state.change.logger)
[2017-12-08 09:15:31,041] TRACE Controller 0 epoch 42 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:11,ControllerEpoch:41) to broker 0 for partition log-0 (state.change.logger)
[2017-12-08 09:15:31,046] TRACE Controller 0 epoch 42 started leader election for partition [test1,0] (state.change.logger)
[2017-12-08 09:15:31,082] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:12,ControllerEpoch:41),ReplicationFactor:1),AllReplicas:0) for partition test3-0 in response to UpdateMetadata request sent by controller 0 epoch 42 with correlation id 0 (state.change.logger)
[2017-12-08 09:15:31,082] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:13,ControllerEpoch:41),ReplicationFactor:1),AllReplicas:0) for partition test1-0 in response to UpdateMetadata request sent by controller 0 epoch 42 with correlation id 0 (state.change.logger)
[2017-12-08 09:15:31,082] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:11,ControllerEpoch:41),ReplicationFactor:1),AllReplicas:0) for partition log-0 in response to UpdateMetadata request sent by controller 0 epoch 42 with correlation id 0 (state.change.logger)
[2017-12-08 09:15:31,082] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:35,ControllerEpoch:41),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 42 with correlation id 0 (state.change.logger)
[2017-12-08 09:15:31,082] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:28,ControllerEpoch:41),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 42 with correlation id 0 (state.change.logger)
[2017-12-08 09:15:31,112] TRACE Controller 0 epoch 42 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-08 09:15:31,122] TRACE Controller 0 epoch 42 elected leader 0 for Offline partition [test1,0] (state.change.logger)
[2017-12-08 09:15:31,122] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=41, leader=0, leaderEpoch=12, isr=[0], zkVersion=12, replicas=[0]) correlation id 1 from controller 0 epoch 42 for partition [test3,0] (state.change.logger)
[2017-12-08 09:15:31,122] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=41, leader=0, leaderEpoch=13, isr=[0], zkVersion=13, replicas=[0]) correlation id 1 from controller 0 epoch 42 for partition [test1,0] (state.change.logger)
[2017-12-08 09:15:31,122] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=41, leader=0, leaderEpoch=11, isr=[0], zkVersion=11, replicas=[0]) correlation id 1 from controller 0 epoch 42 for partition [log,0] (state.change.logger)
[2017-12-08 09:15:31,122] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=41, leader=0, leaderEpoch=35, isr=[0], zkVersion=35, replicas=[0]) correlation id 1 from controller 0 epoch 42 for partition [test,0] (state.change.logger)
[2017-12-08 09:15:31,122] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=41, leader=0, leaderEpoch=28, isr=[0], zkVersion=28, replicas=[0]) correlation id 1 from controller 0 epoch 42 for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:15:31,132] TRACE Controller 0 epoch 42 changed partition [test1,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-08 09:15:31,132] TRACE Controller 0 epoch 42 started leader election for partition [test3,0] (state.change.logger)
[2017-12-08 09:15:31,142] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 42 starting the become-leader transition for partition [test1,0] (state.change.logger)
[2017-12-08 09:15:31,142] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 42 starting the become-leader transition for partition [test3,0] (state.change.logger)
[2017-12-08 09:15:31,142] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 42 starting the become-leader transition for partition [test,0] (state.change.logger)
[2017-12-08 09:15:31,142] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 42 starting the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:15:31,142] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 42 starting the become-leader transition for partition [log,0] (state.change.logger)
[2017-12-08 09:15:31,143] TRACE Controller 0 epoch 42 elected leader 0 for Offline partition [test3,0] (state.change.logger)
[2017-12-08 09:15:31,143] TRACE Controller 0 epoch 42 changed partition [test3,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-08 09:15:31,143] TRACE Controller 0 epoch 42 started leader election for partition [log,0] (state.change.logger)
[2017-12-08 09:15:31,204] TRACE Controller 0 epoch 42 elected leader 0 for Offline partition [log,0] (state.change.logger)
[2017-12-08 09:15:31,214] TRACE Controller 0 epoch 42 changed partition [log,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-08 09:15:31,214] TRACE Controller 0 epoch 42 started leader election for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:15:31,217] TRACE Controller 0 epoch 42 elected leader 0 for Offline partition [json-topic,0] (state.change.logger)
[2017-12-08 09:15:31,217] TRACE Controller 0 epoch 42 changed partition [json-topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-08 09:15:31,217] TRACE Controller 0 epoch 42 started leader election for partition [test,0] (state.change.logger)
[2017-12-08 09:15:31,224] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 42 with correlation id 1 for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:15:31,224] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 42 with correlation id 1 for partition [test1,0] (state.change.logger)
[2017-12-08 09:15:31,224] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 42 with correlation id 1 for partition [log,0] (state.change.logger)
[2017-12-08 09:15:31,224] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 42 with correlation id 1 for partition [test,0] (state.change.logger)
[2017-12-08 09:15:31,224] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 42 with correlation id 1 for partition [test3,0] (state.change.logger)
[2017-12-08 09:15:31,226] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 42 for the become-leader transition for partition [test1,0] (state.change.logger)
[2017-12-08 09:15:31,226] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 42 for the become-leader transition for partition [test3,0] (state.change.logger)
[2017-12-08 09:15:31,226] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 42 for the become-leader transition for partition [test,0] (state.change.logger)
[2017-12-08 09:15:31,226] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 42 for the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:15:31,226] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 42 for the become-leader transition for partition [log,0] (state.change.logger)
[2017-12-08 09:15:31,239] TRACE Controller 0 epoch 42 received response {error_code=0,partitions=[{topic=test1,partition=0,error_code=0},{topic=test3,partition=0,error_code=0},{topic=json-topic,partition=0,error_code=0},{topic=test,partition=0,error_code=0},{topic=log,partition=0,error_code=0}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-08 09:15:31,240] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:12,ControllerEpoch:41),ReplicationFactor:1),AllReplicas:0) for partition test3-0 in response to UpdateMetadata request sent by controller 0 epoch 42 with correlation id 2 (state.change.logger)
[2017-12-08 09:15:31,240] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:13,ControllerEpoch:41),ReplicationFactor:1),AllReplicas:0) for partition test1-0 in response to UpdateMetadata request sent by controller 0 epoch 42 with correlation id 2 (state.change.logger)
[2017-12-08 09:15:31,240] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:11,ControllerEpoch:41),ReplicationFactor:1),AllReplicas:0) for partition log-0 in response to UpdateMetadata request sent by controller 0 epoch 42 with correlation id 2 (state.change.logger)
[2017-12-08 09:15:31,240] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:35,ControllerEpoch:41),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 42 with correlation id 2 (state.change.logger)
[2017-12-08 09:15:31,241] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:28,ControllerEpoch:41),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 42 with correlation id 2 (state.change.logger)
[2017-12-08 09:15:31,241] TRACE Controller 0 epoch 42 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-08 09:15:31,245] TRACE Controller 0 epoch 42 elected leader 0 for Offline partition [test,0] (state.change.logger)
[2017-12-08 09:15:31,246] TRACE Controller 0 epoch 42 changed partition [test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-08 09:15:31,250] TRACE Controller 0 epoch 42 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:14,ControllerEpoch:42) to broker 0 for partition [test1,0] (state.change.logger)
[2017-12-08 09:15:31,251] TRACE Controller 0 epoch 42 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:13,ControllerEpoch:42) to broker 0 for partition [test3,0] (state.change.logger)
[2017-12-08 09:15:31,251] TRACE Controller 0 epoch 42 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:36,ControllerEpoch:42) to broker 0 for partition [test,0] (state.change.logger)
[2017-12-08 09:15:31,251] TRACE Controller 0 epoch 42 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:29,ControllerEpoch:42) to broker 0 for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:15:31,251] TRACE Controller 0 epoch 42 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:12,ControllerEpoch:42) to broker 0 for partition [log,0] (state.change.logger)
[2017-12-08 09:15:31,252] TRACE Controller 0 epoch 42 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:14,ControllerEpoch:42) to broker 0 for partition test1-0 (state.change.logger)
[2017-12-08 09:15:31,252] TRACE Controller 0 epoch 42 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:13,ControllerEpoch:42) to broker 0 for partition test3-0 (state.change.logger)
[2017-12-08 09:15:31,253] TRACE Controller 0 epoch 42 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:36,ControllerEpoch:42) to broker 0 for partition test-0 (state.change.logger)
[2017-12-08 09:15:31,253] TRACE Controller 0 epoch 42 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:29,ControllerEpoch:42) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-12-08 09:15:31,253] TRACE Controller 0 epoch 42 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:12,ControllerEpoch:42) to broker 0 for partition log-0 (state.change.logger)
[2017-12-08 09:15:31,254] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=42, leader=0, leaderEpoch=13, isr=[0], zkVersion=13, replicas=[0]) correlation id 3 from controller 0 epoch 42 for partition [test3,0] (state.change.logger)
[2017-12-08 09:15:31,254] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=42, leader=0, leaderEpoch=14, isr=[0], zkVersion=14, replicas=[0]) correlation id 3 from controller 0 epoch 42 for partition [test1,0] (state.change.logger)
[2017-12-08 09:15:31,254] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=42, leader=0, leaderEpoch=12, isr=[0], zkVersion=12, replicas=[0]) correlation id 3 from controller 0 epoch 42 for partition [log,0] (state.change.logger)
[2017-12-08 09:15:31,254] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=42, leader=0, leaderEpoch=36, isr=[0], zkVersion=36, replicas=[0]) correlation id 3 from controller 0 epoch 42 for partition [test,0] (state.change.logger)
[2017-12-08 09:15:31,254] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=42, leader=0, leaderEpoch=29, isr=[0], zkVersion=29, replicas=[0]) correlation id 3 from controller 0 epoch 42 for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:15:31,254] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 42 starting the become-leader transition for partition [test1,0] (state.change.logger)
[2017-12-08 09:15:31,254] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 42 starting the become-leader transition for partition [test3,0] (state.change.logger)
[2017-12-08 09:15:31,255] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 42 starting the become-leader transition for partition [test,0] (state.change.logger)
[2017-12-08 09:15:31,255] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 42 starting the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:15:31,255] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 42 starting the become-leader transition for partition [log,0] (state.change.logger)
[2017-12-08 09:15:31,256] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 42 for partition [test1,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-08 09:15:31,256] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 42 for partition [test3,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-08 09:15:31,257] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 42 for partition [test,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-08 09:15:31,257] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 42 for partition [json-topic,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-08 09:15:31,257] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 42 for partition [log,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-08 09:15:31,258] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 42 for the become-leader transition for partition [test1,0] (state.change.logger)
[2017-12-08 09:15:31,258] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 42 for the become-leader transition for partition [test3,0] (state.change.logger)
[2017-12-08 09:15:31,258] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 42 for the become-leader transition for partition [test,0] (state.change.logger)
[2017-12-08 09:15:31,258] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 42 for the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:15:31,258] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 42 for the become-leader transition for partition [log,0] (state.change.logger)
[2017-12-08 09:15:31,259] TRACE Controller 0 epoch 42 received response {error_code=0,partitions=[{topic=test1,partition=0,error_code=0},{topic=test3,partition=0,error_code=0},{topic=json-topic,partition=0,error_code=0},{topic=test,partition=0,error_code=0},{topic=log,partition=0,error_code=0}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-08 09:15:31,260] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:13,ControllerEpoch:42),ReplicationFactor:1),AllReplicas:0) for partition test3-0 in response to UpdateMetadata request sent by controller 0 epoch 42 with correlation id 4 (state.change.logger)
[2017-12-08 09:15:31,260] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:14,ControllerEpoch:42),ReplicationFactor:1),AllReplicas:0) for partition test1-0 in response to UpdateMetadata request sent by controller 0 epoch 42 with correlation id 4 (state.change.logger)
[2017-12-08 09:15:31,260] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:12,ControllerEpoch:42),ReplicationFactor:1),AllReplicas:0) for partition log-0 in response to UpdateMetadata request sent by controller 0 epoch 42 with correlation id 4 (state.change.logger)
[2017-12-08 09:15:31,260] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:36,ControllerEpoch:42),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 42 with correlation id 4 (state.change.logger)
[2017-12-08 09:15:31,260] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:29,ControllerEpoch:42),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 42 with correlation id 4 (state.change.logger)
[2017-12-08 09:15:31,261] TRACE Controller 0 epoch 42 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-08 09:18:25,743] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2017-12-08 09:18:35,407] TRACE Controller 0 epoch 43 started leader election for partition [test1,0] (state.change.logger)
[2017-12-08 09:18:35,426] ERROR Controller 0 epoch 43 initiated state change for partition [test1,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test1,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-12-08 09:18:35,431] TRACE Controller 0 epoch 43 started leader election for partition [test3,0] (state.change.logger)
[2017-12-08 09:18:35,445] ERROR Controller 0 epoch 43 initiated state change for partition [test3,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test3,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-12-08 09:18:35,445] TRACE Controller 0 epoch 43 started leader election for partition [log,0] (state.change.logger)
[2017-12-08 09:18:35,452] ERROR Controller 0 epoch 43 initiated state change for partition [log,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [log,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-12-08 09:18:35,453] TRACE Controller 0 epoch 43 started leader election for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:18:35,475] ERROR Controller 0 epoch 43 initiated state change for partition [json-topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [json-topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-12-08 09:18:35,475] TRACE Controller 0 epoch 43 started leader election for partition [test,0] (state.change.logger)
[2017-12-08 09:18:35,485] ERROR Controller 0 epoch 43 initiated state change for partition [test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-12-08 09:18:36,363] TRACE Controller 0 epoch 43 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:14,ControllerEpoch:42) to broker 0 for partition test1-0 (state.change.logger)
[2017-12-08 09:18:36,363] TRACE Controller 0 epoch 43 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:13,ControllerEpoch:42) to broker 0 for partition test3-0 (state.change.logger)
[2017-12-08 09:18:36,363] TRACE Controller 0 epoch 43 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:36,ControllerEpoch:42) to broker 0 for partition test-0 (state.change.logger)
[2017-12-08 09:18:36,363] TRACE Controller 0 epoch 43 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:29,ControllerEpoch:42) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-12-08 09:18:36,363] TRACE Controller 0 epoch 43 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:12,ControllerEpoch:42) to broker 0 for partition log-0 (state.change.logger)
[2017-12-08 09:18:36,383] TRACE Controller 0 epoch 43 changed state of replica 0 for partition [test3,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-08 09:18:36,383] TRACE Controller 0 epoch 43 changed state of replica 0 for partition [test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-08 09:18:36,383] TRACE Controller 0 epoch 43 changed state of replica 0 for partition [json-topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-08 09:18:36,383] TRACE Controller 0 epoch 43 changed state of replica 0 for partition [log,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-08 09:18:36,383] TRACE Controller 0 epoch 43 changed state of replica 0 for partition [test1,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-08 09:18:36,383] TRACE Controller 0 epoch 43 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:14,ControllerEpoch:42) to broker 0 for partition [test1,0] (state.change.logger)
[2017-12-08 09:18:36,383] TRACE Controller 0 epoch 43 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:13,ControllerEpoch:42) to broker 0 for partition [test3,0] (state.change.logger)
[2017-12-08 09:18:36,383] TRACE Controller 0 epoch 43 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:29,ControllerEpoch:42) to broker 0 for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:18:36,383] TRACE Controller 0 epoch 43 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:36,ControllerEpoch:42) to broker 0 for partition [test,0] (state.change.logger)
[2017-12-08 09:18:36,383] TRACE Controller 0 epoch 43 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:12,ControllerEpoch:42) to broker 0 for partition [log,0] (state.change.logger)
[2017-12-08 09:18:36,394] TRACE Controller 0 epoch 43 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:14,ControllerEpoch:42) to broker 0 for partition test1-0 (state.change.logger)
[2017-12-08 09:18:36,394] TRACE Controller 0 epoch 43 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:13,ControllerEpoch:42) to broker 0 for partition test3-0 (state.change.logger)
[2017-12-08 09:18:36,394] TRACE Controller 0 epoch 43 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:29,ControllerEpoch:42) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-12-08 09:18:36,394] TRACE Controller 0 epoch 43 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:36,ControllerEpoch:42) to broker 0 for partition test-0 (state.change.logger)
[2017-12-08 09:18:36,394] TRACE Controller 0 epoch 43 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:12,ControllerEpoch:42) to broker 0 for partition log-0 (state.change.logger)
[2017-12-08 09:18:36,394] TRACE Controller 0 epoch 43 started leader election for partition [test1,0] (state.change.logger)
[2017-12-08 09:18:36,423] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:13,ControllerEpoch:42),ReplicationFactor:1),AllReplicas:0) for partition test3-0 in response to UpdateMetadata request sent by controller 0 epoch 43 with correlation id 0 (state.change.logger)
[2017-12-08 09:18:36,423] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:14,ControllerEpoch:42),ReplicationFactor:1),AllReplicas:0) for partition test1-0 in response to UpdateMetadata request sent by controller 0 epoch 43 with correlation id 0 (state.change.logger)
[2017-12-08 09:18:36,423] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:12,ControllerEpoch:42),ReplicationFactor:1),AllReplicas:0) for partition log-0 in response to UpdateMetadata request sent by controller 0 epoch 43 with correlation id 0 (state.change.logger)
[2017-12-08 09:18:36,423] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:36,ControllerEpoch:42),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 43 with correlation id 0 (state.change.logger)
[2017-12-08 09:18:36,423] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:29,ControllerEpoch:42),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 43 with correlation id 0 (state.change.logger)
[2017-12-08 09:18:36,426] TRACE Controller 0 epoch 43 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-08 09:18:36,475] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=42, leader=0, leaderEpoch=13, isr=[0], zkVersion=13, replicas=[0]) correlation id 1 from controller 0 epoch 43 for partition [test3,0] (state.change.logger)
[2017-12-08 09:18:36,475] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=42, leader=0, leaderEpoch=14, isr=[0], zkVersion=14, replicas=[0]) correlation id 1 from controller 0 epoch 43 for partition [test1,0] (state.change.logger)
[2017-12-08 09:18:36,475] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=42, leader=0, leaderEpoch=12, isr=[0], zkVersion=12, replicas=[0]) correlation id 1 from controller 0 epoch 43 for partition [log,0] (state.change.logger)
[2017-12-08 09:18:36,475] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=42, leader=0, leaderEpoch=36, isr=[0], zkVersion=36, replicas=[0]) correlation id 1 from controller 0 epoch 43 for partition [test,0] (state.change.logger)
[2017-12-08 09:18:36,475] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=42, leader=0, leaderEpoch=29, isr=[0], zkVersion=29, replicas=[0]) correlation id 1 from controller 0 epoch 43 for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:18:36,485] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 43 starting the become-leader transition for partition [test1,0] (state.change.logger)
[2017-12-08 09:18:36,485] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 43 starting the become-leader transition for partition [test3,0] (state.change.logger)
[2017-12-08 09:18:36,485] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 43 starting the become-leader transition for partition [test,0] (state.change.logger)
[2017-12-08 09:18:36,485] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 43 starting the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:18:36,485] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 43 starting the become-leader transition for partition [log,0] (state.change.logger)
[2017-12-08 09:18:36,565] TRACE Controller 0 epoch 43 elected leader 0 for Offline partition [test1,0] (state.change.logger)
[2017-12-08 09:18:36,575] TRACE Controller 0 epoch 43 changed partition [test1,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-08 09:18:36,575] TRACE Controller 0 epoch 43 started leader election for partition [test3,0] (state.change.logger)
[2017-12-08 09:18:36,680] TRACE Controller 0 epoch 43 elected leader 0 for Offline partition [test3,0] (state.change.logger)
[2017-12-08 09:18:36,690] TRACE Controller 0 epoch 43 changed partition [test3,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-08 09:18:36,690] TRACE Controller 0 epoch 43 started leader election for partition [log,0] (state.change.logger)
[2017-12-08 09:18:36,815] TRACE Controller 0 epoch 43 elected leader 0 for Offline partition [log,0] (state.change.logger)
[2017-12-08 09:18:36,815] TRACE Controller 0 epoch 43 changed partition [log,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-08 09:18:36,815] TRACE Controller 0 epoch 43 started leader election for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:18:36,835] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 43 with correlation id 1 for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:18:36,835] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 43 with correlation id 1 for partition [test1,0] (state.change.logger)
[2017-12-08 09:18:36,835] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 43 with correlation id 1 for partition [log,0] (state.change.logger)
[2017-12-08 09:18:36,835] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 43 with correlation id 1 for partition [test,0] (state.change.logger)
[2017-12-08 09:18:36,835] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 43 with correlation id 1 for partition [test3,0] (state.change.logger)
[2017-12-08 09:18:36,835] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 43 for the become-leader transition for partition [test1,0] (state.change.logger)
[2017-12-08 09:18:36,835] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 43 for the become-leader transition for partition [test3,0] (state.change.logger)
[2017-12-08 09:18:36,835] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 43 for the become-leader transition for partition [test,0] (state.change.logger)
[2017-12-08 09:18:36,835] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 43 for the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:18:36,835] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 43 for the become-leader transition for partition [log,0] (state.change.logger)
[2017-12-08 09:18:36,835] TRACE Controller 0 epoch 43 received response {error_code=0,partitions=[{topic=test1,partition=0,error_code=0},{topic=test3,partition=0,error_code=0},{topic=json-topic,partition=0,error_code=0},{topic=test,partition=0,error_code=0},{topic=log,partition=0,error_code=0}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-08 09:18:36,835] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:13,ControllerEpoch:42),ReplicationFactor:1),AllReplicas:0) for partition test3-0 in response to UpdateMetadata request sent by controller 0 epoch 43 with correlation id 2 (state.change.logger)
[2017-12-08 09:18:36,835] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:14,ControllerEpoch:42),ReplicationFactor:1),AllReplicas:0) for partition test1-0 in response to UpdateMetadata request sent by controller 0 epoch 43 with correlation id 2 (state.change.logger)
[2017-12-08 09:18:36,835] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:12,ControllerEpoch:42),ReplicationFactor:1),AllReplicas:0) for partition log-0 in response to UpdateMetadata request sent by controller 0 epoch 43 with correlation id 2 (state.change.logger)
[2017-12-08 09:18:36,835] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:36,ControllerEpoch:42),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 43 with correlation id 2 (state.change.logger)
[2017-12-08 09:18:36,835] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:29,ControllerEpoch:42),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 43 with correlation id 2 (state.change.logger)
[2017-12-08 09:18:36,845] TRACE Controller 0 epoch 43 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-08 09:18:36,946] TRACE Controller 0 epoch 43 elected leader 0 for Offline partition [json-topic,0] (state.change.logger)
[2017-12-08 09:18:36,946] TRACE Controller 0 epoch 43 changed partition [json-topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-08 09:18:36,946] TRACE Controller 0 epoch 43 started leader election for partition [test,0] (state.change.logger)
[2017-12-08 09:18:36,986] TRACE Controller 0 epoch 43 elected leader 0 for Offline partition [test,0] (state.change.logger)
[2017-12-08 09:18:36,986] TRACE Controller 0 epoch 43 changed partition [test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-08 09:18:36,986] TRACE Controller 0 epoch 43 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:15,ControllerEpoch:43) to broker 0 for partition [test1,0] (state.change.logger)
[2017-12-08 09:18:36,986] TRACE Controller 0 epoch 43 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:14,ControllerEpoch:43) to broker 0 for partition [test3,0] (state.change.logger)
[2017-12-08 09:18:36,986] TRACE Controller 0 epoch 43 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:37,ControllerEpoch:43) to broker 0 for partition [test,0] (state.change.logger)
[2017-12-08 09:18:36,986] TRACE Controller 0 epoch 43 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:30,ControllerEpoch:43) to broker 0 for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:18:36,986] TRACE Controller 0 epoch 43 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:13,ControllerEpoch:43) to broker 0 for partition [log,0] (state.change.logger)
[2017-12-08 09:18:36,986] TRACE Controller 0 epoch 43 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:15,ControllerEpoch:43) to broker 0 for partition test1-0 (state.change.logger)
[2017-12-08 09:18:36,986] TRACE Controller 0 epoch 43 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:14,ControllerEpoch:43) to broker 0 for partition test3-0 (state.change.logger)
[2017-12-08 09:18:36,986] TRACE Controller 0 epoch 43 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:37,ControllerEpoch:43) to broker 0 for partition test-0 (state.change.logger)
[2017-12-08 09:18:36,986] TRACE Controller 0 epoch 43 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:30,ControllerEpoch:43) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-12-08 09:18:36,986] TRACE Controller 0 epoch 43 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:13,ControllerEpoch:43) to broker 0 for partition log-0 (state.change.logger)
[2017-12-08 09:18:37,006] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=43, leader=0, leaderEpoch=14, isr=[0], zkVersion=14, replicas=[0]) correlation id 3 from controller 0 epoch 43 for partition [test3,0] (state.change.logger)
[2017-12-08 09:18:37,006] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=43, leader=0, leaderEpoch=15, isr=[0], zkVersion=15, replicas=[0]) correlation id 3 from controller 0 epoch 43 for partition [test1,0] (state.change.logger)
[2017-12-08 09:18:37,006] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=43, leader=0, leaderEpoch=13, isr=[0], zkVersion=13, replicas=[0]) correlation id 3 from controller 0 epoch 43 for partition [log,0] (state.change.logger)
[2017-12-08 09:18:37,006] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=43, leader=0, leaderEpoch=37, isr=[0], zkVersion=37, replicas=[0]) correlation id 3 from controller 0 epoch 43 for partition [test,0] (state.change.logger)
[2017-12-08 09:18:37,006] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=43, leader=0, leaderEpoch=30, isr=[0], zkVersion=30, replicas=[0]) correlation id 3 from controller 0 epoch 43 for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:18:37,006] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 43 starting the become-leader transition for partition [test1,0] (state.change.logger)
[2017-12-08 09:18:37,026] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 43 starting the become-leader transition for partition [test3,0] (state.change.logger)
[2017-12-08 09:18:37,026] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 43 starting the become-leader transition for partition [test,0] (state.change.logger)
[2017-12-08 09:18:37,026] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 43 starting the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:18:37,026] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 43 starting the become-leader transition for partition [log,0] (state.change.logger)
[2017-12-08 09:18:37,036] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 43 for partition [test1,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-08 09:18:37,036] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 43 for partition [test3,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-08 09:18:37,036] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 43 for partition [test,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-08 09:18:37,036] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 43 for partition [json-topic,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-08 09:18:37,036] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 43 for partition [log,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-08 09:18:37,036] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 43 for the become-leader transition for partition [test1,0] (state.change.logger)
[2017-12-08 09:18:37,036] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 43 for the become-leader transition for partition [test3,0] (state.change.logger)
[2017-12-08 09:18:37,036] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 43 for the become-leader transition for partition [test,0] (state.change.logger)
[2017-12-08 09:18:37,036] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 43 for the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:18:37,036] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 43 for the become-leader transition for partition [log,0] (state.change.logger)
[2017-12-08 09:18:37,036] TRACE Controller 0 epoch 43 received response {error_code=0,partitions=[{topic=test1,partition=0,error_code=0},{topic=test3,partition=0,error_code=0},{topic=json-topic,partition=0,error_code=0},{topic=test,partition=0,error_code=0},{topic=log,partition=0,error_code=0}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-08 09:18:37,036] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:14,ControllerEpoch:43),ReplicationFactor:1),AllReplicas:0) for partition test3-0 in response to UpdateMetadata request sent by controller 0 epoch 43 with correlation id 4 (state.change.logger)
[2017-12-08 09:18:37,036] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:15,ControllerEpoch:43),ReplicationFactor:1),AllReplicas:0) for partition test1-0 in response to UpdateMetadata request sent by controller 0 epoch 43 with correlation id 4 (state.change.logger)
[2017-12-08 09:18:37,036] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:13,ControllerEpoch:43),ReplicationFactor:1),AllReplicas:0) for partition log-0 in response to UpdateMetadata request sent by controller 0 epoch 43 with correlation id 4 (state.change.logger)
[2017-12-08 09:18:37,036] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:37,ControllerEpoch:43),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 43 with correlation id 4 (state.change.logger)
[2017-12-08 09:18:37,036] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:30,ControllerEpoch:43),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 43 with correlation id 4 (state.change.logger)
[2017-12-08 09:18:37,036] TRACE Controller 0 epoch 43 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-08 09:21:49,591] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2017-12-08 09:22:46,004] TRACE Controller 0 epoch 44 started leader election for partition [test1,0] (state.change.logger)
[2017-12-08 09:22:46,024] ERROR Controller 0 epoch 44 initiated state change for partition [test1,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test1,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-12-08 09:22:46,032] TRACE Controller 0 epoch 44 started leader election for partition [test3,0] (state.change.logger)
[2017-12-08 09:22:46,065] ERROR Controller 0 epoch 44 initiated state change for partition [test3,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test3,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-12-08 09:22:46,066] TRACE Controller 0 epoch 44 started leader election for partition [log,0] (state.change.logger)
[2017-12-08 09:22:46,081] ERROR Controller 0 epoch 44 initiated state change for partition [log,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [log,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-12-08 09:22:46,082] TRACE Controller 0 epoch 44 started leader election for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:22:46,094] ERROR Controller 0 epoch 44 initiated state change for partition [json-topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [json-topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-12-08 09:22:46,095] TRACE Controller 0 epoch 44 started leader election for partition [test,0] (state.change.logger)
[2017-12-08 09:22:46,107] ERROR Controller 0 epoch 44 initiated state change for partition [test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-12-08 09:22:46,471] TRACE Controller 0 epoch 44 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:15,ControllerEpoch:43) to broker 0 for partition test1-0 (state.change.logger)
[2017-12-08 09:22:46,471] TRACE Controller 0 epoch 44 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:14,ControllerEpoch:43) to broker 0 for partition test3-0 (state.change.logger)
[2017-12-08 09:22:46,472] TRACE Controller 0 epoch 44 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:37,ControllerEpoch:43) to broker 0 for partition test-0 (state.change.logger)
[2017-12-08 09:22:46,472] TRACE Controller 0 epoch 44 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:30,ControllerEpoch:43) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-12-08 09:22:46,472] TRACE Controller 0 epoch 44 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:13,ControllerEpoch:43) to broker 0 for partition log-0 (state.change.logger)
[2017-12-08 09:22:46,515] TRACE Controller 0 epoch 44 changed state of replica 0 for partition [test3,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-08 09:22:46,525] TRACE Controller 0 epoch 44 changed state of replica 0 for partition [test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-08 09:22:46,525] TRACE Controller 0 epoch 44 changed state of replica 0 for partition [json-topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-08 09:22:46,525] TRACE Controller 0 epoch 44 changed state of replica 0 for partition [log,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-08 09:22:46,535] TRACE Controller 0 epoch 44 changed state of replica 0 for partition [test1,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-08 09:22:46,535] TRACE Controller 0 epoch 44 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:15,ControllerEpoch:43) to broker 0 for partition [test1,0] (state.change.logger)
[2017-12-08 09:22:46,535] TRACE Controller 0 epoch 44 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:14,ControllerEpoch:43) to broker 0 for partition [test3,0] (state.change.logger)
[2017-12-08 09:22:46,535] TRACE Controller 0 epoch 44 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:30,ControllerEpoch:43) to broker 0 for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:22:46,535] TRACE Controller 0 epoch 44 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:37,ControllerEpoch:43) to broker 0 for partition [test,0] (state.change.logger)
[2017-12-08 09:22:46,535] TRACE Controller 0 epoch 44 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:13,ControllerEpoch:43) to broker 0 for partition [log,0] (state.change.logger)
[2017-12-08 09:22:46,535] TRACE Controller 0 epoch 44 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:15,ControllerEpoch:43) to broker 0 for partition test1-0 (state.change.logger)
[2017-12-08 09:22:46,535] TRACE Controller 0 epoch 44 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:14,ControllerEpoch:43) to broker 0 for partition test3-0 (state.change.logger)
[2017-12-08 09:22:46,535] TRACE Controller 0 epoch 44 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:30,ControllerEpoch:43) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-12-08 09:22:46,535] TRACE Controller 0 epoch 44 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:37,ControllerEpoch:43) to broker 0 for partition test-0 (state.change.logger)
[2017-12-08 09:22:46,535] TRACE Controller 0 epoch 44 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:13,ControllerEpoch:43) to broker 0 for partition log-0 (state.change.logger)
[2017-12-08 09:22:46,535] TRACE Controller 0 epoch 44 started leader election for partition [test1,0] (state.change.logger)
[2017-12-08 09:22:46,567] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:14,ControllerEpoch:43),ReplicationFactor:1),AllReplicas:0) for partition test3-0 in response to UpdateMetadata request sent by controller 0 epoch 44 with correlation id 0 (state.change.logger)
[2017-12-08 09:22:46,568] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:15,ControllerEpoch:43),ReplicationFactor:1),AllReplicas:0) for partition test1-0 in response to UpdateMetadata request sent by controller 0 epoch 44 with correlation id 0 (state.change.logger)
[2017-12-08 09:22:46,568] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:13,ControllerEpoch:43),ReplicationFactor:1),AllReplicas:0) for partition log-0 in response to UpdateMetadata request sent by controller 0 epoch 44 with correlation id 0 (state.change.logger)
[2017-12-08 09:22:46,568] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:37,ControllerEpoch:43),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 44 with correlation id 0 (state.change.logger)
[2017-12-08 09:22:46,568] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:30,ControllerEpoch:43),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 44 with correlation id 0 (state.change.logger)
[2017-12-08 09:22:46,581] TRACE Controller 0 epoch 44 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-08 09:22:46,583] TRACE Controller 0 epoch 44 elected leader 0 for Offline partition [test1,0] (state.change.logger)
[2017-12-08 09:22:46,589] TRACE Controller 0 epoch 44 changed partition [test1,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-08 09:22:46,589] TRACE Controller 0 epoch 44 started leader election for partition [test3,0] (state.change.logger)
[2017-12-08 09:22:46,621] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=43, leader=0, leaderEpoch=14, isr=[0], zkVersion=14, replicas=[0]) correlation id 1 from controller 0 epoch 44 for partition [test3,0] (state.change.logger)
[2017-12-08 09:22:46,622] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=43, leader=0, leaderEpoch=15, isr=[0], zkVersion=15, replicas=[0]) correlation id 1 from controller 0 epoch 44 for partition [test1,0] (state.change.logger)
[2017-12-08 09:22:46,622] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=43, leader=0, leaderEpoch=13, isr=[0], zkVersion=13, replicas=[0]) correlation id 1 from controller 0 epoch 44 for partition [log,0] (state.change.logger)
[2017-12-08 09:22:46,622] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=43, leader=0, leaderEpoch=37, isr=[0], zkVersion=37, replicas=[0]) correlation id 1 from controller 0 epoch 44 for partition [test,0] (state.change.logger)
[2017-12-08 09:22:46,622] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=43, leader=0, leaderEpoch=30, isr=[0], zkVersion=30, replicas=[0]) correlation id 1 from controller 0 epoch 44 for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:22:46,647] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 44 starting the become-leader transition for partition [test1,0] (state.change.logger)
[2017-12-08 09:22:46,647] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 44 starting the become-leader transition for partition [test3,0] (state.change.logger)
[2017-12-08 09:22:46,647] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 44 starting the become-leader transition for partition [test,0] (state.change.logger)
[2017-12-08 09:22:46,647] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 44 starting the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:22:46,647] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 44 starting the become-leader transition for partition [log,0] (state.change.logger)
[2017-12-08 09:22:46,647] TRACE Controller 0 epoch 44 elected leader 0 for Offline partition [test3,0] (state.change.logger)
[2017-12-08 09:22:46,647] TRACE Controller 0 epoch 44 changed partition [test3,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-08 09:22:46,647] TRACE Controller 0 epoch 44 started leader election for partition [log,0] (state.change.logger)
[2017-12-08 09:22:46,677] TRACE Controller 0 epoch 44 elected leader 0 for Offline partition [log,0] (state.change.logger)
[2017-12-08 09:22:46,677] TRACE Controller 0 epoch 44 changed partition [log,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-08 09:22:46,677] TRACE Controller 0 epoch 44 started leader election for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:22:46,687] TRACE Controller 0 epoch 44 elected leader 0 for Offline partition [json-topic,0] (state.change.logger)
[2017-12-08 09:22:46,688] TRACE Controller 0 epoch 44 changed partition [json-topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-08 09:22:46,688] TRACE Controller 0 epoch 44 started leader election for partition [test,0] (state.change.logger)
[2017-12-08 09:22:46,724] TRACE Controller 0 epoch 44 elected leader 0 for Offline partition [test,0] (state.change.logger)
[2017-12-08 09:22:46,725] TRACE Controller 0 epoch 44 changed partition [test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-08 09:22:46,725] TRACE Controller 0 epoch 44 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:16,ControllerEpoch:44) to broker 0 for partition [test1,0] (state.change.logger)
[2017-12-08 09:22:46,726] TRACE Controller 0 epoch 44 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:15,ControllerEpoch:44) to broker 0 for partition [test3,0] (state.change.logger)
[2017-12-08 09:22:46,726] TRACE Controller 0 epoch 44 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:38,ControllerEpoch:44) to broker 0 for partition [test,0] (state.change.logger)
[2017-12-08 09:22:46,726] TRACE Controller 0 epoch 44 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:31,ControllerEpoch:44) to broker 0 for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:22:46,726] TRACE Controller 0 epoch 44 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:14,ControllerEpoch:44) to broker 0 for partition [log,0] (state.change.logger)
[2017-12-08 09:22:46,727] TRACE Controller 0 epoch 44 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:16,ControllerEpoch:44) to broker 0 for partition test1-0 (state.change.logger)
[2017-12-08 09:22:46,727] TRACE Controller 0 epoch 44 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:15,ControllerEpoch:44) to broker 0 for partition test3-0 (state.change.logger)
[2017-12-08 09:22:46,727] TRACE Controller 0 epoch 44 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:38,ControllerEpoch:44) to broker 0 for partition test-0 (state.change.logger)
[2017-12-08 09:22:46,727] TRACE Controller 0 epoch 44 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:31,ControllerEpoch:44) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-12-08 09:22:46,727] TRACE Controller 0 epoch 44 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:14,ControllerEpoch:44) to broker 0 for partition log-0 (state.change.logger)
[2017-12-08 09:22:46,749] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 44 with correlation id 1 for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:22:46,749] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 44 with correlation id 1 for partition [test1,0] (state.change.logger)
[2017-12-08 09:22:46,749] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 44 with correlation id 1 for partition [log,0] (state.change.logger)
[2017-12-08 09:22:46,749] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 44 with correlation id 1 for partition [test,0] (state.change.logger)
[2017-12-08 09:22:46,749] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 44 with correlation id 1 for partition [test3,0] (state.change.logger)
[2017-12-08 09:22:46,749] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 44 for the become-leader transition for partition [test1,0] (state.change.logger)
[2017-12-08 09:22:46,749] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 44 for the become-leader transition for partition [test3,0] (state.change.logger)
[2017-12-08 09:22:46,749] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 44 for the become-leader transition for partition [test,0] (state.change.logger)
[2017-12-08 09:22:46,749] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 44 for the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:22:46,749] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 44 for the become-leader transition for partition [log,0] (state.change.logger)
[2017-12-08 09:22:46,759] TRACE Controller 0 epoch 44 received response {error_code=0,partitions=[{topic=test1,partition=0,error_code=0},{topic=test3,partition=0,error_code=0},{topic=json-topic,partition=0,error_code=0},{topic=test,partition=0,error_code=0},{topic=log,partition=0,error_code=0}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-08 09:22:46,769] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:14,ControllerEpoch:43),ReplicationFactor:1),AllReplicas:0) for partition test3-0 in response to UpdateMetadata request sent by controller 0 epoch 44 with correlation id 2 (state.change.logger)
[2017-12-08 09:22:46,769] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:15,ControllerEpoch:43),ReplicationFactor:1),AllReplicas:0) for partition test1-0 in response to UpdateMetadata request sent by controller 0 epoch 44 with correlation id 2 (state.change.logger)
[2017-12-08 09:22:46,769] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:13,ControllerEpoch:43),ReplicationFactor:1),AllReplicas:0) for partition log-0 in response to UpdateMetadata request sent by controller 0 epoch 44 with correlation id 2 (state.change.logger)
[2017-12-08 09:22:46,769] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:37,ControllerEpoch:43),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 44 with correlation id 2 (state.change.logger)
[2017-12-08 09:22:46,769] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:30,ControllerEpoch:43),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 44 with correlation id 2 (state.change.logger)
[2017-12-08 09:22:46,769] TRACE Controller 0 epoch 44 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-08 09:22:46,769] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=44, leader=0, leaderEpoch=15, isr=[0], zkVersion=15, replicas=[0]) correlation id 3 from controller 0 epoch 44 for partition [test3,0] (state.change.logger)
[2017-12-08 09:22:46,769] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=44, leader=0, leaderEpoch=16, isr=[0], zkVersion=16, replicas=[0]) correlation id 3 from controller 0 epoch 44 for partition [test1,0] (state.change.logger)
[2017-12-08 09:22:46,769] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=44, leader=0, leaderEpoch=14, isr=[0], zkVersion=14, replicas=[0]) correlation id 3 from controller 0 epoch 44 for partition [log,0] (state.change.logger)
[2017-12-08 09:22:46,769] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=44, leader=0, leaderEpoch=38, isr=[0], zkVersion=38, replicas=[0]) correlation id 3 from controller 0 epoch 44 for partition [test,0] (state.change.logger)
[2017-12-08 09:22:46,769] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=44, leader=0, leaderEpoch=31, isr=[0], zkVersion=31, replicas=[0]) correlation id 3 from controller 0 epoch 44 for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:22:46,769] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 44 starting the become-leader transition for partition [test1,0] (state.change.logger)
[2017-12-08 09:22:46,769] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 44 starting the become-leader transition for partition [test3,0] (state.change.logger)
[2017-12-08 09:22:46,769] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 44 starting the become-leader transition for partition [test,0] (state.change.logger)
[2017-12-08 09:22:46,769] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 44 starting the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:22:46,769] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 44 starting the become-leader transition for partition [log,0] (state.change.logger)
[2017-12-08 09:22:46,770] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 44 for partition [test1,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-08 09:22:46,770] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 44 for partition [test3,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-08 09:22:46,770] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 44 for partition [test,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-08 09:22:46,770] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 44 for partition [json-topic,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-08 09:22:46,770] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 44 for partition [log,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-08 09:22:46,770] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 44 for the become-leader transition for partition [test1,0] (state.change.logger)
[2017-12-08 09:22:46,770] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 44 for the become-leader transition for partition [test3,0] (state.change.logger)
[2017-12-08 09:22:46,770] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 44 for the become-leader transition for partition [test,0] (state.change.logger)
[2017-12-08 09:22:46,770] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 44 for the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-12-08 09:22:46,770] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 44 for the become-leader transition for partition [log,0] (state.change.logger)
[2017-12-08 09:22:46,770] TRACE Controller 0 epoch 44 received response {error_code=0,partitions=[{topic=test1,partition=0,error_code=0},{topic=test3,partition=0,error_code=0},{topic=json-topic,partition=0,error_code=0},{topic=test,partition=0,error_code=0},{topic=log,partition=0,error_code=0}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-08 09:22:46,770] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:15,ControllerEpoch:44),ReplicationFactor:1),AllReplicas:0) for partition test3-0 in response to UpdateMetadata request sent by controller 0 epoch 44 with correlation id 4 (state.change.logger)
[2017-12-08 09:22:46,770] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:16,ControllerEpoch:44),ReplicationFactor:1),AllReplicas:0) for partition test1-0 in response to UpdateMetadata request sent by controller 0 epoch 44 with correlation id 4 (state.change.logger)
[2017-12-08 09:22:46,770] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:14,ControllerEpoch:44),ReplicationFactor:1),AllReplicas:0) for partition log-0 in response to UpdateMetadata request sent by controller 0 epoch 44 with correlation id 4 (state.change.logger)
[2017-12-08 09:22:46,770] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:38,ControllerEpoch:44),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 44 with correlation id 4 (state.change.logger)
[2017-12-08 09:22:46,770] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:31,ControllerEpoch:44),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 44 with correlation id 4 (state.change.logger)
[2017-12-08 09:22:46,777] TRACE Controller 0 epoch 44 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-08 10:07:07,846] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2017-12-08 10:07:18,942] TRACE Controller 0 epoch 45 started leader election for partition [test1,0] (state.change.logger)
[2017-12-08 10:07:18,958] ERROR Controller 0 epoch 45 initiated state change for partition [test1,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test1,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-12-08 10:07:18,993] TRACE Controller 0 epoch 45 started leader election for partition [test3,0] (state.change.logger)
[2017-12-08 10:07:19,008] ERROR Controller 0 epoch 45 initiated state change for partition [test3,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test3,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-12-08 10:07:19,010] TRACE Controller 0 epoch 45 started leader election for partition [log,0] (state.change.logger)
[2017-12-08 10:07:19,018] ERROR Controller 0 epoch 45 initiated state change for partition [log,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [log,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-12-08 10:07:19,024] TRACE Controller 0 epoch 45 started leader election for partition [json-topic,0] (state.change.logger)
[2017-12-08 10:07:19,047] ERROR Controller 0 epoch 45 initiated state change for partition [json-topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [json-topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-12-08 10:07:19,048] TRACE Controller 0 epoch 45 started leader election for partition [test,0] (state.change.logger)
[2017-12-08 10:07:19,062] ERROR Controller 0 epoch 45 initiated state change for partition [test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-12-08 10:07:19,554] TRACE Controller 0 epoch 45 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:16,ControllerEpoch:44) to broker 0 for partition test1-0 (state.change.logger)
[2017-12-08 10:07:19,554] TRACE Controller 0 epoch 45 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:15,ControllerEpoch:44) to broker 0 for partition test3-0 (state.change.logger)
[2017-12-08 10:07:19,554] TRACE Controller 0 epoch 45 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:38,ControllerEpoch:44) to broker 0 for partition test-0 (state.change.logger)
[2017-12-08 10:07:19,554] TRACE Controller 0 epoch 45 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:31,ControllerEpoch:44) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-12-08 10:07:19,554] TRACE Controller 0 epoch 45 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:14,ControllerEpoch:44) to broker 0 for partition log-0 (state.change.logger)
[2017-12-08 10:07:19,565] TRACE Controller 0 epoch 45 changed state of replica 0 for partition [test3,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-08 10:07:19,565] TRACE Controller 0 epoch 45 changed state of replica 0 for partition [test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-08 10:07:19,565] TRACE Controller 0 epoch 45 changed state of replica 0 for partition [json-topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-08 10:07:19,565] TRACE Controller 0 epoch 45 changed state of replica 0 for partition [log,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-08 10:07:19,565] TRACE Controller 0 epoch 45 changed state of replica 0 for partition [test1,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-08 10:07:19,565] TRACE Controller 0 epoch 45 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:16,ControllerEpoch:44) to broker 0 for partition [test1,0] (state.change.logger)
[2017-12-08 10:07:19,565] TRACE Controller 0 epoch 45 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:15,ControllerEpoch:44) to broker 0 for partition [test3,0] (state.change.logger)
[2017-12-08 10:07:19,565] TRACE Controller 0 epoch 45 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:31,ControllerEpoch:44) to broker 0 for partition [json-topic,0] (state.change.logger)
[2017-12-08 10:07:19,565] TRACE Controller 0 epoch 45 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:38,ControllerEpoch:44) to broker 0 for partition [test,0] (state.change.logger)
[2017-12-08 10:07:19,565] TRACE Controller 0 epoch 45 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:14,ControllerEpoch:44) to broker 0 for partition [log,0] (state.change.logger)
[2017-12-08 10:07:19,568] TRACE Controller 0 epoch 45 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:16,ControllerEpoch:44) to broker 0 for partition test1-0 (state.change.logger)
[2017-12-08 10:07:19,568] TRACE Controller 0 epoch 45 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:15,ControllerEpoch:44) to broker 0 for partition test3-0 (state.change.logger)
[2017-12-08 10:07:19,568] TRACE Controller 0 epoch 45 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:31,ControllerEpoch:44) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-12-08 10:07:19,568] TRACE Controller 0 epoch 45 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:38,ControllerEpoch:44) to broker 0 for partition test-0 (state.change.logger)
[2017-12-08 10:07:19,569] TRACE Controller 0 epoch 45 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:14,ControllerEpoch:44) to broker 0 for partition log-0 (state.change.logger)
[2017-12-08 10:07:19,570] TRACE Controller 0 epoch 45 started leader election for partition [test1,0] (state.change.logger)
[2017-12-08 10:07:19,615] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:15,ControllerEpoch:44),ReplicationFactor:1),AllReplicas:0) for partition test3-0 in response to UpdateMetadata request sent by controller 0 epoch 45 with correlation id 0 (state.change.logger)
[2017-12-08 10:07:19,615] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:16,ControllerEpoch:44),ReplicationFactor:1),AllReplicas:0) for partition test1-0 in response to UpdateMetadata request sent by controller 0 epoch 45 with correlation id 0 (state.change.logger)
[2017-12-08 10:07:19,616] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:14,ControllerEpoch:44),ReplicationFactor:1),AllReplicas:0) for partition log-0 in response to UpdateMetadata request sent by controller 0 epoch 45 with correlation id 0 (state.change.logger)
[2017-12-08 10:07:19,616] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:38,ControllerEpoch:44),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 45 with correlation id 0 (state.change.logger)
[2017-12-08 10:07:19,616] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:31,ControllerEpoch:44),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 45 with correlation id 0 (state.change.logger)
[2017-12-08 10:07:19,626] TRACE Controller 0 epoch 45 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-08 10:07:19,630] TRACE Controller 0 epoch 45 elected leader 0 for Offline partition [test1,0] (state.change.logger)
[2017-12-08 10:07:19,631] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=44, leader=0, leaderEpoch=15, isr=[0], zkVersion=15, replicas=[0]) correlation id 1 from controller 0 epoch 45 for partition [test3,0] (state.change.logger)
[2017-12-08 10:07:19,631] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=44, leader=0, leaderEpoch=16, isr=[0], zkVersion=16, replicas=[0]) correlation id 1 from controller 0 epoch 45 for partition [test1,0] (state.change.logger)
[2017-12-08 10:07:19,631] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=44, leader=0, leaderEpoch=14, isr=[0], zkVersion=14, replicas=[0]) correlation id 1 from controller 0 epoch 45 for partition [log,0] (state.change.logger)
[2017-12-08 10:07:19,631] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=44, leader=0, leaderEpoch=38, isr=[0], zkVersion=38, replicas=[0]) correlation id 1 from controller 0 epoch 45 for partition [test,0] (state.change.logger)
[2017-12-08 10:07:19,631] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=44, leader=0, leaderEpoch=31, isr=[0], zkVersion=31, replicas=[0]) correlation id 1 from controller 0 epoch 45 for partition [json-topic,0] (state.change.logger)
[2017-12-08 10:07:19,633] TRACE Controller 0 epoch 45 changed partition [test1,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-08 10:07:19,633] TRACE Controller 0 epoch 45 started leader election for partition [test3,0] (state.change.logger)
[2017-12-08 10:07:19,700] TRACE Controller 0 epoch 45 elected leader 0 for Offline partition [test3,0] (state.change.logger)
[2017-12-08 10:07:19,700] TRACE Controller 0 epoch 45 changed partition [test3,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-08 10:07:19,700] TRACE Controller 0 epoch 45 started leader election for partition [log,0] (state.change.logger)
[2017-12-08 10:07:19,710] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 45 starting the become-leader transition for partition [test1,0] (state.change.logger)
[2017-12-08 10:07:19,710] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 45 starting the become-leader transition for partition [test3,0] (state.change.logger)
[2017-12-08 10:07:19,710] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 45 starting the become-leader transition for partition [test,0] (state.change.logger)
[2017-12-08 10:07:19,710] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 45 starting the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-12-08 10:07:19,710] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 45 starting the become-leader transition for partition [log,0] (state.change.logger)
[2017-12-08 10:07:19,770] TRACE Controller 0 epoch 45 elected leader 0 for Offline partition [log,0] (state.change.logger)
[2017-12-08 10:07:19,770] TRACE Controller 0 epoch 45 changed partition [log,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-08 10:07:19,770] TRACE Controller 0 epoch 45 started leader election for partition [json-topic,0] (state.change.logger)
[2017-12-08 10:07:19,972] TRACE Controller 0 epoch 45 elected leader 0 for Offline partition [json-topic,0] (state.change.logger)
[2017-12-08 10:07:19,972] TRACE Controller 0 epoch 45 changed partition [json-topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-08 10:07:19,972] TRACE Controller 0 epoch 45 started leader election for partition [test,0] (state.change.logger)
[2017-12-08 10:07:20,096] TRACE Controller 0 epoch 45 elected leader 0 for Offline partition [test,0] (state.change.logger)
[2017-12-08 10:07:20,096] TRACE Controller 0 epoch 45 changed partition [test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-08 10:07:20,096] TRACE Controller 0 epoch 45 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:17,ControllerEpoch:45) to broker 0 for partition [test1,0] (state.change.logger)
[2017-12-08 10:07:20,096] TRACE Controller 0 epoch 45 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:16,ControllerEpoch:45) to broker 0 for partition [test3,0] (state.change.logger)
[2017-12-08 10:07:20,096] TRACE Controller 0 epoch 45 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:39,ControllerEpoch:45) to broker 0 for partition [test,0] (state.change.logger)
[2017-12-08 10:07:20,096] TRACE Controller 0 epoch 45 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:45) to broker 0 for partition [json-topic,0] (state.change.logger)
[2017-12-08 10:07:20,096] TRACE Controller 0 epoch 45 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:15,ControllerEpoch:45) to broker 0 for partition [log,0] (state.change.logger)
[2017-12-08 10:07:20,096] TRACE Controller 0 epoch 45 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:17,ControllerEpoch:45) to broker 0 for partition test1-0 (state.change.logger)
[2017-12-08 10:07:20,096] TRACE Controller 0 epoch 45 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:16,ControllerEpoch:45) to broker 0 for partition test3-0 (state.change.logger)
[2017-12-08 10:07:20,096] TRACE Controller 0 epoch 45 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:39,ControllerEpoch:45) to broker 0 for partition test-0 (state.change.logger)
[2017-12-08 10:07:20,096] TRACE Controller 0 epoch 45 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:45) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-12-08 10:07:20,096] TRACE Controller 0 epoch 45 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:15,ControllerEpoch:45) to broker 0 for partition log-0 (state.change.logger)
[2017-12-08 10:07:20,583] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 45 with correlation id 1 for partition [json-topic,0] (state.change.logger)
[2017-12-08 10:07:20,583] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 45 with correlation id 1 for partition [test1,0] (state.change.logger)
[2017-12-08 10:07:20,593] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 45 with correlation id 1 for partition [log,0] (state.change.logger)
[2017-12-08 10:07:20,593] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 45 with correlation id 1 for partition [test,0] (state.change.logger)
[2017-12-08 10:07:20,593] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 45 with correlation id 1 for partition [test3,0] (state.change.logger)
[2017-12-08 10:07:20,603] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 45 for the become-leader transition for partition [test1,0] (state.change.logger)
[2017-12-08 10:07:20,603] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 45 for the become-leader transition for partition [test3,0] (state.change.logger)
[2017-12-08 10:07:20,603] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 45 for the become-leader transition for partition [test,0] (state.change.logger)
[2017-12-08 10:07:20,603] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 45 for the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-12-08 10:07:20,603] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 45 for the become-leader transition for partition [log,0] (state.change.logger)
[2017-12-08 10:07:20,675] TRACE Controller 0 epoch 45 received response {error_code=0,partitions=[{topic=test1,partition=0,error_code=0},{topic=test3,partition=0,error_code=0},{topic=json-topic,partition=0,error_code=0},{topic=test,partition=0,error_code=0},{topic=log,partition=0,error_code=0}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-08 10:07:20,678] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:15,ControllerEpoch:44),ReplicationFactor:1),AllReplicas:0) for partition test3-0 in response to UpdateMetadata request sent by controller 0 epoch 45 with correlation id 2 (state.change.logger)
[2017-12-08 10:07:20,678] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:16,ControllerEpoch:44),ReplicationFactor:1),AllReplicas:0) for partition test1-0 in response to UpdateMetadata request sent by controller 0 epoch 45 with correlation id 2 (state.change.logger)
[2017-12-08 10:07:20,678] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:14,ControllerEpoch:44),ReplicationFactor:1),AllReplicas:0) for partition log-0 in response to UpdateMetadata request sent by controller 0 epoch 45 with correlation id 2 (state.change.logger)
[2017-12-08 10:07:20,678] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:38,ControllerEpoch:44),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 45 with correlation id 2 (state.change.logger)
[2017-12-08 10:07:20,678] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:31,ControllerEpoch:44),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 45 with correlation id 2 (state.change.logger)
[2017-12-08 10:07:20,679] TRACE Controller 0 epoch 45 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-08 10:07:20,681] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=45, leader=0, leaderEpoch=16, isr=[0], zkVersion=16, replicas=[0]) correlation id 3 from controller 0 epoch 45 for partition [test3,0] (state.change.logger)
[2017-12-08 10:07:20,681] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=45, leader=0, leaderEpoch=17, isr=[0], zkVersion=17, replicas=[0]) correlation id 3 from controller 0 epoch 45 for partition [test1,0] (state.change.logger)
[2017-12-08 10:07:20,682] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=45, leader=0, leaderEpoch=15, isr=[0], zkVersion=15, replicas=[0]) correlation id 3 from controller 0 epoch 45 for partition [log,0] (state.change.logger)
[2017-12-08 10:07:20,682] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=45, leader=0, leaderEpoch=39, isr=[0], zkVersion=39, replicas=[0]) correlation id 3 from controller 0 epoch 45 for partition [test,0] (state.change.logger)
[2017-12-08 10:07:20,682] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=45, leader=0, leaderEpoch=32, isr=[0], zkVersion=32, replicas=[0]) correlation id 3 from controller 0 epoch 45 for partition [json-topic,0] (state.change.logger)
[2017-12-08 10:07:20,684] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 45 starting the become-leader transition for partition [test1,0] (state.change.logger)
[2017-12-08 10:07:20,684] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 45 starting the become-leader transition for partition [test3,0] (state.change.logger)
[2017-12-08 10:07:20,684] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 45 starting the become-leader transition for partition [test,0] (state.change.logger)
[2017-12-08 10:07:20,684] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 45 starting the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-12-08 10:07:20,684] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 45 starting the become-leader transition for partition [log,0] (state.change.logger)
[2017-12-08 10:07:20,688] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 45 for partition [test1,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-08 10:07:20,688] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 45 for partition [test3,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-08 10:07:20,689] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 45 for partition [test,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-08 10:07:20,689] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 45 for partition [json-topic,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-08 10:07:20,689] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 45 for partition [log,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-08 10:07:20,689] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 45 for the become-leader transition for partition [test1,0] (state.change.logger)
[2017-12-08 10:07:20,689] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 45 for the become-leader transition for partition [test3,0] (state.change.logger)
[2017-12-08 10:07:20,689] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 45 for the become-leader transition for partition [test,0] (state.change.logger)
[2017-12-08 10:07:20,689] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 45 for the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-12-08 10:07:20,690] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 45 for the become-leader transition for partition [log,0] (state.change.logger)
[2017-12-08 10:07:20,690] TRACE Controller 0 epoch 45 received response {error_code=0,partitions=[{topic=test1,partition=0,error_code=0},{topic=test3,partition=0,error_code=0},{topic=json-topic,partition=0,error_code=0},{topic=test,partition=0,error_code=0},{topic=log,partition=0,error_code=0}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-08 10:07:20,693] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:16,ControllerEpoch:45),ReplicationFactor:1),AllReplicas:0) for partition test3-0 in response to UpdateMetadata request sent by controller 0 epoch 45 with correlation id 4 (state.change.logger)
[2017-12-08 10:07:20,694] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:17,ControllerEpoch:45),ReplicationFactor:1),AllReplicas:0) for partition test1-0 in response to UpdateMetadata request sent by controller 0 epoch 45 with correlation id 4 (state.change.logger)
[2017-12-08 10:07:20,694] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:15,ControllerEpoch:45),ReplicationFactor:1),AllReplicas:0) for partition log-0 in response to UpdateMetadata request sent by controller 0 epoch 45 with correlation id 4 (state.change.logger)
[2017-12-08 10:07:20,694] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:39,ControllerEpoch:45),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 45 with correlation id 4 (state.change.logger)
[2017-12-08 10:07:20,695] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:45),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 45 with correlation id 4 (state.change.logger)
[2017-12-08 10:07:20,697] TRACE Controller 0 epoch 45 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-12 08:28:16,245] TRACE Controller 0 epoch 46 started leader election for partition [test1,0] (state.change.logger)
[2017-12-12 08:28:17,905] ERROR Controller 0 epoch 46 initiated state change for partition [test1,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test1,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1168)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1166)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-12-12 08:28:18,014] TRACE Controller 0 epoch 46 started leader election for partition [test3,0] (state.change.logger)
[2017-12-12 08:28:18,303] ERROR Controller 0 epoch 46 initiated state change for partition [test3,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test3,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1168)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1166)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-12-12 08:28:18,421] TRACE Controller 0 epoch 46 started leader election for partition [log,0] (state.change.logger)
[2017-12-12 08:28:18,521] ERROR Controller 0 epoch 46 initiated state change for partition [log,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [log,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1168)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1166)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-12-12 08:28:18,559] TRACE Controller 0 epoch 46 started leader election for partition [json-topic,0] (state.change.logger)
[2017-12-12 08:28:18,916] ERROR Controller 0 epoch 46 initiated state change for partition [json-topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [json-topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1168)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1166)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-12-12 08:28:19,017] TRACE Controller 0 epoch 46 started leader election for partition [test,0] (state.change.logger)
[2017-12-12 08:28:19,212] ERROR Controller 0 epoch 46 initiated state change for partition [test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1168)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1166)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-12-12 08:28:23,882] TRACE Controller 0 epoch 46 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:17,ControllerEpoch:45) to broker 0 for partition test1-0 (state.change.logger)
[2017-12-12 08:28:23,891] TRACE Controller 0 epoch 46 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:16,ControllerEpoch:45) to broker 0 for partition test3-0 (state.change.logger)
[2017-12-12 08:28:23,892] TRACE Controller 0 epoch 46 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:39,ControllerEpoch:45) to broker 0 for partition test-0 (state.change.logger)
[2017-12-12 08:28:23,892] TRACE Controller 0 epoch 46 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:45) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-12-12 08:28:23,892] TRACE Controller 0 epoch 46 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:15,ControllerEpoch:45) to broker 0 for partition log-0 (state.change.logger)
[2017-12-12 08:28:24,163] TRACE Controller 0 epoch 46 changed state of replica 0 for partition [test3,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-12 08:28:24,164] TRACE Controller 0 epoch 46 changed state of replica 0 for partition [test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-12 08:28:24,164] TRACE Controller 0 epoch 46 changed state of replica 0 for partition [json-topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-12 08:28:24,164] TRACE Controller 0 epoch 46 changed state of replica 0 for partition [log,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-12 08:28:24,164] TRACE Controller 0 epoch 46 changed state of replica 0 for partition [test1,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-12 08:28:24,164] TRACE Controller 0 epoch 46 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:17,ControllerEpoch:45) to broker 0 for partition [test1,0] (state.change.logger)
[2017-12-12 08:28:24,165] TRACE Controller 0 epoch 46 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:16,ControllerEpoch:45) to broker 0 for partition [test3,0] (state.change.logger)
[2017-12-12 08:28:24,165] TRACE Controller 0 epoch 46 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:45) to broker 0 for partition [json-topic,0] (state.change.logger)
[2017-12-12 08:28:24,165] TRACE Controller 0 epoch 46 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:39,ControllerEpoch:45) to broker 0 for partition [test,0] (state.change.logger)
[2017-12-12 08:28:24,165] TRACE Controller 0 epoch 46 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:15,ControllerEpoch:45) to broker 0 for partition [log,0] (state.change.logger)
[2017-12-12 08:28:24,215] TRACE Controller 0 epoch 46 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:17,ControllerEpoch:45) to broker 0 for partition test1-0 (state.change.logger)
[2017-12-12 08:28:24,215] TRACE Controller 0 epoch 46 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:16,ControllerEpoch:45) to broker 0 for partition test3-0 (state.change.logger)
[2017-12-12 08:28:24,215] TRACE Controller 0 epoch 46 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:45) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-12-12 08:28:24,216] TRACE Controller 0 epoch 46 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:39,ControllerEpoch:45) to broker 0 for partition test-0 (state.change.logger)
[2017-12-12 08:28:24,216] TRACE Controller 0 epoch 46 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:15,ControllerEpoch:45) to broker 0 for partition log-0 (state.change.logger)
[2017-12-12 08:28:24,217] TRACE Controller 0 epoch 46 started leader election for partition [test1,0] (state.change.logger)
[2017-12-12 08:28:24,765] TRACE Controller 0 epoch 46 elected leader 0 for Offline partition [test1,0] (state.change.logger)
[2017-12-12 08:28:24,765] TRACE Controller 0 epoch 46 changed partition [test1,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-12 08:28:24,766] TRACE Controller 0 epoch 46 started leader election for partition [test3,0] (state.change.logger)
[2017-12-12 08:28:24,937] TRACE Controller 0 epoch 46 elected leader 0 for Offline partition [test3,0] (state.change.logger)
[2017-12-12 08:28:24,937] TRACE Controller 0 epoch 46 changed partition [test3,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-12 08:28:24,937] TRACE Controller 0 epoch 46 started leader election for partition [log,0] (state.change.logger)
[2017-12-12 08:28:25,046] TRACE Controller 0 epoch 46 elected leader 0 for Offline partition [log,0] (state.change.logger)
[2017-12-12 08:28:25,046] TRACE Controller 0 epoch 46 changed partition [log,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-12 08:28:25,046] TRACE Controller 0 epoch 46 started leader election for partition [json-topic,0] (state.change.logger)
[2017-12-12 08:28:25,239] TRACE Controller 0 epoch 46 elected leader 0 for Offline partition [json-topic,0] (state.change.logger)
[2017-12-12 08:28:25,239] TRACE Controller 0 epoch 46 changed partition [json-topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-12 08:28:25,239] TRACE Controller 0 epoch 46 started leader election for partition [test,0] (state.change.logger)
[2017-12-12 08:28:25,361] TRACE Controller 0 epoch 46 elected leader 0 for Offline partition [test,0] (state.change.logger)
[2017-12-12 08:28:25,364] TRACE Controller 0 epoch 46 changed partition [test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-12 08:28:25,364] TRACE Controller 0 epoch 46 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:18,ControllerEpoch:46) to broker 0 for partition [test1,0] (state.change.logger)
[2017-12-12 08:28:25,364] TRACE Controller 0 epoch 46 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:17,ControllerEpoch:46) to broker 0 for partition [test3,0] (state.change.logger)
[2017-12-12 08:28:25,364] TRACE Controller 0 epoch 46 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:40,ControllerEpoch:46) to broker 0 for partition [test,0] (state.change.logger)
[2017-12-12 08:28:25,364] TRACE Controller 0 epoch 46 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:33,ControllerEpoch:46) to broker 0 for partition [json-topic,0] (state.change.logger)
[2017-12-12 08:28:25,364] TRACE Controller 0 epoch 46 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:16,ControllerEpoch:46) to broker 0 for partition [log,0] (state.change.logger)
[2017-12-12 08:28:25,364] TRACE Controller 0 epoch 46 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:18,ControllerEpoch:46) to broker 0 for partition test1-0 (state.change.logger)
[2017-12-12 08:28:25,364] TRACE Controller 0 epoch 46 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:17,ControllerEpoch:46) to broker 0 for partition test3-0 (state.change.logger)
[2017-12-12 08:28:25,364] TRACE Controller 0 epoch 46 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:40,ControllerEpoch:46) to broker 0 for partition test-0 (state.change.logger)
[2017-12-12 08:28:25,364] TRACE Controller 0 epoch 46 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:33,ControllerEpoch:46) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-12-12 08:28:25,364] TRACE Controller 0 epoch 46 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:16,ControllerEpoch:46) to broker 0 for partition log-0 (state.change.logger)
[2017-12-12 08:28:25,370] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:16,ControllerEpoch:45),ReplicationFactor:1),AllReplicas:0) for partition test3-0 in response to UpdateMetadata request sent by controller 0 epoch 46 with correlation id 0 (state.change.logger)
[2017-12-12 08:28:25,389] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:17,ControllerEpoch:45),ReplicationFactor:1),AllReplicas:0) for partition test1-0 in response to UpdateMetadata request sent by controller 0 epoch 46 with correlation id 0 (state.change.logger)
[2017-12-12 08:28:25,389] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:15,ControllerEpoch:45),ReplicationFactor:1),AllReplicas:0) for partition log-0 in response to UpdateMetadata request sent by controller 0 epoch 46 with correlation id 0 (state.change.logger)
[2017-12-12 08:28:25,389] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:39,ControllerEpoch:45),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 46 with correlation id 0 (state.change.logger)
[2017-12-12 08:28:25,389] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:45),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 46 with correlation id 0 (state.change.logger)
[2017-12-12 08:28:25,524] TRACE Controller 0 epoch 46 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-12 08:28:25,567] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=45, leader=0, leaderEpoch=16, isr=[0], zkVersion=16, replicas=[0]) correlation id 1 from controller 0 epoch 46 for partition [test3,0] (state.change.logger)
[2017-12-12 08:28:25,567] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=45, leader=0, leaderEpoch=17, isr=[0], zkVersion=17, replicas=[0]) correlation id 1 from controller 0 epoch 46 for partition [test1,0] (state.change.logger)
[2017-12-12 08:28:25,567] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=45, leader=0, leaderEpoch=15, isr=[0], zkVersion=15, replicas=[0]) correlation id 1 from controller 0 epoch 46 for partition [log,0] (state.change.logger)
[2017-12-12 08:28:25,567] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=45, leader=0, leaderEpoch=39, isr=[0], zkVersion=39, replicas=[0]) correlation id 1 from controller 0 epoch 46 for partition [test,0] (state.change.logger)
[2017-12-12 08:28:25,567] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=45, leader=0, leaderEpoch=32, isr=[0], zkVersion=32, replicas=[0]) correlation id 1 from controller 0 epoch 46 for partition [json-topic,0] (state.change.logger)
[2017-12-12 08:28:25,911] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 46 for partition [test3,0] since its associated leader epoch 16 is not higher than the current leader epoch 16 (state.change.logger)
[2017-12-12 08:28:25,979] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 46 for partition [test1,0] since its associated leader epoch 17 is not higher than the current leader epoch 17 (state.change.logger)
[2017-12-12 08:28:25,979] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 46 for partition [log,0] since its associated leader epoch 15 is not higher than the current leader epoch 15 (state.change.logger)
[2017-12-12 08:28:25,979] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 46 for partition [test,0] since its associated leader epoch 39 is not higher than the current leader epoch 39 (state.change.logger)
[2017-12-12 08:28:25,979] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 46 for partition [json-topic,0] since its associated leader epoch 32 is not higher than the current leader epoch 32 (state.change.logger)
[2017-12-12 08:28:25,980] TRACE Controller 0 epoch 46 received response {error_code=0,partitions=[{topic=test1,partition=0,error_code=11},{topic=test3,partition=0,error_code=11},{topic=json-topic,partition=0,error_code=11},{topic=test,partition=0,error_code=11},{topic=log,partition=0,error_code=11}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-12 08:28:25,988] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:16,ControllerEpoch:45),ReplicationFactor:1),AllReplicas:0) for partition test3-0 in response to UpdateMetadata request sent by controller 0 epoch 46 with correlation id 2 (state.change.logger)
[2017-12-12 08:28:25,989] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:17,ControllerEpoch:45),ReplicationFactor:1),AllReplicas:0) for partition test1-0 in response to UpdateMetadata request sent by controller 0 epoch 46 with correlation id 2 (state.change.logger)
[2017-12-12 08:28:25,989] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:15,ControllerEpoch:45),ReplicationFactor:1),AllReplicas:0) for partition log-0 in response to UpdateMetadata request sent by controller 0 epoch 46 with correlation id 2 (state.change.logger)
[2017-12-12 08:28:25,989] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:39,ControllerEpoch:45),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 46 with correlation id 2 (state.change.logger)
[2017-12-12 08:28:25,989] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:45),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 46 with correlation id 2 (state.change.logger)
[2017-12-12 08:28:25,989] TRACE Controller 0 epoch 46 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-12 08:28:25,990] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=46, leader=0, leaderEpoch=17, isr=[0], zkVersion=17, replicas=[0]) correlation id 3 from controller 0 epoch 46 for partition [test3,0] (state.change.logger)
[2017-12-12 08:28:25,990] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=46, leader=0, leaderEpoch=18, isr=[0], zkVersion=18, replicas=[0]) correlation id 3 from controller 0 epoch 46 for partition [test1,0] (state.change.logger)
[2017-12-12 08:28:25,990] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=46, leader=0, leaderEpoch=16, isr=[0], zkVersion=16, replicas=[0]) correlation id 3 from controller 0 epoch 46 for partition [log,0] (state.change.logger)
[2017-12-12 08:28:25,990] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=46, leader=0, leaderEpoch=40, isr=[0], zkVersion=40, replicas=[0]) correlation id 3 from controller 0 epoch 46 for partition [test,0] (state.change.logger)
[2017-12-12 08:28:25,990] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=46, leader=0, leaderEpoch=33, isr=[0], zkVersion=33, replicas=[0]) correlation id 3 from controller 0 epoch 46 for partition [json-topic,0] (state.change.logger)
[2017-12-12 08:28:26,005] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 46 starting the become-leader transition for partition [test1,0] (state.change.logger)
[2017-12-12 08:28:26,005] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 46 starting the become-leader transition for partition [test3,0] (state.change.logger)
[2017-12-12 08:28:26,005] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 46 starting the become-leader transition for partition [test,0] (state.change.logger)
[2017-12-12 08:28:26,005] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 46 starting the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-12-12 08:28:26,005] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 46 starting the become-leader transition for partition [log,0] (state.change.logger)
[2017-12-12 08:28:26,182] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 46 for partition [test1,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-12 08:28:26,182] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 46 for partition [test3,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-12 08:28:26,182] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 46 for partition [test,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-12 08:28:26,182] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 46 for partition [json-topic,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-12 08:28:26,183] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 46 for partition [log,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-12 08:28:26,183] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 46 for the become-leader transition for partition [test1,0] (state.change.logger)
[2017-12-12 08:28:26,183] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 46 for the become-leader transition for partition [test3,0] (state.change.logger)
[2017-12-12 08:28:26,183] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 46 for the become-leader transition for partition [test,0] (state.change.logger)
[2017-12-12 08:28:26,183] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 46 for the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-12-12 08:28:26,183] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 46 for the become-leader transition for partition [log,0] (state.change.logger)
[2017-12-12 08:28:26,183] TRACE Controller 0 epoch 46 received response {error_code=0,partitions=[{topic=test1,partition=0,error_code=0},{topic=test3,partition=0,error_code=0},{topic=json-topic,partition=0,error_code=0},{topic=test,partition=0,error_code=0},{topic=log,partition=0,error_code=0}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-12 08:28:26,189] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:17,ControllerEpoch:46),ReplicationFactor:1),AllReplicas:0) for partition test3-0 in response to UpdateMetadata request sent by controller 0 epoch 46 with correlation id 4 (state.change.logger)
[2017-12-12 08:28:26,190] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:18,ControllerEpoch:46),ReplicationFactor:1),AllReplicas:0) for partition test1-0 in response to UpdateMetadata request sent by controller 0 epoch 46 with correlation id 4 (state.change.logger)
[2017-12-12 08:28:26,190] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:16,ControllerEpoch:46),ReplicationFactor:1),AllReplicas:0) for partition log-0 in response to UpdateMetadata request sent by controller 0 epoch 46 with correlation id 4 (state.change.logger)
[2017-12-12 08:28:26,190] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:40,ControllerEpoch:46),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 46 with correlation id 4 (state.change.logger)
[2017-12-12 08:28:26,190] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:33,ControllerEpoch:46),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 46 with correlation id 4 (state.change.logger)
[2017-12-12 08:28:26,190] TRACE Controller 0 epoch 46 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-12 08:47:28,506] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2017-12-12 08:47:40,446] TRACE Controller 0 epoch 47 started leader election for partition [test1,0] (state.change.logger)
[2017-12-12 08:47:40,543] ERROR Controller 0 epoch 47 initiated state change for partition [test1,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test1,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-12-12 08:47:40,599] TRACE Controller 0 epoch 47 started leader election for partition [test3,0] (state.change.logger)
[2017-12-12 08:47:40,624] ERROR Controller 0 epoch 47 initiated state change for partition [test3,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test3,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-12-12 08:47:40,625] TRACE Controller 0 epoch 47 started leader election for partition [log,0] (state.change.logger)
[2017-12-12 08:47:40,646] ERROR Controller 0 epoch 47 initiated state change for partition [log,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [log,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-12-12 08:47:40,646] TRACE Controller 0 epoch 47 started leader election for partition [json-topic,0] (state.change.logger)
[2017-12-12 08:47:40,665] ERROR Controller 0 epoch 47 initiated state change for partition [json-topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [json-topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-12-12 08:47:40,666] TRACE Controller 0 epoch 47 started leader election for partition [test,0] (state.change.logger)
[2017-12-12 08:47:40,672] ERROR Controller 0 epoch 47 initiated state change for partition [test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-12-12 08:47:41,571] TRACE Controller 0 epoch 47 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:18,ControllerEpoch:46) to broker 0 for partition test1-0 (state.change.logger)
[2017-12-12 08:47:41,571] TRACE Controller 0 epoch 47 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:17,ControllerEpoch:46) to broker 0 for partition test3-0 (state.change.logger)
[2017-12-12 08:47:41,571] TRACE Controller 0 epoch 47 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:40,ControllerEpoch:46) to broker 0 for partition test-0 (state.change.logger)
[2017-12-12 08:47:41,571] TRACE Controller 0 epoch 47 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:33,ControllerEpoch:46) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-12-12 08:47:41,571] TRACE Controller 0 epoch 47 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:16,ControllerEpoch:46) to broker 0 for partition log-0 (state.change.logger)
[2017-12-12 08:47:41,597] TRACE Controller 0 epoch 47 changed state of replica 0 for partition [test3,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-12 08:47:41,597] TRACE Controller 0 epoch 47 changed state of replica 0 for partition [test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-12 08:47:41,597] TRACE Controller 0 epoch 47 changed state of replica 0 for partition [json-topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-12 08:47:41,597] TRACE Controller 0 epoch 47 changed state of replica 0 for partition [log,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-12 08:47:41,597] TRACE Controller 0 epoch 47 changed state of replica 0 for partition [test1,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-12 08:47:41,597] TRACE Controller 0 epoch 47 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:18,ControllerEpoch:46) to broker 0 for partition [test1,0] (state.change.logger)
[2017-12-12 08:47:41,597] TRACE Controller 0 epoch 47 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:17,ControllerEpoch:46) to broker 0 for partition [test3,0] (state.change.logger)
[2017-12-12 08:47:41,597] TRACE Controller 0 epoch 47 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:33,ControllerEpoch:46) to broker 0 for partition [json-topic,0] (state.change.logger)
[2017-12-12 08:47:41,597] TRACE Controller 0 epoch 47 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:40,ControllerEpoch:46) to broker 0 for partition [test,0] (state.change.logger)
[2017-12-12 08:47:41,597] TRACE Controller 0 epoch 47 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:16,ControllerEpoch:46) to broker 0 for partition [log,0] (state.change.logger)
[2017-12-12 08:47:41,610] TRACE Controller 0 epoch 47 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:18,ControllerEpoch:46) to broker 0 for partition test1-0 (state.change.logger)
[2017-12-12 08:47:41,610] TRACE Controller 0 epoch 47 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:17,ControllerEpoch:46) to broker 0 for partition test3-0 (state.change.logger)
[2017-12-12 08:47:41,610] TRACE Controller 0 epoch 47 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:33,ControllerEpoch:46) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-12-12 08:47:41,610] TRACE Controller 0 epoch 47 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:40,ControllerEpoch:46) to broker 0 for partition test-0 (state.change.logger)
[2017-12-12 08:47:41,610] TRACE Controller 0 epoch 47 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:16,ControllerEpoch:46) to broker 0 for partition log-0 (state.change.logger)
[2017-12-12 08:47:41,610] TRACE Controller 0 epoch 47 started leader election for partition [test1,0] (state.change.logger)
[2017-12-12 08:47:41,702] TRACE Controller 0 epoch 47 elected leader 0 for Offline partition [test1,0] (state.change.logger)
[2017-12-12 08:47:41,715] TRACE Controller 0 epoch 47 changed partition [test1,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-12 08:47:41,715] TRACE Controller 0 epoch 47 started leader election for partition [test3,0] (state.change.logger)
[2017-12-12 08:47:41,754] TRACE Controller 0 epoch 47 elected leader 0 for Offline partition [test3,0] (state.change.logger)
[2017-12-12 08:47:41,754] TRACE Controller 0 epoch 47 changed partition [test3,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-12 08:47:41,754] TRACE Controller 0 epoch 47 started leader election for partition [log,0] (state.change.logger)
[2017-12-12 08:47:41,780] TRACE Controller 0 epoch 47 elected leader 0 for Offline partition [log,0] (state.change.logger)
[2017-12-12 08:47:41,780] TRACE Controller 0 epoch 47 changed partition [log,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-12 08:47:41,780] TRACE Controller 0 epoch 47 started leader election for partition [json-topic,0] (state.change.logger)
[2017-12-12 08:47:41,832] TRACE Controller 0 epoch 47 elected leader 0 for Offline partition [json-topic,0] (state.change.logger)
[2017-12-12 08:47:41,845] TRACE Controller 0 epoch 47 changed partition [json-topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-12 08:47:41,845] TRACE Controller 0 epoch 47 started leader election for partition [test,0] (state.change.logger)
[2017-12-12 08:47:41,885] TRACE Controller 0 epoch 47 elected leader 0 for Offline partition [test,0] (state.change.logger)
[2017-12-12 08:47:41,885] TRACE Controller 0 epoch 47 changed partition [test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-12 08:47:41,885] TRACE Controller 0 epoch 47 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:19,ControllerEpoch:47) to broker 0 for partition [test1,0] (state.change.logger)
[2017-12-12 08:47:41,885] TRACE Controller 0 epoch 47 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:18,ControllerEpoch:47) to broker 0 for partition [test3,0] (state.change.logger)
[2017-12-12 08:47:41,885] TRACE Controller 0 epoch 47 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:41,ControllerEpoch:47) to broker 0 for partition [test,0] (state.change.logger)
[2017-12-12 08:47:41,885] TRACE Controller 0 epoch 47 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:34,ControllerEpoch:47) to broker 0 for partition [json-topic,0] (state.change.logger)
[2017-12-12 08:47:41,885] TRACE Controller 0 epoch 47 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:17,ControllerEpoch:47) to broker 0 for partition [log,0] (state.change.logger)
[2017-12-12 08:47:41,885] TRACE Controller 0 epoch 47 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:19,ControllerEpoch:47) to broker 0 for partition test1-0 (state.change.logger)
[2017-12-12 08:47:41,885] TRACE Controller 0 epoch 47 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:18,ControllerEpoch:47) to broker 0 for partition test3-0 (state.change.logger)
[2017-12-12 08:47:41,885] TRACE Controller 0 epoch 47 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:41,ControllerEpoch:47) to broker 0 for partition test-0 (state.change.logger)
[2017-12-12 08:47:41,885] TRACE Controller 0 epoch 47 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:34,ControllerEpoch:47) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-12-12 08:47:41,885] TRACE Controller 0 epoch 47 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:17,ControllerEpoch:47) to broker 0 for partition log-0 (state.change.logger)
[2017-12-12 08:47:41,911] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:17,ControllerEpoch:46),ReplicationFactor:1),AllReplicas:0) for partition test3-0 in response to UpdateMetadata request sent by controller 0 epoch 47 with correlation id 0 (state.change.logger)
[2017-12-12 08:47:41,911] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:18,ControllerEpoch:46),ReplicationFactor:1),AllReplicas:0) for partition test1-0 in response to UpdateMetadata request sent by controller 0 epoch 47 with correlation id 0 (state.change.logger)
[2017-12-12 08:47:41,911] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:16,ControllerEpoch:46),ReplicationFactor:1),AllReplicas:0) for partition log-0 in response to UpdateMetadata request sent by controller 0 epoch 47 with correlation id 0 (state.change.logger)
[2017-12-12 08:47:41,911] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:40,ControllerEpoch:46),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 47 with correlation id 0 (state.change.logger)
[2017-12-12 08:47:41,911] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:33,ControllerEpoch:46),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 47 with correlation id 0 (state.change.logger)
[2017-12-12 08:47:41,911] TRACE Controller 0 epoch 47 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-12 08:47:41,950] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=46, leader=0, leaderEpoch=17, isr=[0], zkVersion=17, replicas=[0]) correlation id 1 from controller 0 epoch 47 for partition [test3,0] (state.change.logger)
[2017-12-12 08:47:41,950] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=46, leader=0, leaderEpoch=18, isr=[0], zkVersion=18, replicas=[0]) correlation id 1 from controller 0 epoch 47 for partition [test1,0] (state.change.logger)
[2017-12-12 08:47:41,950] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=46, leader=0, leaderEpoch=16, isr=[0], zkVersion=16, replicas=[0]) correlation id 1 from controller 0 epoch 47 for partition [log,0] (state.change.logger)
[2017-12-12 08:47:41,950] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=46, leader=0, leaderEpoch=40, isr=[0], zkVersion=40, replicas=[0]) correlation id 1 from controller 0 epoch 47 for partition [test,0] (state.change.logger)
[2017-12-12 08:47:41,950] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=46, leader=0, leaderEpoch=33, isr=[0], zkVersion=33, replicas=[0]) correlation id 1 from controller 0 epoch 47 for partition [json-topic,0] (state.change.logger)
[2017-12-12 08:47:41,963] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 47 starting the become-leader transition for partition [test1,0] (state.change.logger)
[2017-12-12 08:47:41,963] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 47 starting the become-leader transition for partition [test3,0] (state.change.logger)
[2017-12-12 08:47:41,963] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 47 starting the become-leader transition for partition [test,0] (state.change.logger)
[2017-12-12 08:47:41,963] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 47 starting the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-12-12 08:47:41,963] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 47 starting the become-leader transition for partition [log,0] (state.change.logger)
[2017-12-12 08:47:42,002] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 47 with correlation id 1 for partition [json-topic,0] (state.change.logger)
[2017-12-12 08:47:42,002] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 47 with correlation id 1 for partition [test1,0] (state.change.logger)
[2017-12-12 08:47:42,002] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 47 with correlation id 1 for partition [log,0] (state.change.logger)
[2017-12-12 08:47:42,002] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 47 with correlation id 1 for partition [test,0] (state.change.logger)
[2017-12-12 08:47:42,002] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 47 with correlation id 1 for partition [test3,0] (state.change.logger)
[2017-12-12 08:47:42,015] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 47 for the become-leader transition for partition [test1,0] (state.change.logger)
[2017-12-12 08:47:42,015] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 47 for the become-leader transition for partition [test3,0] (state.change.logger)
[2017-12-12 08:47:42,015] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 47 for the become-leader transition for partition [test,0] (state.change.logger)
[2017-12-12 08:47:42,015] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 47 for the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-12-12 08:47:42,015] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 47 for the become-leader transition for partition [log,0] (state.change.logger)
[2017-12-12 08:47:42,028] TRACE Controller 0 epoch 47 received response {error_code=0,partitions=[{topic=test1,partition=0,error_code=0},{topic=test3,partition=0,error_code=0},{topic=json-topic,partition=0,error_code=0},{topic=test,partition=0,error_code=0},{topic=log,partition=0,error_code=0}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-12 08:47:42,028] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:17,ControllerEpoch:46),ReplicationFactor:1),AllReplicas:0) for partition test3-0 in response to UpdateMetadata request sent by controller 0 epoch 47 with correlation id 2 (state.change.logger)
[2017-12-12 08:47:42,028] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:18,ControllerEpoch:46),ReplicationFactor:1),AllReplicas:0) for partition test1-0 in response to UpdateMetadata request sent by controller 0 epoch 47 with correlation id 2 (state.change.logger)
[2017-12-12 08:47:42,028] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:16,ControllerEpoch:46),ReplicationFactor:1),AllReplicas:0) for partition log-0 in response to UpdateMetadata request sent by controller 0 epoch 47 with correlation id 2 (state.change.logger)
[2017-12-12 08:47:42,028] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:40,ControllerEpoch:46),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 47 with correlation id 2 (state.change.logger)
[2017-12-12 08:47:42,028] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:33,ControllerEpoch:46),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 47 with correlation id 2 (state.change.logger)
[2017-12-12 08:47:42,028] TRACE Controller 0 epoch 47 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-12 08:47:42,028] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=47, leader=0, leaderEpoch=18, isr=[0], zkVersion=18, replicas=[0]) correlation id 3 from controller 0 epoch 47 for partition [test3,0] (state.change.logger)
[2017-12-12 08:47:42,028] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=47, leader=0, leaderEpoch=19, isr=[0], zkVersion=19, replicas=[0]) correlation id 3 from controller 0 epoch 47 for partition [test1,0] (state.change.logger)
[2017-12-12 08:47:42,028] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=47, leader=0, leaderEpoch=17, isr=[0], zkVersion=17, replicas=[0]) correlation id 3 from controller 0 epoch 47 for partition [log,0] (state.change.logger)
[2017-12-12 08:47:42,028] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=47, leader=0, leaderEpoch=41, isr=[0], zkVersion=41, replicas=[0]) correlation id 3 from controller 0 epoch 47 for partition [test,0] (state.change.logger)
[2017-12-12 08:47:42,028] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=47, leader=0, leaderEpoch=34, isr=[0], zkVersion=34, replicas=[0]) correlation id 3 from controller 0 epoch 47 for partition [json-topic,0] (state.change.logger)
[2017-12-12 08:47:42,028] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 47 starting the become-leader transition for partition [test1,0] (state.change.logger)
[2017-12-12 08:47:42,028] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 47 starting the become-leader transition for partition [test3,0] (state.change.logger)
[2017-12-12 08:47:42,028] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 47 starting the become-leader transition for partition [test,0] (state.change.logger)
[2017-12-12 08:47:42,028] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 47 starting the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-12-12 08:47:42,028] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 47 starting the become-leader transition for partition [log,0] (state.change.logger)
[2017-12-12 08:47:42,028] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 47 for partition [test1,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-12 08:47:42,028] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 47 for partition [test3,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-12 08:47:42,028] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 47 for partition [test,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-12 08:47:42,028] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 47 for partition [json-topic,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-12 08:47:42,028] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 47 for partition [log,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-12 08:47:42,028] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 47 for the become-leader transition for partition [test1,0] (state.change.logger)
[2017-12-12 08:47:42,028] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 47 for the become-leader transition for partition [test3,0] (state.change.logger)
[2017-12-12 08:47:42,028] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 47 for the become-leader transition for partition [test,0] (state.change.logger)
[2017-12-12 08:47:42,028] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 47 for the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-12-12 08:47:42,028] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 47 for the become-leader transition for partition [log,0] (state.change.logger)
[2017-12-12 08:47:42,028] TRACE Controller 0 epoch 47 received response {error_code=0,partitions=[{topic=test1,partition=0,error_code=0},{topic=test3,partition=0,error_code=0},{topic=json-topic,partition=0,error_code=0},{topic=test,partition=0,error_code=0},{topic=log,partition=0,error_code=0}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-12 08:47:42,041] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:18,ControllerEpoch:47),ReplicationFactor:1),AllReplicas:0) for partition test3-0 in response to UpdateMetadata request sent by controller 0 epoch 47 with correlation id 4 (state.change.logger)
[2017-12-12 08:47:42,041] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:19,ControllerEpoch:47),ReplicationFactor:1),AllReplicas:0) for partition test1-0 in response to UpdateMetadata request sent by controller 0 epoch 47 with correlation id 4 (state.change.logger)
[2017-12-12 08:47:42,041] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:17,ControllerEpoch:47),ReplicationFactor:1),AllReplicas:0) for partition log-0 in response to UpdateMetadata request sent by controller 0 epoch 47 with correlation id 4 (state.change.logger)
[2017-12-12 08:47:42,041] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:41,ControllerEpoch:47),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 47 with correlation id 4 (state.change.logger)
[2017-12-12 08:47:42,041] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:34,ControllerEpoch:47),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 47 with correlation id 4 (state.change.logger)
[2017-12-12 08:47:42,041] TRACE Controller 0 epoch 47 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-13 16:35:07,907] TRACE Controller 0 epoch 48 started leader election for partition [test1,0] (state.change.logger)
[2017-12-13 16:35:10,915] ERROR Controller 0 epoch 48 initiated state change for partition [test1,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test1,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1168)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1166)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-12-13 16:35:11,080] TRACE Controller 0 epoch 48 started leader election for partition [test3,0] (state.change.logger)
[2017-12-13 16:35:11,476] ERROR Controller 0 epoch 48 initiated state change for partition [test3,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test3,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1168)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1166)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-12-13 16:35:11,477] TRACE Controller 0 epoch 48 started leader election for partition [log,0] (state.change.logger)
[2017-12-13 16:35:11,668] ERROR Controller 0 epoch 48 initiated state change for partition [log,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [log,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1168)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1166)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-12-13 16:35:11,669] TRACE Controller 0 epoch 48 started leader election for partition [json-topic,0] (state.change.logger)
[2017-12-13 16:35:12,001] ERROR Controller 0 epoch 48 initiated state change for partition [json-topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [json-topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1168)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1166)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-12-13 16:35:12,001] TRACE Controller 0 epoch 48 started leader election for partition [test,0] (state.change.logger)
[2017-12-13 16:35:12,284] ERROR Controller 0 epoch 48 initiated state change for partition [test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1168)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1166)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-12-13 16:35:15,009] TRACE Controller 0 epoch 48 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:19,ControllerEpoch:47) to broker 0 for partition test1-0 (state.change.logger)
[2017-12-13 16:35:15,009] TRACE Controller 0 epoch 48 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:18,ControllerEpoch:47) to broker 0 for partition test3-0 (state.change.logger)
[2017-12-13 16:35:15,009] TRACE Controller 0 epoch 48 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:41,ControllerEpoch:47) to broker 0 for partition test-0 (state.change.logger)
[2017-12-13 16:35:15,009] TRACE Controller 0 epoch 48 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:34,ControllerEpoch:47) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-12-13 16:35:15,009] TRACE Controller 0 epoch 48 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:17,ControllerEpoch:47) to broker 0 for partition log-0 (state.change.logger)
[2017-12-13 16:35:15,302] TRACE Controller 0 epoch 48 changed state of replica 0 for partition [test3,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-13 16:35:15,302] TRACE Controller 0 epoch 48 changed state of replica 0 for partition [test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-13 16:35:15,302] TRACE Controller 0 epoch 48 changed state of replica 0 for partition [json-topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-13 16:35:15,303] TRACE Controller 0 epoch 48 changed state of replica 0 for partition [log,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-13 16:35:15,303] TRACE Controller 0 epoch 48 changed state of replica 0 for partition [test1,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-13 16:35:15,303] TRACE Controller 0 epoch 48 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:19,ControllerEpoch:47) to broker 0 for partition [test1,0] (state.change.logger)
[2017-12-13 16:35:15,321] TRACE Controller 0 epoch 48 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:18,ControllerEpoch:47) to broker 0 for partition [test3,0] (state.change.logger)
[2017-12-13 16:35:15,321] TRACE Controller 0 epoch 48 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:34,ControllerEpoch:47) to broker 0 for partition [json-topic,0] (state.change.logger)
[2017-12-13 16:35:15,321] TRACE Controller 0 epoch 48 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:41,ControllerEpoch:47) to broker 0 for partition [test,0] (state.change.logger)
[2017-12-13 16:35:15,321] TRACE Controller 0 epoch 48 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:17,ControllerEpoch:47) to broker 0 for partition [log,0] (state.change.logger)
[2017-12-13 16:35:15,357] TRACE Controller 0 epoch 48 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:19,ControllerEpoch:47) to broker 0 for partition test1-0 (state.change.logger)
[2017-12-13 16:35:15,357] TRACE Controller 0 epoch 48 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:18,ControllerEpoch:47) to broker 0 for partition test3-0 (state.change.logger)
[2017-12-13 16:35:15,357] TRACE Controller 0 epoch 48 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:34,ControllerEpoch:47) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-12-13 16:35:15,396] TRACE Controller 0 epoch 48 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:41,ControllerEpoch:47) to broker 0 for partition test-0 (state.change.logger)
[2017-12-13 16:35:15,396] TRACE Controller 0 epoch 48 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:17,ControllerEpoch:47) to broker 0 for partition log-0 (state.change.logger)
[2017-12-13 16:35:15,482] TRACE Controller 0 epoch 48 started leader election for partition [test1,0] (state.change.logger)
[2017-12-13 16:35:15,999] TRACE Controller 0 epoch 48 elected leader 0 for Offline partition [test1,0] (state.change.logger)
[2017-12-13 16:35:15,999] TRACE Controller 0 epoch 48 changed partition [test1,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-13 16:35:16,018] TRACE Controller 0 epoch 48 started leader election for partition [test3,0] (state.change.logger)
[2017-12-13 16:35:17,676] TRACE Controller 0 epoch 48 elected leader 0 for Offline partition [test3,0] (state.change.logger)
[2017-12-13 16:35:17,676] TRACE Controller 0 epoch 48 changed partition [test3,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-13 16:35:17,676] TRACE Controller 0 epoch 48 started leader election for partition [log,0] (state.change.logger)
[2017-12-13 16:35:17,758] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:18,ControllerEpoch:47),ReplicationFactor:1),AllReplicas:0) for partition test3-0 in response to UpdateMetadata request sent by controller 0 epoch 48 with correlation id 0 (state.change.logger)
[2017-12-13 16:35:17,933] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:19,ControllerEpoch:47),ReplicationFactor:1),AllReplicas:0) for partition test1-0 in response to UpdateMetadata request sent by controller 0 epoch 48 with correlation id 0 (state.change.logger)
[2017-12-13 16:35:17,934] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:17,ControllerEpoch:47),ReplicationFactor:1),AllReplicas:0) for partition log-0 in response to UpdateMetadata request sent by controller 0 epoch 48 with correlation id 0 (state.change.logger)
[2017-12-13 16:35:17,935] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:41,ControllerEpoch:47),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 48 with correlation id 0 (state.change.logger)
[2017-12-13 16:35:17,935] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:34,ControllerEpoch:47),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 48 with correlation id 0 (state.change.logger)
[2017-12-13 16:35:17,951] TRACE Controller 0 epoch 48 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-13 16:35:17,984] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=47, leader=0, leaderEpoch=18, isr=[0], zkVersion=18, replicas=[0]) correlation id 1 from controller 0 epoch 48 for partition [test3,0] (state.change.logger)
[2017-12-13 16:35:18,043] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=47, leader=0, leaderEpoch=19, isr=[0], zkVersion=19, replicas=[0]) correlation id 1 from controller 0 epoch 48 for partition [test1,0] (state.change.logger)
[2017-12-13 16:35:18,043] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=47, leader=0, leaderEpoch=17, isr=[0], zkVersion=17, replicas=[0]) correlation id 1 from controller 0 epoch 48 for partition [log,0] (state.change.logger)
[2017-12-13 16:35:18,043] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=47, leader=0, leaderEpoch=41, isr=[0], zkVersion=41, replicas=[0]) correlation id 1 from controller 0 epoch 48 for partition [test,0] (state.change.logger)
[2017-12-13 16:35:18,043] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=47, leader=0, leaderEpoch=34, isr=[0], zkVersion=34, replicas=[0]) correlation id 1 from controller 0 epoch 48 for partition [json-topic,0] (state.change.logger)
[2017-12-13 16:35:18,236] TRACE Controller 0 epoch 48 elected leader 0 for Offline partition [log,0] (state.change.logger)
[2017-12-13 16:35:18,236] TRACE Controller 0 epoch 48 changed partition [log,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-13 16:35:18,237] TRACE Controller 0 epoch 48 started leader election for partition [json-topic,0] (state.change.logger)
[2017-12-13 16:35:18,470] TRACE Controller 0 epoch 48 elected leader 0 for Offline partition [json-topic,0] (state.change.logger)
[2017-12-13 16:35:18,470] TRACE Controller 0 epoch 48 changed partition [json-topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-13 16:35:18,470] TRACE Controller 0 epoch 48 started leader election for partition [test,0] (state.change.logger)
[2017-12-13 16:35:18,626] TRACE Controller 0 epoch 48 elected leader 0 for Offline partition [test,0] (state.change.logger)
[2017-12-13 16:35:18,627] TRACE Controller 0 epoch 48 changed partition [test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-13 16:35:18,627] TRACE Controller 0 epoch 48 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:20,ControllerEpoch:48) to broker 0 for partition [test1,0] (state.change.logger)
[2017-12-13 16:35:18,627] TRACE Controller 0 epoch 48 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:19,ControllerEpoch:48) to broker 0 for partition [test3,0] (state.change.logger)
[2017-12-13 16:35:18,627] TRACE Controller 0 epoch 48 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:42,ControllerEpoch:48) to broker 0 for partition [test,0] (state.change.logger)
[2017-12-13 16:35:18,627] TRACE Controller 0 epoch 48 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:35,ControllerEpoch:48) to broker 0 for partition [json-topic,0] (state.change.logger)
[2017-12-13 16:35:18,627] TRACE Controller 0 epoch 48 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:18,ControllerEpoch:48) to broker 0 for partition [log,0] (state.change.logger)
[2017-12-13 16:35:18,627] TRACE Controller 0 epoch 48 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:20,ControllerEpoch:48) to broker 0 for partition test1-0 (state.change.logger)
[2017-12-13 16:35:18,627] TRACE Controller 0 epoch 48 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:19,ControllerEpoch:48) to broker 0 for partition test3-0 (state.change.logger)
[2017-12-13 16:35:18,627] TRACE Controller 0 epoch 48 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:42,ControllerEpoch:48) to broker 0 for partition test-0 (state.change.logger)
[2017-12-13 16:35:18,627] TRACE Controller 0 epoch 48 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:35,ControllerEpoch:48) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-12-13 16:35:18,627] TRACE Controller 0 epoch 48 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:18,ControllerEpoch:48) to broker 0 for partition log-0 (state.change.logger)
[2017-12-13 16:35:18,920] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 48 for partition [test3,0] since its associated leader epoch 18 is not higher than the current leader epoch 18 (state.change.logger)
[2017-12-13 16:35:18,920] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 48 for partition [test1,0] since its associated leader epoch 19 is not higher than the current leader epoch 19 (state.change.logger)
[2017-12-13 16:35:18,920] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 48 for partition [log,0] since its associated leader epoch 17 is not higher than the current leader epoch 17 (state.change.logger)
[2017-12-13 16:35:18,920] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 48 for partition [test,0] since its associated leader epoch 41 is not higher than the current leader epoch 41 (state.change.logger)
[2017-12-13 16:35:18,920] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 48 for partition [json-topic,0] since its associated leader epoch 34 is not higher than the current leader epoch 34 (state.change.logger)
[2017-12-13 16:35:18,956] TRACE Controller 0 epoch 48 received response {error_code=0,partitions=[{topic=test1,partition=0,error_code=11},{topic=test3,partition=0,error_code=11},{topic=json-topic,partition=0,error_code=11},{topic=test,partition=0,error_code=11},{topic=log,partition=0,error_code=11}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-13 16:35:18,981] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:18,ControllerEpoch:47),ReplicationFactor:1),AllReplicas:0) for partition test3-0 in response to UpdateMetadata request sent by controller 0 epoch 48 with correlation id 2 (state.change.logger)
[2017-12-13 16:35:19,010] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:19,ControllerEpoch:47),ReplicationFactor:1),AllReplicas:0) for partition test1-0 in response to UpdateMetadata request sent by controller 0 epoch 48 with correlation id 2 (state.change.logger)
[2017-12-13 16:35:19,010] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:17,ControllerEpoch:47),ReplicationFactor:1),AllReplicas:0) for partition log-0 in response to UpdateMetadata request sent by controller 0 epoch 48 with correlation id 2 (state.change.logger)
[2017-12-13 16:35:19,010] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:41,ControllerEpoch:47),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 48 with correlation id 2 (state.change.logger)
[2017-12-13 16:35:19,035] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:34,ControllerEpoch:47),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 48 with correlation id 2 (state.change.logger)
[2017-12-13 16:35:19,035] TRACE Controller 0 epoch 48 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-13 16:35:19,040] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=48, leader=0, leaderEpoch=19, isr=[0], zkVersion=19, replicas=[0]) correlation id 3 from controller 0 epoch 48 for partition [test3,0] (state.change.logger)
[2017-12-13 16:35:19,040] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=48, leader=0, leaderEpoch=20, isr=[0], zkVersion=20, replicas=[0]) correlation id 3 from controller 0 epoch 48 for partition [test1,0] (state.change.logger)
[2017-12-13 16:35:19,040] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=48, leader=0, leaderEpoch=18, isr=[0], zkVersion=18, replicas=[0]) correlation id 3 from controller 0 epoch 48 for partition [log,0] (state.change.logger)
[2017-12-13 16:35:19,040] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=48, leader=0, leaderEpoch=42, isr=[0], zkVersion=42, replicas=[0]) correlation id 3 from controller 0 epoch 48 for partition [test,0] (state.change.logger)
[2017-12-13 16:35:19,040] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=48, leader=0, leaderEpoch=35, isr=[0], zkVersion=35, replicas=[0]) correlation id 3 from controller 0 epoch 48 for partition [json-topic,0] (state.change.logger)
[2017-12-13 16:35:19,040] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 48 starting the become-leader transition for partition [test1,0] (state.change.logger)
[2017-12-13 16:35:19,040] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 48 starting the become-leader transition for partition [test3,0] (state.change.logger)
[2017-12-13 16:35:19,041] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 48 starting the become-leader transition for partition [test,0] (state.change.logger)
[2017-12-13 16:35:19,041] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 48 starting the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-12-13 16:35:19,041] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 48 starting the become-leader transition for partition [log,0] (state.change.logger)
[2017-12-13 16:35:19,068] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 48 for partition [test1,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-13 16:35:19,068] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 48 for partition [test3,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-13 16:35:19,068] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 48 for partition [test,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-13 16:35:19,069] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 48 for partition [json-topic,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-13 16:35:19,069] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 48 for partition [log,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-13 16:35:19,069] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 48 for the become-leader transition for partition [test1,0] (state.change.logger)
[2017-12-13 16:35:19,069] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 48 for the become-leader transition for partition [test3,0] (state.change.logger)
[2017-12-13 16:35:19,069] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 48 for the become-leader transition for partition [test,0] (state.change.logger)
[2017-12-13 16:35:19,069] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 48 for the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-12-13 16:35:19,069] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 48 for the become-leader transition for partition [log,0] (state.change.logger)
[2017-12-13 16:35:19,070] TRACE Controller 0 epoch 48 received response {error_code=0,partitions=[{topic=test1,partition=0,error_code=0},{topic=test3,partition=0,error_code=0},{topic=json-topic,partition=0,error_code=0},{topic=test,partition=0,error_code=0},{topic=log,partition=0,error_code=0}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-13 16:35:19,117] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:19,ControllerEpoch:48),ReplicationFactor:1),AllReplicas:0) for partition test3-0 in response to UpdateMetadata request sent by controller 0 epoch 48 with correlation id 4 (state.change.logger)
[2017-12-13 16:35:19,117] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:20,ControllerEpoch:48),ReplicationFactor:1),AllReplicas:0) for partition test1-0 in response to UpdateMetadata request sent by controller 0 epoch 48 with correlation id 4 (state.change.logger)
[2017-12-13 16:35:19,117] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:18,ControllerEpoch:48),ReplicationFactor:1),AllReplicas:0) for partition log-0 in response to UpdateMetadata request sent by controller 0 epoch 48 with correlation id 4 (state.change.logger)
[2017-12-13 16:35:19,117] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:42,ControllerEpoch:48),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 48 with correlation id 4 (state.change.logger)
[2017-12-13 16:35:19,117] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:35,ControllerEpoch:48),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 48 with correlation id 4 (state.change.logger)
[2017-12-13 16:35:19,118] TRACE Controller 0 epoch 48 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
