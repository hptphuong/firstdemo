[2017-11-02 11:02:00,684] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2017-11-02 11:02:58,391] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2017-11-02 11:06:12,726] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2017-11-02 11:07:13,003] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2017-11-02 11:07:57,308] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2017-11-02 11:10:32,066] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2017-11-02 11:15:47,381] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2017-11-02 11:19:09,867] TRACE Controller 0 epoch 4 started leader election for partition [test,0] (state.change.logger)
[2017-11-02 11:19:09,867] ERROR Controller 0 epoch 4 initiated state change for partition [test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-11-02 11:19:10,148] TRACE Controller 0 epoch 4 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:3) to broker 0 for partition test-0 (state.change.logger)
[2017-11-02 11:19:10,192] TRACE Controller 0 epoch 4 changed state of replica 0 for partition [test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-11-02 11:19:10,192] TRACE Controller 0 epoch 4 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:3) to broker 0 for partition [test,0] (state.change.logger)
[2017-11-02 11:19:10,212] TRACE Controller 0 epoch 4 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:3) to broker 0 for partition test-0 (state.change.logger)
[2017-11-02 11:19:10,212] TRACE Controller 0 epoch 4 started leader election for partition [test,0] (state.change.logger)
[2017-11-02 11:19:10,252] TRACE Controller 0 epoch 4 elected leader 0 for Offline partition [test,0] (state.change.logger)
[2017-11-02 11:19:10,252] TRACE Controller 0 epoch 4 changed partition [test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-11-02 11:19:10,252] TRACE Controller 0 epoch 4 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:4) to broker 0 for partition [test,0] (state.change.logger)
[2017-11-02 11:19:10,252] TRACE Controller 0 epoch 4 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:4) to broker 0 for partition test-0 (state.change.logger)
[2017-11-02 11:19:10,272] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:3),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 4 with correlation id 0 (state.change.logger)
[2017-11-02 11:19:10,282] TRACE Controller 0 epoch 4 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-02 11:19:10,314] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=3, leader=0, leaderEpoch=0, isr=[0], zkVersion=0, replicas=[0]) correlation id 1 from controller 0 epoch 4 for partition [test,0] (state.change.logger)
[2017-11-02 11:19:10,331] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 4 starting the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-02 11:19:10,374] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 4 with correlation id 1 for partition [test,0] (state.change.logger)
[2017-11-02 11:19:10,384] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 4 for the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-02 11:19:10,394] TRACE Controller 0 epoch 4 received response {error_code=0,partitions=[{topic=test,partition=0,error_code=0}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-02 11:19:10,394] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:3),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 4 with correlation id 2 (state.change.logger)
[2017-11-02 11:19:10,394] TRACE Controller 0 epoch 4 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-02 11:19:10,394] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=4, leader=0, leaderEpoch=1, isr=[0], zkVersion=1, replicas=[0]) correlation id 3 from controller 0 epoch 4 for partition [test,0] (state.change.logger)
[2017-11-02 11:19:10,394] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 4 starting the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-02 11:19:10,404] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 4 for partition [test,0] since it is already the leader for the partition. (state.change.logger)
[2017-11-02 11:19:10,404] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 4 for the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-02 11:19:10,404] TRACE Controller 0 epoch 4 received response {error_code=0,partitions=[{topic=test,partition=0,error_code=0}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-02 11:19:10,414] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:4),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 4 with correlation id 4 (state.change.logger)
[2017-11-02 11:19:10,414] TRACE Controller 0 epoch 4 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-02 12:10:43,345] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2017-11-02 12:10:46,895] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2017-11-02 13:16:56,078] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2017-11-02 13:20:35,929] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2017-11-02 13:21:15,032] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2017-11-02 13:21:40,929] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2017-11-02 13:22:32,618] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2017-11-02 13:23:26,793] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2017-11-02 13:25:29,859] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2017-11-02 13:25:48,109] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2017-11-02 13:26:00,579] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2017-11-02 13:26:27,646] TRACE Controller 0 epoch 5 started leader election for partition [test,0] (state.change.logger)
[2017-11-02 13:26:27,656] ERROR Controller 0 epoch 5 initiated state change for partition [test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-11-02 13:26:27,981] TRACE Controller 0 epoch 5 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:4) to broker 0 for partition test-0 (state.change.logger)
[2017-11-02 13:26:28,014] TRACE Controller 0 epoch 5 changed state of replica 0 for partition [test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-11-02 13:26:28,014] TRACE Controller 0 epoch 5 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:4) to broker 0 for partition [test,0] (state.change.logger)
[2017-11-02 13:26:28,014] TRACE Controller 0 epoch 5 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:4) to broker 0 for partition test-0 (state.change.logger)
[2017-11-02 13:26:28,014] TRACE Controller 0 epoch 5 started leader election for partition [test,0] (state.change.logger)
[2017-11-02 13:26:28,074] TRACE Controller 0 epoch 5 elected leader 0 for Offline partition [test,0] (state.change.logger)
[2017-11-02 13:26:28,074] TRACE Controller 0 epoch 5 changed partition [test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-11-02 13:26:28,084] TRACE Controller 0 epoch 5 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:2,ControllerEpoch:5) to broker 0 for partition [test,0] (state.change.logger)
[2017-11-02 13:26:28,084] TRACE Controller 0 epoch 5 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:2,ControllerEpoch:5) to broker 0 for partition test-0 (state.change.logger)
[2017-11-02 13:26:28,144] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:4),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 5 with correlation id 0 (state.change.logger)
[2017-11-02 13:26:28,144] TRACE Controller 0 epoch 5 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-02 13:26:28,194] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=4, leader=0, leaderEpoch=1, isr=[0], zkVersion=1, replicas=[0]) correlation id 1 from controller 0 epoch 5 for partition [test,0] (state.change.logger)
[2017-11-02 13:26:28,195] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 5 starting the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-02 13:26:28,210] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 5 with correlation id 1 for partition [test,0] (state.change.logger)
[2017-11-02 13:26:28,211] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 5 for the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-02 13:26:28,239] TRACE Controller 0 epoch 5 received response {error_code=0,partitions=[{topic=test,partition=0,error_code=0}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-02 13:26:28,241] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:4),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 5 with correlation id 2 (state.change.logger)
[2017-11-02 13:26:28,244] TRACE Controller 0 epoch 5 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-02 13:26:28,247] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=5, leader=0, leaderEpoch=2, isr=[0], zkVersion=2, replicas=[0]) correlation id 3 from controller 0 epoch 5 for partition [test,0] (state.change.logger)
[2017-11-02 13:26:28,248] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 5 starting the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-02 13:26:28,279] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 5 for partition [test,0] since it is already the leader for the partition. (state.change.logger)
[2017-11-02 13:26:28,279] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 5 for the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-02 13:26:28,288] TRACE Controller 0 epoch 5 received response {error_code=0,partitions=[{topic=test,partition=0,error_code=0}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-02 13:26:28,296] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:2,ControllerEpoch:5),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 5 with correlation id 4 (state.change.logger)
[2017-11-02 13:26:28,298] TRACE Controller 0 epoch 5 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-02 13:27:30,124] TRACE Controller 0 epoch 6 started leader election for partition [test,0] (state.change.logger)
[2017-11-02 13:27:30,134] ERROR Controller 0 epoch 6 initiated state change for partition [test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-11-02 13:27:30,432] TRACE Controller 0 epoch 6 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:2,ControllerEpoch:5) to broker 0 for partition test-0 (state.change.logger)
[2017-11-02 13:27:30,462] TRACE Controller 0 epoch 6 changed state of replica 0 for partition [test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-11-02 13:27:30,462] TRACE Controller 0 epoch 6 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:2,ControllerEpoch:5) to broker 0 for partition [test,0] (state.change.logger)
[2017-11-02 13:27:30,462] TRACE Controller 0 epoch 6 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:2,ControllerEpoch:5) to broker 0 for partition test-0 (state.change.logger)
[2017-11-02 13:27:30,462] TRACE Controller 0 epoch 6 started leader election for partition [test,0] (state.change.logger)
[2017-11-02 13:27:30,544] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:2,ControllerEpoch:5),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 6 with correlation id 0 (state.change.logger)
[2017-11-02 13:27:30,554] TRACE Controller 0 epoch 6 elected leader 0 for Offline partition [test,0] (state.change.logger)
[2017-11-02 13:27:30,554] TRACE Controller 0 epoch 6 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-02 13:27:30,564] TRACE Controller 0 epoch 6 changed partition [test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-11-02 13:27:30,564] TRACE Controller 0 epoch 6 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:6) to broker 0 for partition [test,0] (state.change.logger)
[2017-11-02 13:27:30,564] TRACE Controller 0 epoch 6 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:6) to broker 0 for partition test-0 (state.change.logger)
[2017-11-02 13:27:30,606] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=5, leader=0, leaderEpoch=2, isr=[0], zkVersion=2, replicas=[0]) correlation id 1 from controller 0 epoch 6 for partition [test,0] (state.change.logger)
[2017-11-02 13:27:30,615] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 6 starting the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-02 13:27:30,656] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 6 with correlation id 1 for partition [test,0] (state.change.logger)
[2017-11-02 13:27:30,656] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 6 for the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-02 13:27:30,667] TRACE Controller 0 epoch 6 received response {error_code=0,partitions=[{topic=test,partition=0,error_code=0}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-02 13:27:30,667] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:2,ControllerEpoch:5),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 6 with correlation id 2 (state.change.logger)
[2017-11-02 13:27:30,667] TRACE Controller 0 epoch 6 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-02 13:27:30,669] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=6, leader=0, leaderEpoch=3, isr=[0], zkVersion=3, replicas=[0]) correlation id 3 from controller 0 epoch 6 for partition [test,0] (state.change.logger)
[2017-11-02 13:27:30,669] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 6 starting the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-02 13:27:30,673] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 6 for partition [test,0] since it is already the leader for the partition. (state.change.logger)
[2017-11-02 13:27:30,674] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 6 for the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-02 13:27:30,679] TRACE Controller 0 epoch 6 received response {error_code=0,partitions=[{topic=test,partition=0,error_code=0}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-02 13:27:30,684] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:6),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 6 with correlation id 4 (state.change.logger)
[2017-11-02 13:27:30,686] TRACE Controller 0 epoch 6 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-02 13:28:37,788] TRACE Controller 0 epoch 7 started leader election for partition [test,0] (state.change.logger)
[2017-11-02 13:28:37,819] ERROR Controller 0 epoch 7 initiated state change for partition [test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-11-02 13:28:37,989] TRACE Controller 0 epoch 7 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:6) to broker 0 for partition test-0 (state.change.logger)
[2017-11-02 13:28:38,014] TRACE Controller 0 epoch 7 changed state of replica 0 for partition [test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-11-02 13:28:38,015] TRACE Controller 0 epoch 7 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:6) to broker 0 for partition [test,0] (state.change.logger)
[2017-11-02 13:28:38,020] TRACE Controller 0 epoch 7 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:6) to broker 0 for partition test-0 (state.change.logger)
[2017-11-02 13:28:38,021] TRACE Controller 0 epoch 7 started leader election for partition [test,0] (state.change.logger)
[2017-11-02 13:28:38,078] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:6),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 7 with correlation id 0 (state.change.logger)
[2017-11-02 13:28:38,086] TRACE Controller 0 epoch 7 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-02 13:28:38,138] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=6, leader=0, leaderEpoch=3, isr=[0], zkVersion=3, replicas=[0]) correlation id 1 from controller 0 epoch 7 for partition [test,0] (state.change.logger)
[2017-11-02 13:28:38,147] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 7 starting the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-02 13:28:38,217] TRACE Controller 0 epoch 7 elected leader 0 for Offline partition [test,0] (state.change.logger)
[2017-11-02 13:28:38,220] TRACE Controller 0 epoch 7 changed partition [test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-11-02 13:28:38,220] TRACE Controller 0 epoch 7 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:7) to broker 0 for partition [test,0] (state.change.logger)
[2017-11-02 13:28:38,220] TRACE Controller 0 epoch 7 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:7) to broker 0 for partition test-0 (state.change.logger)
[2017-11-02 13:28:38,234] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 7 with correlation id 1 for partition [test,0] (state.change.logger)
[2017-11-02 13:28:38,235] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 7 for the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-02 13:28:38,240] TRACE Controller 0 epoch 7 received response {error_code=0,partitions=[{topic=test,partition=0,error_code=0}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-02 13:28:38,244] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:6),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 7 with correlation id 2 (state.change.logger)
[2017-11-02 13:28:38,245] TRACE Controller 0 epoch 7 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-02 13:28:38,246] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=7, leader=0, leaderEpoch=4, isr=[0], zkVersion=4, replicas=[0]) correlation id 3 from controller 0 epoch 7 for partition [test,0] (state.change.logger)
[2017-11-02 13:28:38,247] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 7 starting the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-02 13:28:38,248] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 7 for partition [test,0] since it is already the leader for the partition. (state.change.logger)
[2017-11-02 13:28:38,248] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 7 for the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-02 13:28:38,249] TRACE Controller 0 epoch 7 received response {error_code=0,partitions=[{topic=test,partition=0,error_code=0}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-02 13:28:38,253] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:7),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 7 with correlation id 4 (state.change.logger)
[2017-11-02 13:28:38,256] TRACE Controller 0 epoch 7 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-02 13:29:28,606] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2017-11-02 13:29:29,532] TRACE Controller 0 epoch 8 started leader election for partition [test,0] (state.change.logger)
[2017-11-02 13:29:29,558] ERROR Controller 0 epoch 8 initiated state change for partition [test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-11-02 13:29:29,788] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:7) to broker 0 for partition test-0 (state.change.logger)
[2017-11-02 13:29:29,819] TRACE Controller 0 epoch 8 changed state of replica 0 for partition [test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-11-02 13:29:29,825] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:7) to broker 0 for partition [test,0] (state.change.logger)
[2017-11-02 13:29:29,831] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:7) to broker 0 for partition test-0 (state.change.logger)
[2017-11-02 13:29:29,835] TRACE Controller 0 epoch 8 started leader election for partition [test,0] (state.change.logger)
[2017-11-02 13:29:29,906] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:7),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 0 (state.change.logger)
[2017-11-02 13:29:29,916] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-02 13:29:29,978] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=7, leader=0, leaderEpoch=4, isr=[0], zkVersion=4, replicas=[0]) correlation id 1 from controller 0 epoch 8 for partition [test,0] (state.change.logger)
[2017-11-02 13:29:29,978] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 8 starting the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-02 13:29:30,028] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 8 with correlation id 1 for partition [test,0] (state.change.logger)
[2017-11-02 13:29:30,028] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 8 for the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-02 13:29:30,038] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=test,partition=0,error_code=0}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-02 13:29:30,038] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:7),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 2 (state.change.logger)
[2017-11-02 13:29:30,038] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-02 13:29:30,038] TRACE Controller 0 epoch 8 elected leader 0 for Offline partition [test,0] (state.change.logger)
[2017-11-02 13:29:30,038] TRACE Controller 0 epoch 8 changed partition [test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-11-02 13:29:30,038] TRACE Controller 0 epoch 8 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [test,0] (state.change.logger)
[2017-11-02 13:29:30,048] TRACE Controller 0 epoch 8 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition test-0 (state.change.logger)
[2017-11-02 13:29:30,048] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=5, replicas=[0]) correlation id 3 from controller 0 epoch 8 for partition [test,0] (state.change.logger)
[2017-11-02 13:29:30,048] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 8 starting the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-02 13:29:30,048] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 8 for partition [test,0] since it is already the leader for the partition. (state.change.logger)
[2017-11-02 13:29:30,048] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 8 for the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-02 13:29:30,049] TRACE Controller 0 epoch 8 received response {error_code=0,partitions=[{topic=test,partition=0,error_code=0}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-02 13:29:30,049] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 8 with correlation id 4 (state.change.logger)
[2017-11-02 13:29:30,050] TRACE Controller 0 epoch 8 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-02 13:31:04,216] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2017-11-02 13:35:02,761] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2017-11-02 13:35:03,713] TRACE Controller 0 epoch 9 started leader election for partition [test,0] (state.change.logger)
[2017-11-02 13:35:03,723] ERROR Controller 0 epoch 9 initiated state change for partition [test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-11-02 13:35:03,863] TRACE Controller 0 epoch 9 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition test-0 (state.change.logger)
[2017-11-02 13:35:03,893] TRACE Controller 0 epoch 9 changed state of replica 0 for partition [test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-11-02 13:35:03,893] TRACE Controller 0 epoch 9 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition [test,0] (state.change.logger)
[2017-11-02 13:35:03,893] TRACE Controller 0 epoch 9 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8) to broker 0 for partition test-0 (state.change.logger)
[2017-11-02 13:35:03,903] TRACE Controller 0 epoch 9 started leader election for partition [test,0] (state.change.logger)
[2017-11-02 13:35:03,923] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 0 (state.change.logger)
[2017-11-02 13:35:03,933] TRACE Controller 0 epoch 9 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-02 13:35:03,983] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=8, leader=0, leaderEpoch=5, isr=[0], zkVersion=5, replicas=[0]) correlation id 1 from controller 0 epoch 9 for partition [test,0] (state.change.logger)
[2017-11-02 13:35:03,983] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 9 starting the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-02 13:35:04,003] TRACE Controller 0 epoch 9 elected leader 0 for Offline partition [test,0] (state.change.logger)
[2017-11-02 13:35:04,003] TRACE Controller 0 epoch 9 changed partition [test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-11-02 13:35:04,003] TRACE Controller 0 epoch 9 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:9) to broker 0 for partition [test,0] (state.change.logger)
[2017-11-02 13:35:04,003] TRACE Controller 0 epoch 9 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:9) to broker 0 for partition test-0 (state.change.logger)
[2017-11-02 13:35:04,013] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 9 with correlation id 1 for partition [test,0] (state.change.logger)
[2017-11-02 13:35:04,023] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 9 for the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-02 13:35:04,043] TRACE Controller 0 epoch 9 received response {error_code=0,partitions=[{topic=test,partition=0,error_code=0}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-02 13:35:04,053] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 2 (state.change.logger)
[2017-11-02 13:35:04,053] TRACE Controller 0 epoch 9 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-02 13:35:04,053] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=0, leaderEpoch=6, isr=[0], zkVersion=6, replicas=[0]) correlation id 3 from controller 0 epoch 9 for partition [test,0] (state.change.logger)
[2017-11-02 13:35:04,054] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 9 starting the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-02 13:35:04,054] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 9 for partition [test,0] since it is already the leader for the partition. (state.change.logger)
[2017-11-02 13:35:04,054] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 9 for the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-02 13:35:04,054] TRACE Controller 0 epoch 9 received response {error_code=0,partitions=[{topic=test,partition=0,error_code=0}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-02 13:35:04,063] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 4 (state.change.logger)
[2017-11-02 13:35:04,065] TRACE Controller 0 epoch 9 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-02 13:35:53,251] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2017-11-02 13:38:09,569] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2017-11-02 13:38:11,097] TRACE Controller 0 epoch 10 started leader election for partition [test,0] (state.change.logger)
[2017-11-02 13:38:11,107] ERROR Controller 0 epoch 10 initiated state change for partition [test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-11-02 13:38:11,411] TRACE Controller 0 epoch 10 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:9) to broker 0 for partition test-0 (state.change.logger)
[2017-11-02 13:38:11,441] TRACE Controller 0 epoch 10 changed state of replica 0 for partition [test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-11-02 13:38:11,441] TRACE Controller 0 epoch 10 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:9) to broker 0 for partition [test,0] (state.change.logger)
[2017-11-02 13:38:11,441] TRACE Controller 0 epoch 10 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:9) to broker 0 for partition test-0 (state.change.logger)
[2017-11-02 13:38:11,441] TRACE Controller 0 epoch 10 started leader election for partition [test,0] (state.change.logger)
[2017-11-02 13:38:11,511] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 10 with correlation id 0 (state.change.logger)
[2017-11-02 13:38:11,521] TRACE Controller 0 epoch 10 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-02 13:38:11,531] TRACE Controller 0 epoch 10 elected leader 0 for Offline partition [test,0] (state.change.logger)
[2017-11-02 13:38:11,531] TRACE Controller 0 epoch 10 changed partition [test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-11-02 13:38:11,531] TRACE Controller 0 epoch 10 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:10) to broker 0 for partition [test,0] (state.change.logger)
[2017-11-02 13:38:11,531] TRACE Controller 0 epoch 10 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:10) to broker 0 for partition test-0 (state.change.logger)
[2017-11-02 13:38:11,571] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=9, leader=0, leaderEpoch=6, isr=[0], zkVersion=6, replicas=[0]) correlation id 1 from controller 0 epoch 10 for partition [test,0] (state.change.logger)
[2017-11-02 13:38:11,581] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 10 starting the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-02 13:38:11,601] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 10 with correlation id 1 for partition [test,0] (state.change.logger)
[2017-11-02 13:38:11,601] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 10 for the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-02 13:38:11,611] TRACE Controller 0 epoch 10 received response {error_code=0,partitions=[{topic=test,partition=0,error_code=0}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-02 13:38:11,611] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:9),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 10 with correlation id 2 (state.change.logger)
[2017-11-02 13:38:11,621] TRACE Controller 0 epoch 10 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-02 13:38:11,622] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=0, leaderEpoch=7, isr=[0], zkVersion=7, replicas=[0]) correlation id 3 from controller 0 epoch 10 for partition [test,0] (state.change.logger)
[2017-11-02 13:38:11,622] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 10 starting the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-02 13:38:11,622] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 10 for partition [test,0] since it is already the leader for the partition. (state.change.logger)
[2017-11-02 13:38:11,622] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 10 for the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-02 13:38:11,622] TRACE Controller 0 epoch 10 received response {error_code=0,partitions=[{topic=test,partition=0,error_code=0}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-02 13:38:11,624] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 10 with correlation id 4 (state.change.logger)
[2017-11-02 13:38:11,625] TRACE Controller 0 epoch 10 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-02 16:34:30,700] TRACE Controller 0 epoch 10 changed partition [json-topic,0] state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2017-11-02 16:34:30,720] TRACE Controller 0 epoch 10 changed state of replica 0 for partition [json-topic,0] from NonExistentReplica to NewReplica (state.change.logger)
[2017-11-02 16:34:30,999] TRACE Controller 0 epoch 10 changed partition [json-topic,0] from NewPartition to OnlinePartition with leader 0 (state.change.logger)
[2017-11-02 16:34:30,999] TRACE Controller 0 epoch 10 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:10) to broker 0 for partition [json-topic,0] (state.change.logger)
[2017-11-02 16:34:31,009] TRACE Controller 0 epoch 10 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:10) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-11-02 16:34:31,009] TRACE Controller 0 epoch 10 changed state of replica 0 for partition [json-topic,0] from NewReplica to OnlineReplica (state.change.logger)
[2017-11-02 16:34:31,180] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=0, leaderEpoch=0, isr=[0], zkVersion=0, replicas=[0]) correlation id 5 from controller 0 epoch 10 for partition [json-topic,0] (state.change.logger)
[2017-11-02 16:34:31,272] TRACE Broker 0 handling LeaderAndIsr request correlationId 5 from controller 0 epoch 10 starting the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-11-02 16:34:31,404] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 10 with correlation id 5 for partition [json-topic,0] (state.change.logger)
[2017-11-02 16:34:31,404] TRACE Broker 0 completed LeaderAndIsr request correlationId 5 from controller 0 epoch 10 for the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-11-02 16:34:31,424] TRACE Controller 0 epoch 10 received response {error_code=0,partitions=[{topic=json-topic,partition=0,error_code=0}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-02 16:34:31,434] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:10),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 10 with correlation id 6 (state.change.logger)
[2017-11-02 16:34:31,434] TRACE Controller 0 epoch 10 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-03 13:53:09,065] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2017-11-03 13:53:18,630] TRACE Controller 0 epoch 11 started leader election for partition [json-topic,0] (state.change.logger)
[2017-11-03 13:53:18,648] ERROR Controller 0 epoch 11 initiated state change for partition [json-topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [json-topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:146)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:141)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:141)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener.handleDataDeleted(ZookeeperLeaderElector.scala:141)
	at org.I0Itec.zkclient.ZkClient$9.run(ZkClient.java:824)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-11-03 13:53:18,649] TRACE Controller 0 epoch 11 started leader election for partition [test,0] (state.change.logger)
[2017-11-03 13:53:18,655] ERROR Controller 0 epoch 11 initiated state change for partition [test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:146)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:141)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:141)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener.handleDataDeleted(ZookeeperLeaderElector.scala:141)
	at org.I0Itec.zkclient.ZkClient$9.run(ZkClient.java:824)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-11-08 08:41:27,605] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2017-11-08 08:41:30,978] TRACE Controller 0 epoch 12 started leader election for partition [json-topic,0] (state.change.logger)
[2017-11-08 08:41:31,024] ERROR Controller 0 epoch 12 initiated state change for partition [json-topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [json-topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-11-08 08:41:31,063] TRACE Controller 0 epoch 12 started leader election for partition [test,0] (state.change.logger)
[2017-11-08 08:41:31,110] ERROR Controller 0 epoch 12 initiated state change for partition [test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-11-08 08:41:31,750] TRACE Controller 0 epoch 12 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:10) to broker 0 for partition test-0 (state.change.logger)
[2017-11-08 08:41:31,750] TRACE Controller 0 epoch 12 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:10) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-11-08 08:41:31,807] TRACE Controller 0 epoch 12 changed state of replica 0 for partition [json-topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-11-08 08:41:31,807] TRACE Controller 0 epoch 12 changed state of replica 0 for partition [test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-11-08 08:41:31,808] TRACE Controller 0 epoch 12 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:10) to broker 0 for partition [test,0] (state.change.logger)
[2017-11-08 08:41:31,808] TRACE Controller 0 epoch 12 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:10) to broker 0 for partition [json-topic,0] (state.change.logger)
[2017-11-08 08:41:31,830] TRACE Controller 0 epoch 12 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:10) to broker 0 for partition test-0 (state.change.logger)
[2017-11-08 08:41:31,830] TRACE Controller 0 epoch 12 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:10) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-11-08 08:41:31,830] TRACE Controller 0 epoch 12 started leader election for partition [json-topic,0] (state.change.logger)
[2017-11-08 08:41:31,883] TRACE Controller 0 epoch 12 elected leader 0 for Offline partition [json-topic,0] (state.change.logger)
[2017-11-08 08:41:31,885] TRACE Controller 0 epoch 12 changed partition [json-topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-11-08 08:41:31,886] TRACE Controller 0 epoch 12 started leader election for partition [test,0] (state.change.logger)
[2017-11-08 08:41:31,913] TRACE Controller 0 epoch 12 elected leader 0 for Offline partition [test,0] (state.change.logger)
[2017-11-08 08:41:31,914] TRACE Controller 0 epoch 12 changed partition [test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-11-08 08:41:31,914] TRACE Controller 0 epoch 12 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:12) to broker 0 for partition [test,0] (state.change.logger)
[2017-11-08 08:41:31,914] TRACE Controller 0 epoch 12 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:12) to broker 0 for partition [json-topic,0] (state.change.logger)
[2017-11-08 08:41:31,914] TRACE Controller 0 epoch 12 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:12) to broker 0 for partition test-0 (state.change.logger)
[2017-11-08 08:41:31,914] TRACE Controller 0 epoch 12 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:12) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-11-08 08:41:31,974] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 12 with correlation id 0 (state.change.logger)
[2017-11-08 08:41:31,974] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:10),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 12 with correlation id 0 (state.change.logger)
[2017-11-08 08:41:31,983] TRACE Controller 0 epoch 12 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-08 08:41:32,062] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=0, leaderEpoch=7, isr=[0], zkVersion=7, replicas=[0]) correlation id 1 from controller 0 epoch 12 for partition [test,0] (state.change.logger)
[2017-11-08 08:41:32,063] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=10, leader=0, leaderEpoch=0, isr=[0], zkVersion=0, replicas=[0]) correlation id 1 from controller 0 epoch 12 for partition [json-topic,0] (state.change.logger)
[2017-11-08 08:41:32,084] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 12 starting the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-08 08:41:32,084] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 12 starting the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-11-08 08:41:32,165] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 12 with correlation id 1 for partition [json-topic,0] (state.change.logger)
[2017-11-08 08:41:32,165] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 12 with correlation id 1 for partition [test,0] (state.change.logger)
[2017-11-08 08:41:32,166] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 12 for the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-08 08:41:32,167] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 12 for the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-11-08 08:41:32,193] TRACE Controller 0 epoch 12 received response {error_code=0,partitions=[{topic=json-topic,partition=0,error_code=0},{topic=test,partition=0,error_code=0}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-08 08:41:32,194] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:10),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 12 with correlation id 2 (state.change.logger)
[2017-11-08 08:41:32,194] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:10),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 12 with correlation id 2 (state.change.logger)
[2017-11-08 08:41:32,195] TRACE Controller 0 epoch 12 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-08 08:41:32,196] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=12, leader=0, leaderEpoch=8, isr=[0], zkVersion=8, replicas=[0]) correlation id 3 from controller 0 epoch 12 for partition [test,0] (state.change.logger)
[2017-11-08 08:41:32,196] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=12, leader=0, leaderEpoch=1, isr=[0], zkVersion=1, replicas=[0]) correlation id 3 from controller 0 epoch 12 for partition [json-topic,0] (state.change.logger)
[2017-11-08 08:41:32,197] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 12 starting the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-08 08:41:32,197] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 12 starting the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-11-08 08:41:32,199] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 12 for partition [test,0] since it is already the leader for the partition. (state.change.logger)
[2017-11-08 08:41:32,200] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 12 for partition [json-topic,0] since it is already the leader for the partition. (state.change.logger)
[2017-11-08 08:41:32,200] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 12 for the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-08 08:41:32,201] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 12 for the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-11-08 08:41:32,202] TRACE Controller 0 epoch 12 received response {error_code=0,partitions=[{topic=json-topic,partition=0,error_code=0},{topic=test,partition=0,error_code=0}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-08 08:41:32,206] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:12),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 12 with correlation id 4 (state.change.logger)
[2017-11-08 08:41:32,207] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:12),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 12 with correlation id 4 (state.change.logger)
[2017-11-08 08:41:32,208] TRACE Controller 0 epoch 12 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-09 12:42:37,122] TRACE Controller 0 epoch 13 started leader election for partition [json-topic,0] (state.change.logger)
[2017-11-09 12:42:37,845] ERROR Controller 0 epoch 13 initiated state change for partition [json-topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [json-topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1168)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1166)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-11-09 12:42:37,952] TRACE Controller 0 epoch 13 started leader election for partition [test,0] (state.change.logger)
[2017-11-09 12:42:38,002] ERROR Controller 0 epoch 13 initiated state change for partition [test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1168)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1166)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-11-09 12:42:39,300] TRACE Controller 0 epoch 13 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:12) to broker 0 for partition test-0 (state.change.logger)
[2017-11-09 12:42:39,300] TRACE Controller 0 epoch 13 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:12) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-11-09 12:42:39,363] TRACE Controller 0 epoch 13 changed state of replica 0 for partition [json-topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-11-09 12:42:39,363] TRACE Controller 0 epoch 13 changed state of replica 0 for partition [test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-11-09 12:42:39,363] TRACE Controller 0 epoch 13 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:12) to broker 0 for partition [test,0] (state.change.logger)
[2017-11-09 12:42:39,363] TRACE Controller 0 epoch 13 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:12) to broker 0 for partition [json-topic,0] (state.change.logger)
[2017-11-09 12:42:39,364] TRACE Controller 0 epoch 13 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:12) to broker 0 for partition test-0 (state.change.logger)
[2017-11-09 12:42:39,364] TRACE Controller 0 epoch 13 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:12) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-11-09 12:42:39,364] TRACE Controller 0 epoch 13 started leader election for partition [json-topic,0] (state.change.logger)
[2017-11-09 12:42:39,426] TRACE Controller 0 epoch 13 elected leader 0 for Offline partition [json-topic,0] (state.change.logger)
[2017-11-09 12:42:39,448] TRACE Controller 0 epoch 13 changed partition [json-topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-11-09 12:42:39,448] TRACE Controller 0 epoch 13 started leader election for partition [test,0] (state.change.logger)
[2017-11-09 12:42:39,534] TRACE Controller 0 epoch 13 elected leader 0 for Offline partition [test,0] (state.change.logger)
[2017-11-09 12:42:39,534] TRACE Controller 0 epoch 13 changed partition [test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-11-09 12:42:39,534] TRACE Controller 0 epoch 13 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:13) to broker 0 for partition [test,0] (state.change.logger)
[2017-11-09 12:42:39,535] TRACE Controller 0 epoch 13 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:2,ControllerEpoch:13) to broker 0 for partition [json-topic,0] (state.change.logger)
[2017-11-09 12:42:39,535] TRACE Controller 0 epoch 13 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:13) to broker 0 for partition test-0 (state.change.logger)
[2017-11-09 12:42:39,535] TRACE Controller 0 epoch 13 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:2,ControllerEpoch:13) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-11-09 12:42:39,831] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:12),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 13 with correlation id 0 (state.change.logger)
[2017-11-09 12:42:39,831] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:12),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 13 with correlation id 0 (state.change.logger)
[2017-11-09 12:42:39,872] TRACE Controller 0 epoch 13 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-09 12:42:39,983] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=12, leader=0, leaderEpoch=8, isr=[0], zkVersion=8, replicas=[0]) correlation id 1 from controller 0 epoch 13 for partition [test,0] (state.change.logger)
[2017-11-09 12:42:39,984] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=12, leader=0, leaderEpoch=1, isr=[0], zkVersion=1, replicas=[0]) correlation id 1 from controller 0 epoch 13 for partition [json-topic,0] (state.change.logger)
[2017-11-09 12:42:40,143] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition [test,0] since its associated leader epoch 8 is not higher than the current leader epoch 8 (state.change.logger)
[2017-11-09 12:42:40,143] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 13 for partition [json-topic,0] since its associated leader epoch 1 is not higher than the current leader epoch 1 (state.change.logger)
[2017-11-09 12:42:40,179] TRACE Controller 0 epoch 13 received response {error_code=0,partitions=[{topic=json-topic,partition=0,error_code=11},{topic=test,partition=0,error_code=11}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-09 12:42:40,184] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:12),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 13 with correlation id 2 (state.change.logger)
[2017-11-09 12:42:40,184] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:12),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 13 with correlation id 2 (state.change.logger)
[2017-11-09 12:42:40,185] TRACE Controller 0 epoch 13 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-09 12:42:40,185] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=0, leaderEpoch=9, isr=[0], zkVersion=9, replicas=[0]) correlation id 3 from controller 0 epoch 13 for partition [test,0] (state.change.logger)
[2017-11-09 12:42:40,185] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=0, leaderEpoch=2, isr=[0], zkVersion=2, replicas=[0]) correlation id 3 from controller 0 epoch 13 for partition [json-topic,0] (state.change.logger)
[2017-11-09 12:42:40,211] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 13 starting the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-09 12:42:40,211] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 13 starting the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-11-09 12:42:40,232] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 13 for partition [test,0] since it is already the leader for the partition. (state.change.logger)
[2017-11-09 12:42:40,233] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 13 for partition [json-topic,0] since it is already the leader for the partition. (state.change.logger)
[2017-11-09 12:42:40,264] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 13 for the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-09 12:42:40,264] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 13 for the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-11-09 12:42:40,290] TRACE Controller 0 epoch 13 received response {error_code=0,partitions=[{topic=json-topic,partition=0,error_code=0},{topic=test,partition=0,error_code=0}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-09 12:42:40,391] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:13),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 13 with correlation id 4 (state.change.logger)
[2017-11-09 12:42:40,391] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:2,ControllerEpoch:13),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 13 with correlation id 4 (state.change.logger)
[2017-11-09 12:42:40,394] TRACE Controller 0 epoch 13 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-15 16:39:13,405] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2017-11-15 16:45:42,006] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2017-11-15 16:46:46,103] TRACE Controller 0 epoch 14 started leader election for partition [json-topic,0] (state.change.logger)
[2017-11-15 16:46:46,113] ERROR Controller 0 epoch 14 initiated state change for partition [json-topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [json-topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-11-15 16:46:46,146] TRACE Controller 0 epoch 14 started leader election for partition [test,0] (state.change.logger)
[2017-11-15 16:46:46,156] ERROR Controller 0 epoch 14 initiated state change for partition [test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-11-15 16:46:49,866] TRACE Controller 0 epoch 14 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:13) to broker 0 for partition test-0 (state.change.logger)
[2017-11-15 16:46:49,866] TRACE Controller 0 epoch 14 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:2,ControllerEpoch:13) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-11-15 16:46:50,456] TRACE Controller 0 epoch 14 changed state of replica 0 for partition [json-topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-11-15 16:46:50,457] TRACE Controller 0 epoch 14 changed state of replica 0 for partition [test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-11-15 16:46:50,546] TRACE Controller 0 epoch 14 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:13) to broker 0 for partition [test,0] (state.change.logger)
[2017-11-15 16:46:50,546] TRACE Controller 0 epoch 14 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:2,ControllerEpoch:13) to broker 0 for partition [json-topic,0] (state.change.logger)
[2017-11-15 16:46:50,936] TRACE Controller 0 epoch 14 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:13) to broker 0 for partition test-0 (state.change.logger)
[2017-11-15 16:46:50,936] TRACE Controller 0 epoch 14 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:2,ControllerEpoch:13) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-11-15 16:46:50,936] TRACE Controller 0 epoch 14 started leader election for partition [json-topic,0] (state.change.logger)
[2017-11-15 16:46:51,073] TRACE Controller 0 epoch 14 elected leader 0 for Offline partition [json-topic,0] (state.change.logger)
[2017-11-15 16:46:51,080] TRACE Controller 0 epoch 14 changed partition [json-topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-11-15 16:46:51,081] TRACE Controller 0 epoch 14 started leader election for partition [test,0] (state.change.logger)
[2017-11-15 16:46:51,152] TRACE Controller 0 epoch 14 elected leader 0 for Offline partition [test,0] (state.change.logger)
[2017-11-15 16:46:51,152] TRACE Controller 0 epoch 14 changed partition [test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-11-15 16:46:51,152] TRACE Controller 0 epoch 14 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:10,ControllerEpoch:14) to broker 0 for partition [test,0] (state.change.logger)
[2017-11-15 16:46:51,162] TRACE Controller 0 epoch 14 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:14) to broker 0 for partition [json-topic,0] (state.change.logger)
[2017-11-15 16:46:51,162] TRACE Controller 0 epoch 14 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:10,ControllerEpoch:14) to broker 0 for partition test-0 (state.change.logger)
[2017-11-15 16:46:51,162] TRACE Controller 0 epoch 14 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:14) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-11-15 16:46:51,326] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:13),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 0 (state.change.logger)
[2017-11-15 16:46:51,326] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:2,ControllerEpoch:13),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 0 (state.change.logger)
[2017-11-15 16:46:51,332] TRACE Controller 0 epoch 14 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-15 16:46:51,380] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=0, leaderEpoch=9, isr=[0], zkVersion=9, replicas=[0]) correlation id 1 from controller 0 epoch 14 for partition [test,0] (state.change.logger)
[2017-11-15 16:46:51,380] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=0, leaderEpoch=2, isr=[0], zkVersion=2, replicas=[0]) correlation id 1 from controller 0 epoch 14 for partition [json-topic,0] (state.change.logger)
[2017-11-15 16:46:51,421] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 14 starting the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-15 16:46:51,421] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 14 starting the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-11-15 16:46:51,449] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 14 with correlation id 1 for partition [json-topic,0] (state.change.logger)
[2017-11-15 16:46:51,449] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 14 with correlation id 1 for partition [test,0] (state.change.logger)
[2017-11-15 16:46:51,450] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 14 for the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-15 16:46:51,450] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 14 for the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-11-15 16:46:51,460] TRACE Controller 0 epoch 14 received response {error_code=0,partitions=[{topic=json-topic,partition=0,error_code=0},{topic=test,partition=0,error_code=0}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-15 16:46:51,462] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:13),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 2 (state.change.logger)
[2017-11-15 16:46:51,466] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:2,ControllerEpoch:13),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 2 (state.change.logger)
[2017-11-15 16:46:51,468] TRACE Controller 0 epoch 14 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-15 16:46:51,472] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=14, leader=0, leaderEpoch=10, isr=[0], zkVersion=10, replicas=[0]) correlation id 3 from controller 0 epoch 14 for partition [test,0] (state.change.logger)
[2017-11-15 16:46:51,472] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=14, leader=0, leaderEpoch=3, isr=[0], zkVersion=3, replicas=[0]) correlation id 3 from controller 0 epoch 14 for partition [json-topic,0] (state.change.logger)
[2017-11-15 16:46:51,472] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 14 starting the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-15 16:46:51,473] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 14 starting the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-11-15 16:46:51,474] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 14 for partition [test,0] since it is already the leader for the partition. (state.change.logger)
[2017-11-15 16:46:51,475] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 14 for partition [json-topic,0] since it is already the leader for the partition. (state.change.logger)
[2017-11-15 16:46:51,475] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 14 for the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-15 16:46:51,475] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 14 for the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-11-15 16:46:51,476] TRACE Controller 0 epoch 14 received response {error_code=0,partitions=[{topic=json-topic,partition=0,error_code=0},{topic=test,partition=0,error_code=0}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-15 16:46:51,477] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:10,ControllerEpoch:14),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 4 (state.change.logger)
[2017-11-15 16:46:51,478] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:14),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 4 (state.change.logger)
[2017-11-15 16:46:51,478] TRACE Controller 0 epoch 14 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
