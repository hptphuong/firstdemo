[2017-11-16 13:15:59,280] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2017-11-16 13:16:01,766] TRACE Controller 0 epoch 15 started leader election for partition [json-topic,0] (state.change.logger)
[2017-11-16 13:16:01,788] ERROR Controller 0 epoch 15 initiated state change for partition [json-topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [json-topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-11-16 13:16:01,822] TRACE Controller 0 epoch 15 started leader election for partition [test,0] (state.change.logger)
[2017-11-16 13:16:01,850] ERROR Controller 0 epoch 15 initiated state change for partition [test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-11-16 13:16:02,317] TRACE Controller 0 epoch 15 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:10,ControllerEpoch:14) to broker 0 for partition test-0 (state.change.logger)
[2017-11-16 13:16:02,318] TRACE Controller 0 epoch 15 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:14) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-11-16 13:16:02,395] TRACE Controller 0 epoch 15 changed state of replica 0 for partition [json-topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-11-16 13:16:02,398] TRACE Controller 0 epoch 15 changed state of replica 0 for partition [test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-11-16 13:16:02,400] TRACE Controller 0 epoch 15 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:10,ControllerEpoch:14) to broker 0 for partition [test,0] (state.change.logger)
[2017-11-16 13:16:02,401] TRACE Controller 0 epoch 15 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:14) to broker 0 for partition [json-topic,0] (state.change.logger)
[2017-11-16 13:16:02,405] TRACE Controller 0 epoch 15 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:10,ControllerEpoch:14) to broker 0 for partition test-0 (state.change.logger)
[2017-11-16 13:16:02,405] TRACE Controller 0 epoch 15 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:14) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-11-16 13:16:02,406] TRACE Controller 0 epoch 15 started leader election for partition [json-topic,0] (state.change.logger)
[2017-11-16 13:16:02,466] TRACE Controller 0 epoch 15 elected leader 0 for Offline partition [json-topic,0] (state.change.logger)
[2017-11-16 13:16:02,471] TRACE Controller 0 epoch 15 changed partition [json-topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-11-16 13:16:02,471] TRACE Controller 0 epoch 15 started leader election for partition [test,0] (state.change.logger)
[2017-11-16 13:16:02,510] TRACE Controller 0 epoch 15 elected leader 0 for Offline partition [test,0] (state.change.logger)
[2017-11-16 13:16:02,520] TRACE Controller 0 epoch 15 changed partition [test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-11-16 13:16:02,520] TRACE Controller 0 epoch 15 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:11,ControllerEpoch:15) to broker 0 for partition [test,0] (state.change.logger)
[2017-11-16 13:16:02,520] TRACE Controller 0 epoch 15 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:15) to broker 0 for partition [json-topic,0] (state.change.logger)
[2017-11-16 13:16:02,530] TRACE Controller 0 epoch 15 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:11,ControllerEpoch:15) to broker 0 for partition test-0 (state.change.logger)
[2017-11-16 13:16:02,530] TRACE Controller 0 epoch 15 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:15) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-11-16 13:16:02,530] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:10,ControllerEpoch:14),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 15 with correlation id 0 (state.change.logger)
[2017-11-16 13:16:02,530] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:14),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 15 with correlation id 0 (state.change.logger)
[2017-11-16 13:16:02,540] TRACE Controller 0 epoch 15 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-16 13:16:02,581] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=14, leader=0, leaderEpoch=10, isr=[0], zkVersion=10, replicas=[0]) correlation id 1 from controller 0 epoch 15 for partition [test,0] (state.change.logger)
[2017-11-16 13:16:02,581] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=14, leader=0, leaderEpoch=3, isr=[0], zkVersion=3, replicas=[0]) correlation id 1 from controller 0 epoch 15 for partition [json-topic,0] (state.change.logger)
[2017-11-16 13:16:02,589] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 15 starting the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-16 13:16:02,589] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 15 starting the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-11-16 13:16:02,608] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 15 with correlation id 1 for partition [json-topic,0] (state.change.logger)
[2017-11-16 13:16:02,609] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 15 with correlation id 1 for partition [test,0] (state.change.logger)
[2017-11-16 13:16:02,610] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 15 for the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-16 13:16:02,610] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 15 for the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-11-16 13:16:02,617] TRACE Controller 0 epoch 15 received response {error_code=0,partitions=[{topic=json-topic,partition=0,error_code=0},{topic=test,partition=0,error_code=0}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-16 13:16:02,618] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:10,ControllerEpoch:14),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 15 with correlation id 2 (state.change.logger)
[2017-11-16 13:16:02,618] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:14),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 15 with correlation id 2 (state.change.logger)
[2017-11-16 13:16:02,619] TRACE Controller 0 epoch 15 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-16 13:16:02,621] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=15, leader=0, leaderEpoch=11, isr=[0], zkVersion=11, replicas=[0]) correlation id 3 from controller 0 epoch 15 for partition [test,0] (state.change.logger)
[2017-11-16 13:16:02,621] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=15, leader=0, leaderEpoch=4, isr=[0], zkVersion=4, replicas=[0]) correlation id 3 from controller 0 epoch 15 for partition [json-topic,0] (state.change.logger)
[2017-11-16 13:16:02,621] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 15 starting the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-16 13:16:02,621] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 15 starting the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-11-16 13:16:02,623] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 15 for partition [test,0] since it is already the leader for the partition. (state.change.logger)
[2017-11-16 13:16:02,623] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 15 for partition [json-topic,0] since it is already the leader for the partition. (state.change.logger)
[2017-11-16 13:16:02,623] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 15 for the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-16 13:16:02,623] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 15 for the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-11-16 13:16:02,625] TRACE Controller 0 epoch 15 received response {error_code=0,partitions=[{topic=json-topic,partition=0,error_code=0},{topic=test,partition=0,error_code=0}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-16 13:16:02,626] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:11,ControllerEpoch:15),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 15 with correlation id 4 (state.change.logger)
[2017-11-16 13:16:02,626] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:15),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 15 with correlation id 4 (state.change.logger)
[2017-11-16 13:16:02,627] TRACE Controller 0 epoch 15 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-20 08:34:10,392] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2017-11-20 08:55:10,608] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2017-11-20 08:56:04,800] TRACE Controller 0 epoch 16 started leader election for partition [json-topic,0] (state.change.logger)
[2017-11-20 08:56:04,820] ERROR Controller 0 epoch 16 initiated state change for partition [json-topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [json-topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-11-20 08:56:04,850] TRACE Controller 0 epoch 16 started leader election for partition [test,0] (state.change.logger)
[2017-11-20 08:56:04,860] ERROR Controller 0 epoch 16 initiated state change for partition [test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-11-20 08:56:05,222] TRACE Controller 0 epoch 16 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:11,ControllerEpoch:15) to broker 0 for partition test-0 (state.change.logger)
[2017-11-20 08:56:05,222] TRACE Controller 0 epoch 16 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:15) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-11-20 08:56:05,262] TRACE Controller 0 epoch 16 changed state of replica 0 for partition [json-topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-11-20 08:56:05,262] TRACE Controller 0 epoch 16 changed state of replica 0 for partition [test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-11-20 08:56:05,262] TRACE Controller 0 epoch 16 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:11,ControllerEpoch:15) to broker 0 for partition [test,0] (state.change.logger)
[2017-11-20 08:56:05,262] TRACE Controller 0 epoch 16 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:15) to broker 0 for partition [json-topic,0] (state.change.logger)
[2017-11-20 08:56:05,272] TRACE Controller 0 epoch 16 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:11,ControllerEpoch:15) to broker 0 for partition test-0 (state.change.logger)
[2017-11-20 08:56:05,272] TRACE Controller 0 epoch 16 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:15) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-11-20 08:56:05,272] TRACE Controller 0 epoch 16 started leader election for partition [json-topic,0] (state.change.logger)
[2017-11-20 08:56:05,342] TRACE Controller 0 epoch 16 elected leader 0 for Offline partition [json-topic,0] (state.change.logger)
[2017-11-20 08:56:05,342] TRACE Controller 0 epoch 16 changed partition [json-topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-11-20 08:56:05,342] TRACE Controller 0 epoch 16 started leader election for partition [test,0] (state.change.logger)
[2017-11-20 08:56:05,382] TRACE Controller 0 epoch 16 elected leader 0 for Offline partition [test,0] (state.change.logger)
[2017-11-20 08:56:05,382] TRACE Controller 0 epoch 16 changed partition [test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-11-20 08:56:05,382] TRACE Controller 0 epoch 16 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:12,ControllerEpoch:16) to broker 0 for partition [test,0] (state.change.logger)
[2017-11-20 08:56:05,382] TRACE Controller 0 epoch 16 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:16) to broker 0 for partition [json-topic,0] (state.change.logger)
[2017-11-20 08:56:05,382] TRACE Controller 0 epoch 16 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:12,ControllerEpoch:16) to broker 0 for partition test-0 (state.change.logger)
[2017-11-20 08:56:05,382] TRACE Controller 0 epoch 16 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:16) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-11-20 08:56:05,382] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:11,ControllerEpoch:15),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 16 with correlation id 0 (state.change.logger)
[2017-11-20 08:56:05,382] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:15),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 16 with correlation id 0 (state.change.logger)
[2017-11-20 08:56:05,392] TRACE Controller 0 epoch 16 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-20 08:56:05,422] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=15, leader=0, leaderEpoch=11, isr=[0], zkVersion=11, replicas=[0]) correlation id 1 from controller 0 epoch 16 for partition [test,0] (state.change.logger)
[2017-11-20 08:56:05,422] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=15, leader=0, leaderEpoch=4, isr=[0], zkVersion=4, replicas=[0]) correlation id 1 from controller 0 epoch 16 for partition [json-topic,0] (state.change.logger)
[2017-11-20 08:56:05,432] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 16 starting the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-20 08:56:05,432] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 16 starting the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-11-20 08:56:05,452] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 16 with correlation id 1 for partition [json-topic,0] (state.change.logger)
[2017-11-20 08:56:05,452] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 16 with correlation id 1 for partition [test,0] (state.change.logger)
[2017-11-20 08:56:05,452] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 16 for the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-20 08:56:05,452] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 16 for the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-11-20 08:56:05,452] TRACE Controller 0 epoch 16 received response {error_code=0,partitions=[{topic=json-topic,partition=0,error_code=0},{topic=test,partition=0,error_code=0}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-20 08:56:05,452] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:11,ControllerEpoch:15),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 16 with correlation id 2 (state.change.logger)
[2017-11-20 08:56:05,452] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:15),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 16 with correlation id 2 (state.change.logger)
[2017-11-20 08:56:05,462] TRACE Controller 0 epoch 16 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-20 08:56:05,462] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=16, leader=0, leaderEpoch=12, isr=[0], zkVersion=12, replicas=[0]) correlation id 3 from controller 0 epoch 16 for partition [test,0] (state.change.logger)
[2017-11-20 08:56:05,462] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=16, leader=0, leaderEpoch=5, isr=[0], zkVersion=5, replicas=[0]) correlation id 3 from controller 0 epoch 16 for partition [json-topic,0] (state.change.logger)
[2017-11-20 08:56:05,462] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 16 starting the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-20 08:56:05,462] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 16 starting the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-11-20 08:56:05,462] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 16 for partition [test,0] since it is already the leader for the partition. (state.change.logger)
[2017-11-20 08:56:05,462] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 16 for partition [json-topic,0] since it is already the leader for the partition. (state.change.logger)
[2017-11-20 08:56:05,462] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 16 for the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-20 08:56:05,462] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 16 for the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-11-20 08:56:05,462] TRACE Controller 0 epoch 16 received response {error_code=0,partitions=[{topic=json-topic,partition=0,error_code=0},{topic=test,partition=0,error_code=0}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-20 08:56:05,462] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:12,ControllerEpoch:16),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 16 with correlation id 4 (state.change.logger)
[2017-11-20 08:56:05,462] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:16),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 16 with correlation id 4 (state.change.logger)
[2017-11-20 08:56:05,462] TRACE Controller 0 epoch 16 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-21 09:53:22,439] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2017-11-21 09:53:29,148] TRACE Controller 0 epoch 17 started leader election for partition [json-topic,0] (state.change.logger)
[2017-11-21 09:53:29,217] ERROR Controller 0 epoch 17 initiated state change for partition [json-topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [json-topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-11-21 09:53:29,766] TRACE Controller 0 epoch 17 started leader election for partition [test,0] (state.change.logger)
[2017-11-21 09:53:29,788] ERROR Controller 0 epoch 17 initiated state change for partition [test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-11-21 09:53:31,918] TRACE Controller 0 epoch 17 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:12,ControllerEpoch:16) to broker 0 for partition test-0 (state.change.logger)
[2017-11-21 09:53:31,918] TRACE Controller 0 epoch 17 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:16) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-11-21 09:53:31,998] TRACE Controller 0 epoch 17 changed state of replica 0 for partition [json-topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-11-21 09:53:31,998] TRACE Controller 0 epoch 17 changed state of replica 0 for partition [test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-11-21 09:53:32,006] TRACE Controller 0 epoch 17 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:12,ControllerEpoch:16) to broker 0 for partition [test,0] (state.change.logger)
[2017-11-21 09:53:32,007] TRACE Controller 0 epoch 17 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:16) to broker 0 for partition [json-topic,0] (state.change.logger)
[2017-11-21 09:53:32,040] TRACE Controller 0 epoch 17 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:12,ControllerEpoch:16) to broker 0 for partition test-0 (state.change.logger)
[2017-11-21 09:53:32,040] TRACE Controller 0 epoch 17 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:16) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-11-21 09:53:32,041] TRACE Controller 0 epoch 17 started leader election for partition [json-topic,0] (state.change.logger)
[2017-11-21 09:53:32,161] TRACE Controller 0 epoch 17 elected leader 0 for Offline partition [json-topic,0] (state.change.logger)
[2017-11-21 09:53:32,204] TRACE Controller 0 epoch 17 changed partition [json-topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-11-21 09:53:32,204] TRACE Controller 0 epoch 17 started leader election for partition [test,0] (state.change.logger)
[2017-11-21 09:53:32,265] TRACE Controller 0 epoch 17 elected leader 0 for Offline partition [test,0] (state.change.logger)
[2017-11-21 09:53:32,266] TRACE Controller 0 epoch 17 changed partition [test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-11-21 09:53:32,267] TRACE Controller 0 epoch 17 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:13,ControllerEpoch:17) to broker 0 for partition [test,0] (state.change.logger)
[2017-11-21 09:53:32,267] TRACE Controller 0 epoch 17 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:17) to broker 0 for partition [json-topic,0] (state.change.logger)
[2017-11-21 09:53:32,267] TRACE Controller 0 epoch 17 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:13,ControllerEpoch:17) to broker 0 for partition test-0 (state.change.logger)
[2017-11-21 09:53:32,268] TRACE Controller 0 epoch 17 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:17) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-11-21 09:53:32,377] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:12,ControllerEpoch:16),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 17 with correlation id 0 (state.change.logger)
[2017-11-21 09:53:32,377] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:16),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 17 with correlation id 0 (state.change.logger)
[2017-11-21 09:53:32,381] TRACE Controller 0 epoch 17 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-21 09:53:32,429] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=16, leader=0, leaderEpoch=12, isr=[0], zkVersion=12, replicas=[0]) correlation id 1 from controller 0 epoch 17 for partition [test,0] (state.change.logger)
[2017-11-21 09:53:32,430] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=16, leader=0, leaderEpoch=5, isr=[0], zkVersion=5, replicas=[0]) correlation id 1 from controller 0 epoch 17 for partition [json-topic,0] (state.change.logger)
[2017-11-21 09:53:32,504] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 17 starting the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-21 09:53:32,504] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 17 starting the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-11-21 09:53:32,549] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 17 with correlation id 1 for partition [json-topic,0] (state.change.logger)
[2017-11-21 09:53:32,549] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 17 with correlation id 1 for partition [test,0] (state.change.logger)
[2017-11-21 09:53:32,550] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 17 for the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-21 09:53:32,550] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 17 for the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-11-21 09:53:32,556] TRACE Controller 0 epoch 17 received response {error_code=0,partitions=[{topic=json-topic,partition=0,error_code=0},{topic=test,partition=0,error_code=0}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-21 09:53:32,557] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:12,ControllerEpoch:16),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 17 with correlation id 2 (state.change.logger)
[2017-11-21 09:53:32,557] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:16),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 17 with correlation id 2 (state.change.logger)
[2017-11-21 09:53:32,558] TRACE Controller 0 epoch 17 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-21 09:53:32,558] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=17, leader=0, leaderEpoch=13, isr=[0], zkVersion=13, replicas=[0]) correlation id 3 from controller 0 epoch 17 for partition [test,0] (state.change.logger)
[2017-11-21 09:53:32,559] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=17, leader=0, leaderEpoch=6, isr=[0], zkVersion=6, replicas=[0]) correlation id 3 from controller 0 epoch 17 for partition [json-topic,0] (state.change.logger)
[2017-11-21 09:53:32,559] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 17 starting the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-21 09:53:32,559] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 17 starting the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-11-21 09:53:32,560] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 17 for partition [test,0] since it is already the leader for the partition. (state.change.logger)
[2017-11-21 09:53:32,560] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 17 for partition [json-topic,0] since it is already the leader for the partition. (state.change.logger)
[2017-11-21 09:53:32,560] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 17 for the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-21 09:53:32,560] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 17 for the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-11-21 09:53:32,561] TRACE Controller 0 epoch 17 received response {error_code=0,partitions=[{topic=json-topic,partition=0,error_code=0},{topic=test,partition=0,error_code=0}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-21 09:53:32,564] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:13,ControllerEpoch:17),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 17 with correlation id 4 (state.change.logger)
[2017-11-21 09:53:32,564] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:17),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 17 with correlation id 4 (state.change.logger)
[2017-11-21 09:53:32,565] TRACE Controller 0 epoch 17 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-22 11:18:23,159] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2017-11-22 11:19:55,902] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2017-11-22 11:19:56,958] TRACE Controller 0 epoch 18 started leader election for partition [json-topic,0] (state.change.logger)
[2017-11-22 11:19:56,969] ERROR Controller 0 epoch 18 initiated state change for partition [json-topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [json-topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-11-22 11:19:56,970] TRACE Controller 0 epoch 18 started leader election for partition [test,0] (state.change.logger)
[2017-11-22 11:19:56,987] ERROR Controller 0 epoch 18 initiated state change for partition [test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-11-22 11:19:57,288] TRACE Controller 0 epoch 18 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:13,ControllerEpoch:17) to broker 0 for partition test-0 (state.change.logger)
[2017-11-22 11:19:57,289] TRACE Controller 0 epoch 18 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:17) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-11-22 11:19:57,347] TRACE Controller 0 epoch 18 changed state of replica 0 for partition [json-topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-11-22 11:19:57,348] TRACE Controller 0 epoch 18 changed state of replica 0 for partition [test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-11-22 11:19:57,349] TRACE Controller 0 epoch 18 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:13,ControllerEpoch:17) to broker 0 for partition [test,0] (state.change.logger)
[2017-11-22 11:19:57,349] TRACE Controller 0 epoch 18 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:17) to broker 0 for partition [json-topic,0] (state.change.logger)
[2017-11-22 11:19:57,351] TRACE Controller 0 epoch 18 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:13,ControllerEpoch:17) to broker 0 for partition test-0 (state.change.logger)
[2017-11-22 11:19:57,351] TRACE Controller 0 epoch 18 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:17) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-11-22 11:19:57,352] TRACE Controller 0 epoch 18 started leader election for partition [json-topic,0] (state.change.logger)
[2017-11-22 11:19:57,382] TRACE Controller 0 epoch 18 elected leader 0 for Offline partition [json-topic,0] (state.change.logger)
[2017-11-22 11:19:57,384] TRACE Controller 0 epoch 18 changed partition [json-topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-11-22 11:19:57,386] TRACE Controller 0 epoch 18 started leader election for partition [test,0] (state.change.logger)
[2017-11-22 11:19:57,444] TRACE Controller 0 epoch 18 elected leader 0 for Offline partition [test,0] (state.change.logger)
[2017-11-22 11:19:57,445] TRACE Controller 0 epoch 18 changed partition [test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-11-22 11:19:57,445] TRACE Controller 0 epoch 18 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:14,ControllerEpoch:18) to broker 0 for partition [test,0] (state.change.logger)
[2017-11-22 11:19:57,445] TRACE Controller 0 epoch 18 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:18) to broker 0 for partition [json-topic,0] (state.change.logger)
[2017-11-22 11:19:57,445] TRACE Controller 0 epoch 18 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:14,ControllerEpoch:18) to broker 0 for partition test-0 (state.change.logger)
[2017-11-22 11:19:57,445] TRACE Controller 0 epoch 18 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:18) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-11-22 11:19:57,470] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:13,ControllerEpoch:17),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 0 (state.change.logger)
[2017-11-22 11:19:57,471] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:17),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 0 (state.change.logger)
[2017-11-22 11:19:57,480] TRACE Controller 0 epoch 18 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-22 11:19:57,517] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=17, leader=0, leaderEpoch=13, isr=[0], zkVersion=13, replicas=[0]) correlation id 1 from controller 0 epoch 18 for partition [test,0] (state.change.logger)
[2017-11-22 11:19:57,517] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=17, leader=0, leaderEpoch=6, isr=[0], zkVersion=6, replicas=[0]) correlation id 1 from controller 0 epoch 18 for partition [json-topic,0] (state.change.logger)
[2017-11-22 11:19:57,532] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 18 starting the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-22 11:19:57,532] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 18 starting the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-11-22 11:19:57,552] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 18 with correlation id 1 for partition [json-topic,0] (state.change.logger)
[2017-11-22 11:19:57,554] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 18 with correlation id 1 for partition [test,0] (state.change.logger)
[2017-11-22 11:19:57,555] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 18 for the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-22 11:19:57,555] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 18 for the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-11-22 11:19:57,600] TRACE Controller 0 epoch 18 received response {error_code=0,partitions=[{topic=json-topic,partition=0,error_code=0},{topic=test,partition=0,error_code=0}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-22 11:19:57,602] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:13,ControllerEpoch:17),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 2 (state.change.logger)
[2017-11-22 11:19:57,602] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:17),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 2 (state.change.logger)
[2017-11-22 11:19:57,603] TRACE Controller 0 epoch 18 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-22 11:19:57,605] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=18, leader=0, leaderEpoch=14, isr=[0], zkVersion=14, replicas=[0]) correlation id 3 from controller 0 epoch 18 for partition [test,0] (state.change.logger)
[2017-11-22 11:19:57,605] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=18, leader=0, leaderEpoch=7, isr=[0], zkVersion=7, replicas=[0]) correlation id 3 from controller 0 epoch 18 for partition [json-topic,0] (state.change.logger)
[2017-11-22 11:19:57,606] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 18 starting the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-22 11:19:57,606] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 18 starting the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-11-22 11:19:57,607] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 18 for partition [test,0] since it is already the leader for the partition. (state.change.logger)
[2017-11-22 11:19:57,608] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 18 for partition [json-topic,0] since it is already the leader for the partition. (state.change.logger)
[2017-11-22 11:19:57,609] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 18 for the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-22 11:19:57,609] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 18 for the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-11-22 11:19:57,610] TRACE Controller 0 epoch 18 received response {error_code=0,partitions=[{topic=json-topic,partition=0,error_code=0},{topic=test,partition=0,error_code=0}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-22 11:19:57,612] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:14,ControllerEpoch:18),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 4 (state.change.logger)
[2017-11-22 11:19:57,612] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:18),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 4 (state.change.logger)
[2017-11-22 11:19:57,613] TRACE Controller 0 epoch 18 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-22 13:58:55,152] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2017-11-22 13:59:17,093] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2017-11-22 13:59:18,018] TRACE Controller 0 epoch 19 started leader election for partition [json-topic,0] (state.change.logger)
[2017-11-22 13:59:18,038] ERROR Controller 0 epoch 19 initiated state change for partition [json-topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [json-topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-11-22 13:59:18,038] TRACE Controller 0 epoch 19 started leader election for partition [test,0] (state.change.logger)
[2017-11-22 13:59:18,058] ERROR Controller 0 epoch 19 initiated state change for partition [test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-11-22 13:59:18,568] TRACE Controller 0 epoch 19 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:14,ControllerEpoch:18) to broker 0 for partition test-0 (state.change.logger)
[2017-11-22 13:59:18,568] TRACE Controller 0 epoch 19 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:18) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-11-22 13:59:18,582] TRACE Controller 0 epoch 19 changed state of replica 0 for partition [json-topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-11-22 13:59:18,582] TRACE Controller 0 epoch 19 changed state of replica 0 for partition [test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-11-22 13:59:18,592] TRACE Controller 0 epoch 19 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:14,ControllerEpoch:18) to broker 0 for partition [test,0] (state.change.logger)
[2017-11-22 13:59:18,592] TRACE Controller 0 epoch 19 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:18) to broker 0 for partition [json-topic,0] (state.change.logger)
[2017-11-22 13:59:18,592] TRACE Controller 0 epoch 19 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:14,ControllerEpoch:18) to broker 0 for partition test-0 (state.change.logger)
[2017-11-22 13:59:18,592] TRACE Controller 0 epoch 19 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:18) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-11-22 13:59:18,592] TRACE Controller 0 epoch 19 started leader election for partition [json-topic,0] (state.change.logger)
[2017-11-22 13:59:18,619] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:14,ControllerEpoch:18),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 19 with correlation id 0 (state.change.logger)
[2017-11-22 13:59:18,619] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:18),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 19 with correlation id 0 (state.change.logger)
[2017-11-22 13:59:18,619] TRACE Controller 0 epoch 19 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-22 13:59:18,639] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=18, leader=0, leaderEpoch=14, isr=[0], zkVersion=14, replicas=[0]) correlation id 1 from controller 0 epoch 19 for partition [test,0] (state.change.logger)
[2017-11-22 13:59:18,639] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=18, leader=0, leaderEpoch=7, isr=[0], zkVersion=7, replicas=[0]) correlation id 1 from controller 0 epoch 19 for partition [json-topic,0] (state.change.logger)
[2017-11-22 13:59:18,669] TRACE Controller 0 epoch 19 elected leader 0 for Offline partition [json-topic,0] (state.change.logger)
[2017-11-22 13:59:18,669] TRACE Controller 0 epoch 19 changed partition [json-topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-11-22 13:59:18,669] TRACE Controller 0 epoch 19 started leader election for partition [test,0] (state.change.logger)
[2017-11-22 13:59:18,689] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 19 starting the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-22 13:59:18,689] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 19 starting the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-11-22 13:59:18,729] TRACE Controller 0 epoch 19 elected leader 0 for Offline partition [test,0] (state.change.logger)
[2017-11-22 13:59:18,729] TRACE Controller 0 epoch 19 changed partition [test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-11-22 13:59:18,729] TRACE Controller 0 epoch 19 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:15,ControllerEpoch:19) to broker 0 for partition [test,0] (state.change.logger)
[2017-11-22 13:59:18,729] TRACE Controller 0 epoch 19 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:19) to broker 0 for partition [json-topic,0] (state.change.logger)
[2017-11-22 13:59:18,729] TRACE Controller 0 epoch 19 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:15,ControllerEpoch:19) to broker 0 for partition test-0 (state.change.logger)
[2017-11-22 13:59:18,729] TRACE Controller 0 epoch 19 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:19) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-11-22 13:59:18,749] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 19 with correlation id 1 for partition [json-topic,0] (state.change.logger)
[2017-11-22 13:59:18,749] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 19 with correlation id 1 for partition [test,0] (state.change.logger)
[2017-11-22 13:59:18,749] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 19 for the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-22 13:59:18,749] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 19 for the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-11-22 13:59:18,779] TRACE Controller 0 epoch 19 received response {error_code=0,partitions=[{topic=json-topic,partition=0,error_code=0},{topic=test,partition=0,error_code=0}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-22 13:59:18,779] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:14,ControllerEpoch:18),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 19 with correlation id 2 (state.change.logger)
[2017-11-22 13:59:18,779] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:18),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 19 with correlation id 2 (state.change.logger)
[2017-11-22 13:59:18,779] TRACE Controller 0 epoch 19 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-22 13:59:18,779] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=19, leader=0, leaderEpoch=15, isr=[0], zkVersion=15, replicas=[0]) correlation id 3 from controller 0 epoch 19 for partition [test,0] (state.change.logger)
[2017-11-22 13:59:18,779] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=19, leader=0, leaderEpoch=8, isr=[0], zkVersion=8, replicas=[0]) correlation id 3 from controller 0 epoch 19 for partition [json-topic,0] (state.change.logger)
[2017-11-22 13:59:18,779] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 19 starting the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-22 13:59:18,779] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 19 starting the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-11-22 13:59:18,789] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 19 for partition [test,0] since it is already the leader for the partition. (state.change.logger)
[2017-11-22 13:59:18,789] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 19 for partition [json-topic,0] since it is already the leader for the partition. (state.change.logger)
[2017-11-22 13:59:18,789] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 19 for the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-22 13:59:18,789] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 19 for the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-11-22 13:59:18,789] TRACE Controller 0 epoch 19 received response {error_code=0,partitions=[{topic=json-topic,partition=0,error_code=0},{topic=test,partition=0,error_code=0}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-22 13:59:18,789] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:15,ControllerEpoch:19),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 19 with correlation id 4 (state.change.logger)
[2017-11-22 13:59:18,789] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:19),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 19 with correlation id 4 (state.change.logger)
[2017-11-22 13:59:18,789] TRACE Controller 0 epoch 19 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-23 13:51:32,007] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2017-11-23 13:58:15,822] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=state.change.logger (state.change.logger)
[2017-11-23 13:58:23,790] TRACE Controller 0 epoch 20 started leader election for partition [json-topic,0] (state.change.logger)
[2017-11-23 13:58:23,800] ERROR Controller 0 epoch 20 initiated state change for partition [json-topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [json-topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-11-23 13:58:24,003] TRACE Controller 0 epoch 20 started leader election for partition [test,0] (state.change.logger)
[2017-11-23 13:58:24,027] ERROR Controller 0 epoch 20 initiated state change for partition [test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:50)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.server.ZookeeperLeaderElector$$anonfun$startup$1.apply(ZookeeperLeaderElector.scala:48)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.server.ZookeeperLeaderElector.startup(ZookeeperLeaderElector.scala:48)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply$mcV$sp(KafkaController.scala:676)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.controller.KafkaController$$anonfun$startup$1.apply(KafkaController.scala:672)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController.startup(KafkaController.scala:672)
	at kafka.server.KafkaServer.startup(KafkaServer.scala:228)
	at kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:39)
	at kafka.Kafka$.main(Kafka.scala:67)
	at kafka.Kafka.main(Kafka.scala)
[2017-11-23 13:58:25,214] TRACE Controller 0 epoch 20 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:15,ControllerEpoch:19) to broker 0 for partition test-0 (state.change.logger)
[2017-11-23 13:58:25,214] TRACE Controller 0 epoch 20 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:19) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-11-23 13:58:25,267] TRACE Controller 0 epoch 20 changed state of replica 0 for partition [json-topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-11-23 13:58:25,269] TRACE Controller 0 epoch 20 changed state of replica 0 for partition [test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-11-23 13:58:25,272] TRACE Controller 0 epoch 20 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:15,ControllerEpoch:19) to broker 0 for partition [test,0] (state.change.logger)
[2017-11-23 13:58:25,273] TRACE Controller 0 epoch 20 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:19) to broker 0 for partition [json-topic,0] (state.change.logger)
[2017-11-23 13:58:25,277] TRACE Controller 0 epoch 20 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:15,ControllerEpoch:19) to broker 0 for partition test-0 (state.change.logger)
[2017-11-23 13:58:25,278] TRACE Controller 0 epoch 20 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:19) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-11-23 13:58:25,279] TRACE Controller 0 epoch 20 started leader election for partition [json-topic,0] (state.change.logger)
[2017-11-23 13:58:25,412] TRACE Controller 0 epoch 20 elected leader 0 for Offline partition [json-topic,0] (state.change.logger)
[2017-11-23 13:58:25,417] TRACE Controller 0 epoch 20 changed partition [json-topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-11-23 13:58:25,417] TRACE Controller 0 epoch 20 started leader election for partition [test,0] (state.change.logger)
[2017-11-23 13:58:25,449] TRACE Controller 0 epoch 20 elected leader 0 for Offline partition [test,0] (state.change.logger)
[2017-11-23 13:58:25,449] TRACE Controller 0 epoch 20 changed partition [test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-11-23 13:58:25,449] TRACE Controller 0 epoch 20 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:16,ControllerEpoch:20) to broker 0 for partition [test,0] (state.change.logger)
[2017-11-23 13:58:25,449] TRACE Controller 0 epoch 20 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:20) to broker 0 for partition [json-topic,0] (state.change.logger)
[2017-11-23 13:58:25,450] TRACE Controller 0 epoch 20 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:16,ControllerEpoch:20) to broker 0 for partition test-0 (state.change.logger)
[2017-11-23 13:58:25,450] TRACE Controller 0 epoch 20 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:20) to broker 0 for partition json-topic-0 (state.change.logger)
[2017-11-23 13:58:25,751] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:15,ControllerEpoch:19),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 0 (state.change.logger)
[2017-11-23 13:58:25,752] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:19),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 0 (state.change.logger)
[2017-11-23 13:58:25,759] TRACE Controller 0 epoch 20 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-23 13:58:25,828] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=19, leader=0, leaderEpoch=15, isr=[0], zkVersion=15, replicas=[0]) correlation id 1 from controller 0 epoch 20 for partition [test,0] (state.change.logger)
[2017-11-23 13:58:25,828] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=19, leader=0, leaderEpoch=8, isr=[0], zkVersion=8, replicas=[0]) correlation id 1 from controller 0 epoch 20 for partition [json-topic,0] (state.change.logger)
[2017-11-23 13:58:25,883] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 20 starting the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-23 13:58:25,884] TRACE Broker 0 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 20 starting the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-11-23 13:58:25,902] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 20 with correlation id 1 for partition [json-topic,0] (state.change.logger)
[2017-11-23 13:58:25,902] TRACE Broker 0 stopped fetchers as part of become-leader request from controller 0 epoch 20 with correlation id 1 for partition [test,0] (state.change.logger)
[2017-11-23 13:58:25,904] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 20 for the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-23 13:58:25,904] TRACE Broker 0 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 20 for the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-11-23 13:58:25,910] TRACE Controller 0 epoch 20 received response {error_code=0,partitions=[{topic=json-topic,partition=0,error_code=0},{topic=test,partition=0,error_code=0}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-23 13:58:25,914] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:15,ControllerEpoch:19),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 2 (state.change.logger)
[2017-11-23 13:58:25,914] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:19),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 2 (state.change.logger)
[2017-11-23 13:58:25,915] TRACE Controller 0 epoch 20 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-23 13:58:25,916] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=20, leader=0, leaderEpoch=16, isr=[0], zkVersion=16, replicas=[0]) correlation id 3 from controller 0 epoch 20 for partition [test,0] (state.change.logger)
[2017-11-23 13:58:25,916] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=20, leader=0, leaderEpoch=9, isr=[0], zkVersion=9, replicas=[0]) correlation id 3 from controller 0 epoch 20 for partition [json-topic,0] (state.change.logger)
[2017-11-23 13:58:25,916] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 20 starting the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-23 13:58:25,916] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 20 starting the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-11-23 13:58:25,916] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 20 for partition [test,0] since it is already the leader for the partition. (state.change.logger)
[2017-11-23 13:58:25,916] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 20 for partition [json-topic,0] since it is already the leader for the partition. (state.change.logger)
[2017-11-23 13:58:25,916] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 20 for the become-leader transition for partition [test,0] (state.change.logger)
[2017-11-23 13:58:25,916] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 20 for the become-leader transition for partition [json-topic,0] (state.change.logger)
[2017-11-23 13:58:25,916] TRACE Controller 0 epoch 20 received response {error_code=0,partitions=[{topic=json-topic,partition=0,error_code=0},{topic=test,partition=0,error_code=0}]} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
[2017-11-23 13:58:25,916] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:16,ControllerEpoch:20),ReplicationFactor:1),AllReplicas:0) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 4 (state.change.logger)
[2017-11-23 13:58:25,916] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:20),ReplicationFactor:1),AllReplicas:0) for partition json-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 4 (state.change.logger)
[2017-11-23 13:58:25,926] TRACE Controller 0 epoch 20 received response {error_code=0} for a request sent to broker Temp-PhuongHPT.fsoft.fpt.vn:9092 (id: 0 rack: null) (state.change.logger)
